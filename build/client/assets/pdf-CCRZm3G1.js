import{B as getAugmentedNamespace,z as getDefaultExportFromCjs}from"./chunk-4WY6JWTD-BmUo4Qlm.js";function _mergeNamespaces(U,n){for(var w=0;w<n.length;w++){const a=n[w];if(typeof a!="string"&&!Array.isArray(a)){for(const _ in a)if(_!=="default"&&!(_ in U)){const F=Object.getOwnPropertyDescriptor(a,_);F&&Object.defineProperty(U,_,F.get?F:{enumerable:!0,get:()=>a[_]})}}}return Object.freeze(Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}))}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"}));function commonjsRequire(U){throw new Error('Could not dynamically require "'+U+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};const require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports$1){(function(n,w){module.exports=w()})(globalThis,()=>(()=>{var __webpack_modules__=[,((U,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PromiseCapability=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=l,n.bytesToString=j,n.createValidAbsoluteUrl=b,n.getModificationDate=mt,n.getUuid=Nt,n.getVerbosityLevel=st,n.info=K,n.isArrayBuffer=ut,n.isArrayEqual=At,n.isNodeJS=void 0,n.normalizeUnicode=It,n.objectFromMap=q,n.objectSize=nt,n.setVerbosityLevel=tt,n.shadow=P,n.string32=V,n.stringToBytes=B,n.stringToPDFString=lt,n.stringToUTF8String=ct,n.unreachable=m,n.utf8StringToString=ht,n.warn=R;const w=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=w;const a=[1,0,0,1,0,0];n.IDENTITY_MATRIX=a;const _=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=_;const F=1e7;n.MAX_IMAGE_SIZE_TO_CACHE=F;const O=1.35;n.LINE_FACTOR=O;const L=.35;n.LINE_DESCENT_FACTOR=L;const S=L/O;n.BASELINE_FACTOR=S;const t={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=t;const i={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=i;const d="pdfjs_internal_editor_";n.AnnotationEditorPrefix=d;const r={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};n.AnnotationEditorType=r;const o={RESIZE:1,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};n.AnnotationEditorParamsType=o;const e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=e;const f={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=f;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=u;const h={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=h;const v={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=v;const I={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=I;const x={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=x;const g={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=g;const A={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=A;const M={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=M;const H={O:"PageOpen",C:"PageClose"};n.PageActionEventType=H;const N={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=N;const W={NONE:0,BINARY:1};n.CMapCompressionType=W;const G={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=G;const Z={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=Z;let Q=N.WARNINGS;function tt(it){Number.isInteger(it)&&(Q=it)}function st(){return Q}function K(it){Q>=N.INFOS&&console.log(`Info: ${it}`)}function R(it){Q>=N.WARNINGS&&console.log(`Warning: ${it}`)}function m(it){throw new Error(it)}function l(it,X){it||m(X)}function c(it){switch(it?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function b(it,X=null,z=null){if(!it)return null;try{if(z&&typeof it=="string"&&(z.addDefaultProtocol&&it.startsWith("www.")&&it.match(/\./g)?.length>=2&&(it=`http://${it}`),z.tryConvertEncoding))try{it=ct(it)}catch{}const at=X?new URL(it,X):new URL(it);if(c(at))return at}catch{}return null}function P(it,X,z,at=!1){return Object.defineProperty(it,X,{value:z,enumerable:!at,configurable:!0,writable:!1}),z}const T=(function(){function X(z,at){this.constructor===X&&m("Cannot initialize BaseException."),this.message=z,this.name=at}return X.prototype=new Error,X.constructor=X,X})();n.BaseException=T;class D extends T{constructor(X,z){super(X,"PasswordException"),this.code=z}}n.PasswordException=D;class k extends T{constructor(X,z){super(X,"UnknownErrorException"),this.details=z}}n.UnknownErrorException=k;class s extends T{constructor(X){super(X,"InvalidPDFException")}}n.InvalidPDFException=s;class p extends T{constructor(X){super(X,"MissingPDFException")}}n.MissingPDFException=p;class y extends T{constructor(X,z){super(X,"UnexpectedResponseException"),this.status=z}}n.UnexpectedResponseException=y;class E extends T{constructor(X){super(X,"FormatError")}}n.FormatError=E;class C extends T{constructor(X){super(X,"AbortException")}}n.AbortException=C;function j(it){(typeof it!="object"||it?.length===void 0)&&m("Invalid argument for bytesToString");const X=it.length,z=8192;if(X<z)return String.fromCharCode.apply(null,it);const at=[];for(let dt=0;dt<X;dt+=z){const pt=Math.min(dt+z,X),gt=it.subarray(dt,pt);at.push(String.fromCharCode.apply(null,gt))}return at.join("")}function B(it){typeof it!="string"&&m("Invalid argument for stringToBytes");const X=it.length,z=new Uint8Array(X);for(let at=0;at<X;++at)z[at]=it.charCodeAt(at)&255;return z}function V(it){return String.fromCharCode(it>>24&255,it>>16&255,it>>8&255,it&255)}function nt(it){return Object.keys(it).length}function q(it){const X=Object.create(null);for(const[z,at]of it)X[z]=at;return X}function Y(){const it=new Uint8Array(4);return it[0]=1,new Uint32Array(it.buffer,0,1)[0]===1}function J(){try{return new Function(""),!0}catch{return!1}}class ${static get isLittleEndian(){return P(this,"isLittleEndian",Y())}static get isEvalSupported(){return P(this,"isEvalSupported",J())}static get isOffscreenCanvasSupported(){return P(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?P(this,"platform",{isWin:!1,isMac:!1}):P(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}n.FeatureTest=$;const et=[...Array(256).keys()].map(it=>it.toString(16).padStart(2,"0"));class rt{static makeHexColor(X,z,at){return`#${et[X]}${et[z]}${et[at]}`}static scaleMinMax(X,z){let at;X[0]?(X[0]<0&&(at=z[0],z[0]=z[1],z[1]=at),z[0]*=X[0],z[1]*=X[0],X[3]<0&&(at=z[2],z[2]=z[3],z[3]=at),z[2]*=X[3],z[3]*=X[3]):(at=z[0],z[0]=z[2],z[2]=at,at=z[1],z[1]=z[3],z[3]=at,X[1]<0&&(at=z[2],z[2]=z[3],z[3]=at),z[2]*=X[1],z[3]*=X[1],X[2]<0&&(at=z[0],z[0]=z[1],z[1]=at),z[0]*=X[2],z[1]*=X[2]),z[0]+=X[4],z[1]+=X[4],z[2]+=X[5],z[3]+=X[5]}static transform(X,z){return[X[0]*z[0]+X[2]*z[1],X[1]*z[0]+X[3]*z[1],X[0]*z[2]+X[2]*z[3],X[1]*z[2]+X[3]*z[3],X[0]*z[4]+X[2]*z[5]+X[4],X[1]*z[4]+X[3]*z[5]+X[5]]}static applyTransform(X,z){const at=X[0]*z[0]+X[1]*z[2]+z[4],dt=X[0]*z[1]+X[1]*z[3]+z[5];return[at,dt]}static applyInverseTransform(X,z){const at=z[0]*z[3]-z[1]*z[2],dt=(X[0]*z[3]-X[1]*z[2]+z[2]*z[5]-z[4]*z[3])/at,pt=(-X[0]*z[1]+X[1]*z[0]+z[4]*z[1]-z[5]*z[0])/at;return[dt,pt]}static getAxialAlignedBoundingBox(X,z){const at=this.applyTransform(X,z),dt=this.applyTransform(X.slice(2,4),z),pt=this.applyTransform([X[0],X[3]],z),gt=this.applyTransform([X[2],X[1]],z);return[Math.min(at[0],dt[0],pt[0],gt[0]),Math.min(at[1],dt[1],pt[1],gt[1]),Math.max(at[0],dt[0],pt[0],gt[0]),Math.max(at[1],dt[1],pt[1],gt[1])]}static inverseTransform(X){const z=X[0]*X[3]-X[1]*X[2];return[X[3]/z,-X[1]/z,-X[2]/z,X[0]/z,(X[2]*X[5]-X[4]*X[3])/z,(X[4]*X[1]-X[5]*X[0])/z]}static singularValueDecompose2dScale(X){const z=[X[0],X[2],X[1],X[3]],at=X[0]*z[0]+X[1]*z[2],dt=X[0]*z[1]+X[1]*z[3],pt=X[2]*z[0]+X[3]*z[2],gt=X[2]*z[1]+X[3]*z[3],wt=(at+gt)/2,Tt=Math.sqrt((at+gt)**2-4*(at*gt-pt*dt))/2,Et=wt+Tt||1,_t=wt-Tt||1;return[Math.sqrt(Et),Math.sqrt(_t)]}static normalizeRect(X){const z=X.slice(0);return X[0]>X[2]&&(z[0]=X[2],z[2]=X[0]),X[1]>X[3]&&(z[1]=X[3],z[3]=X[1]),z}static intersect(X,z){const at=Math.max(Math.min(X[0],X[2]),Math.min(z[0],z[2])),dt=Math.min(Math.max(X[0],X[2]),Math.max(z[0],z[2]));if(at>dt)return null;const pt=Math.max(Math.min(X[1],X[3]),Math.min(z[1],z[3])),gt=Math.min(Math.max(X[1],X[3]),Math.max(z[1],z[3]));return pt>gt?null:[at,pt,dt,gt]}static bezierBoundingBox(X,z,at,dt,pt,gt,wt,Tt){const Et=[],_t=[[],[]];let Pt,St,Rt,ft,Ft,Mt,Dt,Ot;for(let Lt=0;Lt<2;++Lt){if(Lt===0?(St=6*X-12*at+6*pt,Pt=-3*X+9*at-9*pt+3*wt,Rt=3*at-3*X):(St=6*z-12*dt+6*gt,Pt=-3*z+9*dt-9*gt+3*Tt,Rt=3*dt-3*z),Math.abs(Pt)<1e-12){if(Math.abs(St)<1e-12)continue;ft=-Rt/St,0<ft&&ft<1&&Et.push(ft);continue}Dt=St*St-4*Rt*Pt,Ot=Math.sqrt(Dt),!(Dt<0)&&(Ft=(-St+Ot)/(2*Pt),0<Ft&&Ft<1&&Et.push(Ft),Mt=(-St-Ot)/(2*Pt),0<Mt&&Mt<1&&Et.push(Mt))}let xt=Et.length,yt;const kt=xt;for(;xt--;)ft=Et[xt],yt=1-ft,_t[0][xt]=yt*yt*yt*X+3*yt*yt*ft*at+3*yt*ft*ft*pt+ft*ft*ft*wt,_t[1][xt]=yt*yt*yt*z+3*yt*yt*ft*dt+3*yt*ft*ft*gt+ft*ft*ft*Tt;return _t[0][kt]=X,_t[1][kt]=z,_t[0][kt+1]=wt,_t[1][kt+1]=Tt,_t[0].length=_t[1].length=kt+2,[Math.min(..._t[0]),Math.min(..._t[1]),Math.max(..._t[0]),Math.max(..._t[1])]}}n.Util=rt;const ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function lt(it){if(it[0]>="ï"){let z;if(it[0]==="þ"&&it[1]==="ÿ"?z="utf-16be":it[0]==="ÿ"&&it[1]==="þ"?z="utf-16le":it[0]==="ï"&&it[1]==="»"&&it[2]==="¿"&&(z="utf-8"),z)try{const at=new TextDecoder(z,{fatal:!0}),dt=B(it);return at.decode(dt)}catch(at){R(`stringToPDFString: "${at}".`)}}const X=[];for(let z=0,at=it.length;z<at;z++){const dt=ot[it.charCodeAt(z)];X.push(dt?String.fromCharCode(dt):it.charAt(z))}return X.join("")}function ct(it){return decodeURIComponent(escape(it))}function ht(it){return unescape(encodeURIComponent(it))}function ut(it){return typeof it=="object"&&it?.byteLength!==void 0}function At(it,X){if(it.length!==X.length)return!1;for(let z=0,at=it.length;z<at;z++)if(it[z]!==X[z])return!1;return!0}function mt(it=new Date){return[it.getUTCFullYear().toString(),(it.getUTCMonth()+1).toString().padStart(2,"0"),it.getUTCDate().toString().padStart(2,"0"),it.getUTCHours().toString().padStart(2,"0"),it.getUTCMinutes().toString().padStart(2,"0"),it.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ct{#t=!1;constructor(){this.promise=new Promise((X,z)=>{this.resolve=at=>{this.#t=!0,X(at)},this.reject=at=>{this.#t=!0,z(at)}})}get settled(){return this.#t}}n.PromiseCapability=Ct;let bt=null,vt=null;function It(it){return bt||(bt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vt=new Map([["ﬅ","ſt"]])),it.replaceAll(bt,(X,z,at)=>z?z.normalize("NFKC"):vt.get(at))}function Nt(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const it=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(it);else for(let X=0;X<32;X++)it[X]=Math.floor(Math.random()*255);return j(it)}}),((__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(U){if(typeof U=="string"||U instanceof URL?U={url:U}:(0,_util.isArrayBuffer)(U)&&(U={data:U}),typeof U!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!U.url&&!U.data&&!U.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const n=new PDFDocumentLoadingTask,{docId:w}=n,a=U.url?getUrlProp(U.url):null,_=U.data?getDataProp(U.data):null,F=U.httpHeaders||null,O=U.withCredentials===!0,L=U.password??null,S=U.range instanceof PDFDataRangeTransport?U.range:null,t=Number.isInteger(U.rangeChunkSize)&&U.rangeChunkSize>0?U.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let i=U.worker instanceof PDFWorker?U.worker:null;const d=U.verbosity,r=typeof U.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(U.docBaseUrl)?U.docBaseUrl:null,o=typeof U.cMapUrl=="string"?U.cMapUrl:null,e=U.cMapPacked!==!1,f=U.CMapReaderFactory||DefaultCMapReaderFactory,u=typeof U.standardFontDataUrl=="string"?U.standardFontDataUrl:null,h=U.StandardFontDataFactory||DefaultStandardFontDataFactory,v=U.stopAtErrors!==!0,I=Number.isInteger(U.maxImageSize)&&U.maxImageSize>-1?U.maxImageSize:-1,x=U.isEvalSupported!==!1,g=typeof U.isOffscreenCanvasSupported=="boolean"?U.isOffscreenCanvasSupported:!_util.isNodeJS,A=Number.isInteger(U.canvasMaxAreaInBytes)?U.canvasMaxAreaInBytes:-1,M=typeof U.disableFontFace=="boolean"?U.disableFontFace:_util.isNodeJS,H=U.fontExtraProperties===!0,N=U.enableXfa===!0,W=U.ownerDocument||globalThis.document,G=U.disableRange===!0,Z=U.disableStream===!0,Q=U.disableAutoFetch===!0,tt=U.pdfBug===!0,st=S?S.length:U.length??NaN,K=typeof U.useSystemFonts=="boolean"?U.useSystemFonts:!_util.isNodeJS&&!M,R=typeof U.useWorkerFetch=="boolean"?U.useWorkerFetch:f===_display_utils.DOMCMapReaderFactory&&h===_display_utils.DOMStandardFontDataFactory&&o&&u&&(0,_display_utils.isValidFetchUrl)(o,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(u,document.baseURI),m=U.canvasFactory||new DefaultCanvasFactory({ownerDocument:W}),l=U.filterFactory||new DefaultFilterFactory({docId:w,ownerDocument:W}),c=null;(0,_util.setVerbosityLevel)(d);const b={canvasFactory:m,filterFactory:l};if(R||(b.cMapReaderFactory=new f({baseUrl:o,isCompressed:e}),b.standardFontDataFactory=new h({baseUrl:u})),!i){const D={verbosity:d,port:_worker_options.GlobalWorkerOptions.workerPort};i=D.port?PDFWorker.fromPort(D):new PDFWorker(D),n._worker=i}const P={docId:w,apiVersion:"3.9.179",data:_,password:L,disableAutoFetch:Q,rangeChunkSize:t,length:st,docBaseUrl:r,enableXfa:N,evaluatorOptions:{maxImageSize:I,disableFontFace:M,ignoreErrors:v,isEvalSupported:x,isOffscreenCanvasSupported:g,canvasMaxAreaInBytes:A,fontExtraProperties:H,useSystemFonts:K,cMapUrl:R?o:null,standardFontDataUrl:R?u:null}},T={ignoreErrors:v,isEvalSupported:x,disableFontFace:M,fontExtraProperties:H,enableXfa:N,ownerDocument:W,disableAutoFetch:Q,pdfBug:tt,styleElement:c};return i.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const D=_fetchDocument(i,P),k=new Promise(function(s){let p;S?p=new _transport_stream.PDFDataTransportStream({length:st,initialData:S.initialData,progressiveDone:S.progressiveDone,contentDispositionFilename:S.contentDispositionFilename,disableRange:G,disableStream:Z},S):_||(p=(E=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(E):(0,_display_utils.isValidFetchUrl)(E.url)?new _displayFetch_stream.PDFFetchStream(E):new _displayNetwork.PDFNetworkStream(E))({url:a,length:st,httpHeaders:F,withCredentials:O,rangeChunkSize:t,disableRange:G,disableStream:Z})),s(p)});return Promise.all([D,k]).then(function([s,p]){if(n.destroyed)throw new Error("Loading aborted");const y=new _message_handler.MessageHandler(w,s,i.port),E=new WorkerTransport(y,n,p,T,b);n._transport=E,y.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(U,n){if(U.destroyed)throw new Error("Worker was destroyed");const w=await U.messageHandler.sendWithPromise("GetDocRequest",n,n.data?[n.data.buffer]:null);if(U.destroyed)throw new Error("Worker was destroyed");return w}function getUrlProp(U){if(U instanceof URL)return U.href;try{return new URL(U,window.location).href}catch{if(_util.isNodeJS&&typeof U=="string")return U}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(U){if(_util.isNodeJS&&typeof Buffer<"u"&&U instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(U instanceof Uint8Array&&U.byteLength===U.buffer.byteLength)return U;if(typeof U=="string")return(0,_util.stringToBytes)(U);if(typeof U=="object"&&!isNaN(U?.length)||(0,_util.isArrayBuffer)(U))return new Uint8Array(U);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,w,a=!1,_=null){this.length=n,this.initialData=w,this.progressiveDone=a,this.contentDispositionFilename=_,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,w){for(const a of this._rangeListeners)a(n,w)}onDataProgress(n,w){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(n,w)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const w of this._progressiveReadListeners)w(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,w){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,w){this._pdfInfo=n,this._transport=w}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(n,w,a,_=!1){this._pageIndex=n,this._pageInfo=w,this._transport=a,this._stats=_?new _display_utils.StatTimer:null,this._pdfBug=_,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:w=this.rotate,offsetX:a=0,offsetY:_=0,dontFlip:F=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:w,offsetX:a,offsetY:_,dontFlip:F})}getAnnotations({intent:n="display"}={}){const w=this._transport.getRenderingIntent(n);return this._transport.getAnnotations(this._pageIndex,w.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:n,viewport:w,intent:a="display",annotationMode:_=_util.AnnotationMode.ENABLE,transform:F=null,background:O=null,optionalContentConfigPromise:L=null,annotationCanvasMap:S=null,pageColors:t=null,printAnnotationStorage:i=null}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(a,_,i);this.#e=!1,this.#s(),L||(L=this._transport.getOptionalContentConfig());let r=this._intentStates.get(d.cacheKey);r||(r=Object.create(null),this._intentStates.set(d.cacheKey,r)),r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null);const o=!!(d.renderingIntent&_util.RenderingIntentFlag.PRINT);r.displayReadyCapability||(r.displayReadyCapability=new _util.PromiseCapability,r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const e=h=>{r.renderTasks.delete(f),(this._maybeCleanupAfterRender||o)&&(this.#e=!0),this.#i(!o),h?(f.capability.reject(h),this._abortOperatorList({intentState:r,reason:h instanceof Error?h:new Error(h)})):f.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},f=new InternalRenderTask({callback:e,params:{canvasContext:n,viewport:w,transform:F,background:O},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:S,operatorList:r.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!o,pdfBug:this._pdfBug,pageColors:t});(r.renderTasks||=new Set).add(f);const u=f.task;return Promise.all([r.displayReadyCapability.promise,L]).then(([h,v])=>{if(this.destroyed){e();return}this._stats?.time("Rendering"),f.initializeGraphics({transparency:h,optionalContentConfig:v}),f.operatorListChanged()}).catch(e),u}getOperatorList({intent:n="display",annotationMode:w=_util.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function _(){O.operatorList.lastChunk&&(O.opListReadCapability.resolve(O.operatorList),O.renderTasks.delete(L))}const F=this._transport.getRenderingIntent(n,w,a,!0);let O=this._intentStates.get(F.cacheKey);O||(O=Object.create(null),this._intentStates.set(F.cacheKey,O));let L;return O.opListReadCapability||(L=Object.create(null),L.operatorListChanged=_,O.opListReadCapability=new _util.PromiseCapability,(O.renderTasks||=new Set).add(L),O.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(F)),O.opListReadCapability.promise}streamTextContent({includeMarkedContent:n=!1,disableNormalization:w=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:n===!0,disableNormalization:w===!0},{highWaterMark:100,size(_){return _.items.length}})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));const w=this.streamTextContent(n);return new Promise(function(a,_){function F(){O.read().then(function({value:S,done:t}){if(t){a(L);return}Object.assign(L.styles,S.styles),L.items.push(...S.items),F()},_)}const O=w.getReader(),L={items:[],styles:Object.create(null)};F()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const n=[];for(const w of this._intentStates.values())if(this._abortOperatorList({intentState:w,reason:new Error("Page was destroyed."),force:!0}),!w.opListReadCapability)for(const a of w.renderTasks)n.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(n)}cleanup(n=!1){this.#e=!0;const w=this.#i(!1);return n&&w&&(this._stats&&=new _display_utils.StatTimer),w}#i(n=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(n)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:w,operatorList:a}of this._intentStates.values())if(w.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(n,w){const a=this._intentStates.get(w);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(n))}_renderPageChunk(n,w){for(let a=0,_=n.length;a<_;a++)w.operatorList.fnArray.push(n.fnArray[a]),w.operatorList.argsArray.push(n.argsArray[a]);w.operatorList.lastChunk=n.lastChunk,w.operatorList.separateAnnots=n.separateAnnots;for(const a of w.renderTasks)a.operatorListChanged();n.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:n,cacheKey:w,annotationStorageSerializable:a}){const{map:_,transfers:F}=a,L=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:w,annotationStorage:_},F).getReader(),S=this._intentStates.get(w);S.streamReader=L;const t=()=>{L.read().then(({value:i,done:d})=>{if(d){S.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(i,S),t())},i=>{if(S.streamReader=null,!this._transport.destroyed){if(S.operatorList){S.operatorList.lastChunk=!0;for(const d of S.renderTasks)d.operatorListChanged();this.#i(!0)}if(S.displayReadyCapability)S.displayReadyCapability.reject(i);else if(S.opListReadCapability)S.opListReadCapability.reject(i);else throw i}})};t()}_abortOperatorList({intentState:n,reason:w,force:a=!1}){if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!a){if(n.renderTasks.size>0)return;if(w instanceof _display_utils.RenderingCancelledException){let _=RENDERING_CANCELLED_TIMEOUT;w.extraDelay>0&&w.extraDelay<1e3&&(_+=w.extraDelay),n.streamReaderCancelTimeout=setTimeout(()=>{n.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:n,reason:w,force:!0})},_);return}}if(n.streamReader.cancel(new _util.AbortException(w.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[_,F]of this._intentStates)if(F===n){this._intentStates.delete(_);break}this.cleanup()}}}get stats(){return this._stats}}exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(n,w){const a={data:structuredClone(n,w?{transfer:w}:null)};this.#e.then(()=>{for(const _ of this.#t)_.call(this,a)})}addEventListener(n,w){this.#t.add(w)}removeEventListener(n,w){this.#t.delete(w)}terminate(){this.#t.clear()}}exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const U=document?.currentScript?.src;U&&(PDFWorkerUtil.fallbackWorkerSrc=U.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(U,n){let w;try{if(w=new URL(U),!w.origin||w.origin==="null")return!1}catch{return!1}const a=new URL(n,w);return w.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(U){const n=`importScripts("${U}");`;return URL.createObjectURL(new Blob([n]))}}class PDFWorker{static#workerPorts=new WeakMap;constructor({name:U=null,port:n=null,verbosity:w=(0,_util.getVerbosityLevel)()}={}){if(n&&PDFWorker.#workerPorts.has(n))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=U,this.destroyed=!1,this.verbosity=w,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,n){PDFWorker.#workerPorts.set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(U){this._port=U,this._messageHandler=new _message_handler.MessageHandler("main","worker",U),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:U}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,U)||(U=PDFWorkerUtil.createCDNWrapper(new URL(U,window.location).href));const n=new Worker(U),w=new _message_handler.MessageHandler("main","worker",n),a=()=>{n.removeEventListener("error",_),w.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},_=()=>{this._webWorker||a()};n.addEventListener("error",_),w.on("test",O=>{if(n.removeEventListener("error",_),this.destroyed){a();return}O?(this._messageHandler=w,this._port=n,this._webWorker=n,this._readyCapability.resolve(),w.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),w.destroy(),n.terminate())}),w.on("ready",O=>{if(n.removeEventListener("error",_),this.destroyed){a();return}try{F()}catch{this._setupFakeWorker()}});const F=()=>{const O=new Uint8Array;w.send("test",O,[O.buffer])};F();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(U=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const w=`fake${PDFWorkerUtil.fakeWorkerId++}`,a=new _message_handler.MessageHandler(w+"_worker",w,n);U.setup(a,n);const _=new _message_handler.MessageHandler(w,w+"_worker",n);this._messageHandler=_,this._readyCapability.resolve(),_.send("configure",{verbosity:this.verbosity})}).catch(U=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${U.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(U){if(!U?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(U.port)?this.#workerPorts.get(U.port):new PDFWorker(U)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports$1.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#i=new Map;#s=null;constructor(n,w,a,_,F){this.messageHandler=n,this.loadingTask=w,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:_.ownerDocument,styleElement:_.styleElement}),this._params=_,this.canvasFactory=F.canvasFactory,this.filterFactory=F.filterFactory,this.cMapReaderFactory=F.cMapReaderFactory,this.standardFontDataFactory=F.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#a(n,w=null){const a=this.#t.get(n);if(a)return a;const _=this.messageHandler.sendWithPromise(n,w);return this.#t.set(n,_),_}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(n,w=_util.AnnotationMode.ENABLE,a=null,_=!1){let F=_util.RenderingIntentFlag.DISPLAY,O=_annotation_storage.SerializableEmpty;switch(n){case"any":F=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":F=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(w){case _util.AnnotationMode.DISABLE:F+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:F+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:F+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,O=(F&_util.RenderingIntentFlag.PRINT&&a instanceof _annotation_storage.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${w}`)}return _&&(F+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:F,cacheKey:`${F}_${O.hash}`,annotationStorageSerializable:O}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const a of this.#e.values())n.push(a._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const w=this.messageHandler.sendWithPromise("Terminate",null);return n.push(w),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:w}=this;n.on("GetReader",(a,_)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=F=>{this._lastProgress={loaded:F.loaded,total:F.total}},_.onPull=()=>{this._fullReader.read().then(function({value:F,done:O}){if(O){_.close();return}(0,_util.assert)(F instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{_.error(F)})},_.onCancel=F=>{this._fullReader.cancel(F),_.ready.catch(O=>{if(!this.destroyed)throw O})}}),n.on("ReaderHeadersReady",a=>{const _=new _util.PromiseCapability,F=this._fullReader;return F.headersReady.then(()=>{(!F.isStreamingSupported||!F.isRangeSupported)&&(this._lastProgress&&w.onProgress?.(this._lastProgress),F.onProgress=O=>{w.onProgress?.({loaded:O.loaded,total:O.total})}),_.resolve({isStreamingSupported:F.isStreamingSupported,isRangeSupported:F.isRangeSupported,contentLength:F.contentLength})},_.reject),_.promise}),n.on("GetRangeReader",(a,_)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const F=this._networkStream.getRangeReader(a.begin,a.end);if(!F){_.close();return}_.onPull=()=>{F.read().then(function({value:O,done:L}){if(L){_.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{_.error(O)})},_.onCancel=O=>{F.cancel(O),_.ready.catch(L=>{if(!this.destroyed)throw L})}}),n.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,w._capability.resolve(new PDFDocumentProxy(a,this))}),n.on("DocException",function(a){let _;switch(a.name){case"PasswordException":_=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":_=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":_=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":_=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":_=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}w._capability.reject(_)}),n.on("PasswordRequest",a=>{if(this.#s=new _util.PromiseCapability,w.onPassword){const _=F=>{F instanceof Error?this.#s.reject(F):this.#s.resolve({password:F})};try{w.onPassword(_,a.code)}catch(F){this.#s.reject(F)}}else this.#s.reject(new _util.PasswordException(a.message,a.code));return this.#s.promise}),n.on("DataLoaded",a=>{w.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),n.on("StartRenderPage",a=>{if(this.destroyed)return;this.#e.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),n.on("commonobj",([a,_,F])=>{if(!this.destroyed&&!this.commonObjs.has(a))switch(_){case"Font":const O=this._params;if("error"in F){const t=F.error;(0,_util.warn)(`Error during font loading: ${t}`),this.commonObjs.resolve(a,t);break}const L=O.pdfBug&&globalThis.FontInspector?.enabled?(t,i)=>globalThis.FontInspector.fontAdded(t,i):null,S=new _font_loader.FontFaceObject(F,{isEvalSupported:O.isEvalSupported,disableFontFace:O.disableFontFace,ignoreErrors:O.ignoreErrors,inspectFont:L});this.fontLoader.bind(S).catch(t=>n.sendWithPromise("FontFallback",{id:a})).finally(()=>{!O.fontExtraProperties&&S.data&&(S.data=null),this.commonObjs.resolve(a,S)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,F);break;default:throw new Error(`Got unknown common object type ${_}`)}}),n.on("obj",([a,_,F,O])=>{if(this.destroyed)return;const L=this.#e.get(_);if(!L.objs.has(a))switch(F){case"Image":if(L.objs.resolve(a,O),O){let S;if(O.bitmap){const{width:t,height:i}=O;S=t*i*4}else S=O.data?.length||0;S>_util.MAX_IMAGE_SIZE_TO_CACHE&&(L._maybeCleanupAfterRender=!0)}break;case"Pattern":L.objs.resolve(a,O);break;default:throw new Error(`Got unknown object type ${F}`)}}),n.on("DocProgress",a=>{this.destroyed||w.onProgress?.({loaded:a.loaded,total:a.total})}),n.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfers:w}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:this._fullReader?.filename??null},w).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const w=n-1,a=this.#i.get(w);if(a)return a;const _=this.messageHandler.sendWithPromise("GetPage",{pageIndex:w}).then(F=>{if(this.destroyed)throw new Error("Transport destroyed");const O=new PDFPageProxy(w,F,this,this._params.pdfBug);return this.#e.set(w,O),O});return this.#i.set(w,_),_}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,w){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:w})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const n="GetMetadata",w=this.#t.get(n);if(w)return w;const a=this.messageHandler.sendWithPromise(n,null).then(_=>({info:_[0],metadata:_[1]?new _metadata.Metadata(_[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(n,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const w of this.#e.values())if(!w.cleanup())throw new Error(`startCleanup: Page ${w.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:n,enableXfa:w}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n,enableXfa:w})}}class PDFObjects{#t=Object.create(null);#e(n){const w=this.#t[n];return w||(this.#t[n]={capability:new _util.PromiseCapability,data:null})}get(n,w=null){if(w){const _=this.#e(n);return _.capability.promise.then(()=>w(_.data)),null}const a=this.#t[n];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${n}.`);return a.data}has(n){return this.#t[n]?.capability.settled||!1}resolve(n,w=null){const a=this.#e(n);a.data=w,a.capability.resolve()}clear(){for(const n in this.#t){const{data:w}=this.#t[n];w?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(n){this.#t=n,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(n=0){this.#t.cancel(null,n)}get separateAnnots(){const{separateAnnots:n}=this.#t.operatorList;if(!n)return!1;const{annotationCanvasMap:w}=this.#t;return n.form||n.canvas&&w?.size>0}}exports$1.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:n,params:w,objs:a,commonObjs:_,annotationCanvasMap:F,operatorList:O,pageIndex:L,canvasFactory:S,filterFactory:t,useRequestAnimationFrame:i=!1,pdfBug:d=!1,pageColors:r=null}){this.callback=n,this.params=w,this.objs=a,this.commonObjs=_,this.annotationCanvasMap=F,this.operatorListIdx=null,this.operatorList=O,this._pageIndex=L,this.canvasFactory=S,this.filterFactory=t,this._pdfBug=d,this.pageColors=r,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=i===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=w.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:w}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:_,transform:F,background:O}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:w},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:F,viewport:_,transparency:n,background:O}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(n=null,w=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,w))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.9.179";exports$1.version=version;const build="1ef6fbc52";exports$1.build=build}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SerializableEmpty=n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var a=w(1),_=w(4),F=w(8);const O=Object.freeze({map:null,hash:"",transfers:void 0});n.SerializableEmpty=O;class L{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(i,d){const r=this.#e.get(i);return r===void 0?d:Object.assign(d,r)}getRawValue(i){return this.#e.get(i)}remove(i){if(this.#e.delete(i),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const d of this.#e.values())if(d instanceof _.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(i,d){const r=this.#e.get(i);let o=!1;if(r!==void 0)for(const[e,f]of Object.entries(d))r[e]!==f&&(o=!0,r[e]=f);else o=!0,this.#e.set(i,d);o&&this.#i(),d instanceof _.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(d.constructor._type)}has(i){return this.#e.has(i)}getAll(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}setAll(i){for(const[d,r]of Object.entries(i))this.setValue(d,r)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S(this)}get serializable(){if(this.#e.size===0)return O;const i=new Map,d=new F.MurmurHash3_64,r=[],o=Object.create(null);let e=!1;for(const[f,u]of this.#e){const h=u instanceof _.AnnotationEditor?u.serialize(!1,o):u;h&&(i.set(f,h),d.update(`${f}:${JSON.stringify(h)}`),e||=!!h.bitmap)}if(e)for(const f of i.values())f.bitmap&&r.push(f.bitmap);return i.size>0?{map:i,hash:d.hexdigest(),transfers:r}:O}}n.AnnotationStorage=L;class S extends L{#t;constructor(i){super();const{map:d,hash:r,transfers:o}=i.serializable,e=structuredClone(d,o?{transfer:o}:null);this.#t={map:e,hash:r,transfers:o}}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}n.PrintAnnotationStorage=S}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var a=w(1),_=w(5);class F{#t=!1;#e=null;#i=null;#s=this.focusin.bind(this);#a=this.focusout.bind(this);#r=!1;#l=!1;#o=!1;_uiManager=null;#h=F._zIndex++;static _colorManager=new _.ColorManager;static _zIndex=1;constructor(S){this.constructor===F&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=S.parent,this.id=S.id,this.width=this.height=null,this.pageIndex=S.parent.pageIndex,this.name=S.name,this.div=null,this._uiManager=S.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1;const{rotation:t,rawDims:{pageWidth:i,pageHeight:d,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,d],this.pageTranslation=[r,o];const[e,f]=this.parentDimensions;this.x=S.x/e,this.y=S.y/f,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(S){const t=new O({id:S.parent.getNextId(),parent:S.parent,uiManager:S._uiManager});t.annotationElementId=S.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(S){}static updateDefaultParams(S,t){}static get defaultPropertiesToUpdate(){return[]}get propertiesToUpdate(){return[]}addCommands(S){this._uiManager.addCommands(S)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#h}setParent(S){S!==null&&(this.pageIndex=S.pageIndex,this.pageDimensions=S.pageDimensions),this.parent=S}focusin(S){this.#r?this.#r=!1:this.parent.setSelected(this)}focusout(S){!this.isAttachedToDOM||S.relatedTarget?.closest(`#${this.id}`)||(S.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(S){const t=this.parent.div.getBoundingClientRect();this.startX=S.clientX-t.x,this.startY=S.clientY-t.y,S.dataTransfer.setData("text/plain",this.id),S.dataTransfer.effectAllowed="move"}setAt(S,t,i,d){const[r,o]=this.parentDimensions;[i,d]=this.screenToPageTranslation(i,d),this.x=(S+i)/r,this.y=(t+d)/o,this.fixAndSetPosition()}#n([S,t],i,d){[i,d]=this.screenToPageTranslation(i,d),this.x+=i/S,this.y+=d/t,this.fixAndSetPosition()}translate(S,t){this.#n(this.parentDimensions,S,t)}translateInPage(S,t){this.#n(this.pageDimensions,S,t),this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[S,t]=this.pageDimensions;let{x:i,y:d,width:r,height:o}=this;switch(r*=S,o*=t,i*=S,d*=t,this.rotation){case 0:i=Math.max(0,Math.min(S-r,i)),d=Math.max(0,Math.min(t-o,d));break;case 90:i=Math.max(0,Math.min(S-o,i)),d=Math.min(t,Math.max(r,d));break;case 180:i=Math.min(S,Math.max(r,i)),d=Math.min(t,Math.max(o,d));break;case 270:i=Math.min(S,Math.max(o,i)),d=Math.max(0,Math.min(t-r,d));break}this.x=i/S,this.y=d/t,this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`}screenToPageTranslation(S,t){switch(this.parentRotation){case 90:return[t,-S];case 180:return[-S,-t];case 270:return[-t,S];default:return[S,t]}}pageTranslationToScreen(S,t){switch(this.parentRotation){case 90:return[-t,S];case 180:return[-S,-t];case 270:return[t,-S];default:return[S,t]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:S}=this._uiManager.viewParameters,[t,i]=this.pageDimensions;return[t*S,i*S]}setDims(S,t){const[i,d]=this.parentDimensions;this.div.style.width=`${(100*S/i).toFixed(2)}%`,this.#t||(this.div.style.height=`${(100*t/d).toFixed(2)}%`)}fixDims(){const{style:S}=this.div,{height:t,width:i}=S,d=i.endsWith("%"),r=!this.#t&&t.endsWith("%");if(d&&r)return;const[o,e]=this.parentDimensions;d||(S.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!this.#t&&!r&&(S.height=`${(100*parseFloat(t)/e).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#u(){if(this.#e)return;this.#e=document.createElement("div"),this.#e.classList.add("resizers");const S=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||S.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of S){const i=document.createElement("div");this.#e.append(i),i.classList.add("resizer",t),i.addEventListener("pointerdown",this.#p.bind(this,t))}this.div.prepend(this.#e)}#p(S,t){t.preventDefault(),this.#i=[t.clientX,t.clientY];const i=this.#d.bind(this,S),d=this.div.draggable;this.div.draggable=!1;const r=`resizing${S.charAt(0).toUpperCase()}${S.slice(1)}`;this.parent.div.classList.add(r);const o={passive:!0,capture:!0};window.addEventListener("pointermove",i,o);const e=()=>{this._uiManager.stopUndoAccumulation(),this.div.draggable=d,this.parent.div.classList.remove(r),window.removeEventListener("pointermove",i,o)};window.addEventListener("pointerup",e,{once:!0})}#d(S,t){const{clientX:i,clientY:d}=t,r=i-this.#i[0],o=d-this.#i[1];this.#i[0]=i,this.#i[1]=d;const[e,f]=this.parentDimensions,u=this.x,h=this.y,v=this.width,I=this.height,x=F.MIN_SIZE/e,g=F.MIN_SIZE/f;let A;const M=W=>Math.round(W*1e4)/1e4,H=(W,G)=>{const[Z,Q]=this.parentDimensions;this.setDims(Z*W,Q*G),this.fixAndSetPosition()},N=()=>{this.width=v,this.height=I,this.x=u,this.y=h,H(v,I)};switch(S){case"topLeft":{if(Math.sign(r)*Math.sign(o)<0)return;const W=Math.hypot(r,o),G=Math.hypot(v*e,I*f),Z=M(u+v),Q=M(h+I),tt=Math.max(Math.min(1-Math.sign(r)*(W/G),1/v,1/I),x/v,g/I),st=M(v*tt),K=M(I*tt),R=Z-st,m=Q-K;A=()=>{this.width=st,this.height=K,this.x=R,this.y=m,H(st,K)};break}case"topMiddle":{const W=M(this.y+I),G=M(Math.max(g,Math.min(1,I-o/f))),Z=W-G;A=()=>{this.height=G,this.y=Z,H(v,G)};break}case"topRight":{if(Math.sign(r)*Math.sign(o)>0)return;const W=Math.hypot(r,o),G=Math.hypot(this.width*e,this.height*f),Z=M(h+this.height),Q=Math.max(Math.min(1+Math.sign(r)*(W/G),1/v,1/I),x/v,g/I),tt=M(v*Q),st=M(I*Q),K=Z-st;A=()=>{this.width=tt,this.height=st,this.y=K,H(tt,st)};break}case"middleRight":{const W=M(Math.max(x,Math.min(1,v+r/e)));A=()=>{this.width=W,H(W,I)};break}case"bottomRight":{if(Math.sign(r)*Math.sign(o)<0)return;const W=Math.hypot(r,o),G=Math.hypot(this.width*e,this.height*f),Z=Math.max(Math.min(1+Math.sign(r)*(W/G),1/v,1/I),x/v,g/I),Q=M(v*Z),tt=M(I*Z);A=()=>{this.width=Q,this.height=tt,H(Q,tt)};break}case"bottomMiddle":{const W=M(Math.max(g,Math.min(1,I+o/f)));A=()=>{this.height=W,H(v,W)};break}case"bottomLeft":{if(Math.sign(r)*Math.sign(o)>0)return;const W=Math.hypot(r,o),G=Math.hypot(this.width*e,this.height*f),Z=M(u+this.width),Q=Math.max(Math.min(1-Math.sign(r)*(W/G),1/v,1/I),x/v,g/I),tt=M(v*Q),st=M(I*Q),K=Z-tt;A=()=>{this.width=tt,this.height=st,this.x=K,H(tt,st)};break}case"middleLeft":{const W=M(u+v),G=M(Math.max(x,Math.min(1,v-r/e))),Z=W-G;A=()=>{this.width=G,this.x=Z,H(G,I)};break}}this.addCommands({cmd:A,undo:N,mustExec:!0,type:a.AnnotationEditorParamsType.RESIZE,overwriteIfSameType:!0,keepUndo:!0})}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#s),this.div.addEventListener("focusout",this.#a);const[S,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/S).toFixed(2)}%`,this.div.style.maxHeight=`${(100*S/t).toFixed(2)}%`);const[i,d]=this.getInitialTranslation();return this.translate(i,d),(0,_.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(S){const{isMac:t}=a.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&t){S.preventDefault();return}S.ctrlKey&&!t||S.shiftKey||S.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#r=!0}getRect(S,t){const i=this.parentScale,[d,r]=this.pageDimensions,[o,e]=this.pageTranslation,f=S/i,u=t/i,h=this.x*d,v=this.y*r,I=this.width*d,x=this.height*r;switch(this.rotation){case 0:return[h+f+o,r-v-u-x+e,h+f+I+o,r-v-u+e];case 90:return[h+u+o,r-v+f+e,h+u+x+o,r-v+f+I+e];case 180:return[h-f-I+o,r-v+u+e,h-f+o,r-v+u+x+e];case 270:return[h-u-x+o,r-v-f-I+e,h-u+o,r-v-f+e];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(S,t){const[i,d,r,o]=S,e=r-i,f=o-d;switch(this.rotation){case 0:return[i,t-o,e,f];case 90:return[i,t-d,f,e];case 180:return[r,t-d,e,f];case 270:return[r,t-o,f,e];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#o=!0}disableEditMode(){this.#o=!1}isInEditMode(){return this.#o}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#s),this.div?.addEventListener("focusout",this.#a)}serialize(S=!1,t=null){(0,a.unreachable)("An editor must be serializable")}static deserialize(S,t,i){const d=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});d.rotation=S.rotation;const[r,o]=d.pageDimensions,[e,f,u,h]=d.getRectInCurrentCoords(S.rect,o);return d.x=e/r,d.y=f/o,d.width=u/r,d.height=h/o,d}remove(){this.div.removeEventListener("focusin",this.#s),this.div.removeEventListener("focusout",this.#a),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this)}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#u(),this.#e.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#e?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(S,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#l}set isEditing(S){this.#l=S,this.parent&&(S?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(S,t){this.#t=!0;const i=S/t,{style:d}=this.div;d.aspectRatio=i,d.height="auto"}static get MIN_SIZE(){return 16}}n.AnnotationEditor=F;class O extends F{constructor(S){super(S),this.annotationElementId=S.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=F,n.opacityToHex=O;var a=w(1),_=w(6);function F(o,e,f){for(const u of f)e.addEventListener(u,o[u].bind(o))}function O(o){return Math.round(Math.min(255,Math.max(1,255*o))).toString(16).padStart(2,"0")}class L{#t=0;getId(){return`${a.AnnotationEditorPrefix}${this.#t++}`}}class S{#t=(0,a.getUuid)();#e=0;#i=null;async#s(e,f){this.#i||=new Map;let u=this.#i.get(e);if(u===null)return null;if(u?.bitmap)return u.refCounter+=1,u;try{u||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let h;if(typeof f=="string"){u.url=f;const v=await fetch(f);if(!v.ok)throw new Error(v.statusText);h=await v.blob()}else h=u.file=f;if(h.type==="image/svg+xml"){const v=new FileReader,I=new Image,x=new Promise((g,A)=>{I.onload=()=>{u.bitmap=I,u.isSvg=!0,g()},v.onload=()=>{I.src=u.svgUrl=v.result},I.onerror=v.onerror=A});v.readAsDataURL(h),await x}else u.bitmap=await createImageBitmap(h);u.refCounter=1}catch(h){console.error(h),u=null}return this.#i.set(e,u),u&&this.#i.set(u.id,u),u}async getFromFile(e){const{lastModified:f,name:u,size:h,type:v}=e;return this.#s(`${f}_${u}_${h}_${v}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromId(e){this.#i||=new Map;const f=this.#i.get(e);return f?f.bitmap?(f.refCounter+=1,f):f.file?this.getFromFile(f.file):this.getFromUrl(f.url):null}getSvgUrl(e){const f=this.#i.get(e);return f?.isSvg?f.svgUrl:null}deleteId(e){this.#i||=new Map;const f=this.#i.get(e);f&&(f.refCounter-=1,f.refCounter===0&&(f.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#t}_`)}}class t{#t=[];#e=!1;#i;#s=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:f,mustExec:u,type:h=NaN,overwriteIfSameType:v=!1,keepUndo:I=!1}){if(u&&e(),this.#e)return;const x={cmd:e,undo:f,type:h};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(x);return}if(v&&this.#t[this.#s].type===h){I&&(x.undo=this.#t[this.#s].undo),this.#t[this.#s]=x;return}const g=this.#s+1;g===this.#i?this.#t.splice(0,1):(this.#s=g,g<this.#t.length&&this.#t.splice(g)),this.#t.push(x)}stopUndoAccumulation(){this.#s!==-1&&(this.#t[this.#s].type=NaN)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}n.CommandManager=t;class i{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:f}=a.FeatureTest.platform;for(const[u,h,v={}]of e)for(const I of u){const x=I.startsWith("mac+");f&&x?(this.callbacks.set(I.slice(4),{callback:h,options:v}),this.allKeys.add(I.split("+").at(-1))):!f&&!x&&(this.callbacks.set(I,{callback:h,options:v}),this.allKeys.add(I.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const f=this.buffer.join("+");return this.buffer.length=0,f}exec(e,f){if(!this.allKeys.has(f.key))return;const u=this.callbacks.get(this.#t(f));if(!u)return;const{callback:h,options:{bubbles:v=!1,args:I=[],checker:x=null}}=u;x&&!x(e,f)||(h.bind(e,...I)(),v||(f.stopPropagation(),f.preventDefault()))}}n.KeyboardManager=i;class d{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,_.getColorValues)(e),(0,a.shadow)(this,"_colors",e)}convert(e){const f=(0,_.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return f;for(const[u,h]of this._colors)if(h.every((v,I)=>v===f[I]))return d._colorsMapping.get(u);return f}getHexCode(e){const f=this._colors.get(e);return f?a.Util.makeHexColor(...f):e}}n.ColorManager=d;class r{#t=null;#e=new Map;#i=new Map;#s=null;#a=new t;#r=0;#l=new Set;#o=null;#h=new Set;#n=null;#u=null;#p=new L;#d=!1;#f=a.AnnotationEditorType.NONE;#c=new Set;#g=null;#b=this.copy.bind(this);#_=this.cut.bind(this);#v=this.paste.bind(this);#P=this.keydown.bind(this);#M=this.onEditingAction.bind(this);#x=this.onPageChanging.bind(this);#I=this.onScaleChanging.bind(this);#D=this.onRotationChanging.bind(this);#O={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#S=[0,0];#C=null;#A=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=r.prototype,f=v=>{const{activeElement:I}=document;return I&&v.#A.contains(I)&&v.hasSomethingToControl()},u=this.TRANSLATE_SMALL,h=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new i([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-u,0],checker:f}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-h,0],checker:f}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[u,0],checker:f}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[h,0],checker:f}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-u],checker:f}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-h],checker:f}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,u],checker:f}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,h],checker:f}]]))}constructor(e,f,u,h){this.#A=e,this.#n=f,this.#n._on("editingaction",this.#M),this.#n._on("pagechanging",this.#x),this.#n._on("scalechanging",this.#I),this.#n._on("rotationchanging",this.#D),this.#s=u.annotationStorage,this.#u=u.filterFactory,this.#g=h,this.viewParameters={realScale:_.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#w(),this.#n._off("editingaction",this.#M),this.#n._off("pagechanging",this.#x),this.#n._off("scalechanging",this.#I),this.#n._off("rotationchanging",this.#D);for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#e.clear(),this.#h.clear(),this.#t=null,this.#c.clear(),this.#a.destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",this.#g?this.#u.addHCMFilter(this.#g.foreground,this.#g.background):"none")}onPageChanging({pageNumber:e}){this.#r=e-1}focusMainContainer(){this.#A.focus()}addShouldRescale(e){this.#h.add(e)}removeShouldRescale(e){this.#h.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*_.PixelsPerInch.PDF_TO_CSS_UNITS;for(const f of this.#h)f.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}#L(){window.addEventListener("keydown",this.#P,{capture:!0})}#w(){window.removeEventListener("keydown",this.#P,{capture:!0})}#k(){document.addEventListener("copy",this.#b),document.addEventListener("cut",this.#_),document.addEventListener("paste",this.#v)}#E(){document.removeEventListener("copy",this.#b),document.removeEventListener("cut",this.#_),document.removeEventListener("paste",this.#v)}copy(e){if(e.preventDefault(),this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const f=[];for(const u of this.#c){const h=u.serialize(!0);h&&f.push(h)}f.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(f))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();let f=e.clipboardData.getData("application/pdfjs");if(!f)return;try{f=JSON.parse(f)}catch(h){(0,a.warn)(`paste: "${h.message}".`);return}if(!Array.isArray(f))return;this.unselectAll();const u=this.currentLayer;try{const h=[];for(const x of f){const g=u.deserialize(x);if(!g)return;h.push(g)}const v=()=>{for(const x of h)this.#j(x);this.#R(h)},I=()=>{for(const x of h)x.remove()};this.addCommands({cmd:v,undo:I,mustExec:!0})}catch(h){(0,a.warn)(`paste: "${h.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||r._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#m(e){Object.entries(e).some(([u,h])=>this.#O[u]!==h)&&this.#n.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#O,e)})}#y(e){this.#n.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#L(),this.#k(),this.#m({isEditing:this.#f!==a.AnnotationEditorType.NONE,isEmpty:this.#T(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#w(),this.#E(),this.#m({isEditing:!1}))}registerEditorTypes(e){if(!this.#o){this.#o=e;for(const f of this.#o)this.#y(f.defaultPropertiesToUpdate)}}getId(){return this.#p.getId()}get currentLayer(){return this.#i.get(this.#r)}get currentPageIndex(){return this.#r}addLayer(e){this.#i.set(e.pageIndex,e),this.#d?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}updateMode(e,f=null){if(this.#f=e,e===a.AnnotationEditorType.NONE){this.setEditingState(!1),this.#N();return}this.setEditingState(!0),this.#U();for(const u of this.#i.values())u.updateMode(e);if(f){for(const u of this.#e.values())if(u.annotationElementId===f){this.setSelected(u),u.enterInEditMode();break}}}updateToolbar(e){e!==this.#f&&this.#n.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,f){if(this.#o){for(const u of this.#c)u.updateParams(e,f);for(const u of this.#o)u.updateDefaultParams(e,f)}}#U(){if(!this.#d){this.#d=!0;for(const e of this.#i.values())e.enable()}}#N(){if(this.unselectAll(),this.#d){this.#d=!1;for(const e of this.#i.values())e.disable()}}getEditors(e){const f=[];for(const u of this.#e.values())u.pageIndex===e&&f.push(u);return f}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#j(e){const f=this.#i.get(e.pageIndex);f?f.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#y(e.propertiesToUpdate))}toggleSelected(e){if(this.#c.has(e)){this.#c.delete(e),e.unselect(),this.#m({hasSelectedEditor:this.hasSelection});return}this.#c.add(e),e.select(),this.#y(e.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}setSelected(e){for(const f of this.#c)f!==e&&f.unselect();this.#c.clear(),this.#c.add(e),e.select(),this.#y(e.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}isSelected(e){return this.#c.has(e)}unselect(e){e.unselect(),this.#c.delete(e),this.#m({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#c.size!==0}stopUndoAccumulation(){this.#a.stopUndoAccumulation()}undo(){this.#a.undo(),this.#m({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#T()})}redo(){this.#a.redo(),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#T()})}addCommands(e){this.#a.add(e),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#T()})}#T(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#c],f=()=>{for(const h of e)h.remove()},u=()=>{for(const h of e)this.#j(h)};this.addCommands({cmd:f,undo:u,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#R(e){this.#c.clear();for(const f of e)f.isEmpty()||(this.#c.add(f),f.select());this.#m({hasSelectedEditor:!0})}selectAll(){for(const e of this.#c)e.commit();this.#R(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(const e of this.#c)e.unselect();this.#c.clear(),this.#m({hasSelectedEditor:!1})}}translateSelectedEditors(e,f,u=!1){if(u||this.commitOrRemove(),!this.hasSelection)return;this.#S[0]+=e,this.#S[1]+=f;const[h,v]=this.#S,I=[...this.#c],x=1e3;this.#C&&clearTimeout(this.#C),this.#C=setTimeout(()=>{this.#C=null,this.#S[0]=this.#S[1]=0,this.addCommands({cmd:()=>{for(const g of I)this.#e.has(g.id)&&g.translateInPage(h,v)},undo:()=>{for(const g of I)this.#e.has(g.id)&&g.translateInPage(-h,-v)},mustExec:!1})},x);for(const g of I)g.translateInPage(e,f)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#f}get imageManager(){return(0,a.shadow)(this,"imageManager",new S)}}n.AnnotationEditorUIManager=r}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=M,n.getColorValues=Z,n.getCurrentTransform=Q,n.getCurrentTransformInverse=tt,n.getFilenameFromUrl=v,n.getPdfFilenameFromUrl=I,n.getRGB=G,n.getXfaPageViewport=W,n.isDataScheme=u,n.isPdfFile=h,n.isValidFetchUrl=g,n.loadScript=A,n.setLayerDimensions=st;var a=w(7),_=w(1);const F="http://www.w3.org/2000/svg",O="pdfjs_internal_id_";n.AnnotationPrefix=O;class L{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}n.PixelsPerInch=L;class S extends a.BaseFilterFactory{#t;#e;#i;#s;#a;#r;#l;#o;#h;#n;#u=0;constructor({docId:R,ownerDocument:m=globalThis.document}={}){super(),this.#i=R,this.#s=m}get#p(){return this.#t||=new Map}get#d(){if(!this.#e){const R=this.#s.createElement("div"),{style:m}=R;m.visibility="hidden",m.contain="strict",m.width=m.height=0,m.position="absolute",m.top=m.left=0,m.zIndex=-1;const l=this.#s.createElementNS(F,"svg");l.setAttribute("width",0),l.setAttribute("height",0),this.#e=this.#s.createElementNS(F,"defs"),R.append(l),l.append(this.#e),this.#s.body.append(R)}return this.#e}addFilter(R){if(!R)return"none";let m=this.#p.get(R);if(m)return m;let l,c,b,P;if(R.length===1){const s=R[0],p=new Array(256);for(let y=0;y<256;y++)p[y]=s[y]/255;P=l=c=b=p.join(",")}else{const[s,p,y]=R,E=new Array(256),C=new Array(256),j=new Array(256);for(let B=0;B<256;B++)E[B]=s[B]/255,C[B]=p[B]/255,j[B]=y[B]/255;l=E.join(","),c=C.join(","),b=j.join(","),P=`${l}${c}${b}`}if(m=this.#p.get(P),m)return this.#p.set(R,m),m;const T=`g_${this.#i}_transfer_map_${this.#u++}`,D=`url(#${T})`;this.#p.set(R,D),this.#p.set(P,D);const k=this.#c(T);return this.#b(l,c,b,k),D}addHCMFilter(R,m){const l=`${R}-${m}`;if(this.#r===l)return this.#l;if(this.#r=l,this.#l="none",this.#a?.remove(),!R||!m)return this.#l;const c=this.#_(R);R=_.Util.makeHexColor(...c);const b=this.#_(m);if(m=_.Util.makeHexColor(...b),this.#d.style.color="",R==="#000000"&&m==="#ffffff"||R===m)return this.#l;const P=new Array(256);for(let p=0;p<=255;p++){const y=p/255;P[p]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const T=P.join(","),D=`g_${this.#i}_hcm_filter`,k=this.#o=this.#c(D);this.#b(T,T,T,k),this.#f(k);const s=(p,y)=>{const E=c[p]/255,C=b[p]/255,j=new Array(y+1);for(let B=0;B<=y;B++)j[B]=E+B/y*(C-E);return j.join(",")};return this.#b(s(0,5),s(1,5),s(2,5),k),this.#l=`url(#${D})`,this.#l}addHighlightHCMFilter(R,m,l,c){const b=`${R}-${m}-${l}-${c}`;if(this.#h===b)return this.#n;if(this.#h=b,this.#n="none",this.#o?.remove(),!R||!m)return this.#n;const[P,T]=[R,m].map(this.#_.bind(this));let D=Math.round(.2126*P[0]+.7152*P[1]+.0722*P[2]),k=Math.round(.2126*T[0]+.7152*T[1]+.0722*T[2]),[s,p]=[l,c].map(this.#_.bind(this));k<D&&([D,k,s,p]=[k,D,p,s]),this.#d.style.color="";const y=(j,B,V)=>{const nt=new Array(256),q=(k-D)/V,Y=j/255,J=(B-j)/(255*V);let $=0;for(let et=0;et<=V;et++){const rt=Math.round(D+et*q),ot=Y+et*J;for(let lt=$;lt<=rt;lt++)nt[lt]=ot;$=rt+1}for(let et=$;et<256;et++)nt[et]=nt[$-1];return nt.join(",")},E=`g_${this.#i}_hcm_highlight_filter`,C=this.#o=this.#c(E);return this.#f(C),this.#b(y(s[0],p[0],5),y(s[1],p[1],5),y(s[2],p[2],5),C),this.#n=`url(#${E})`,this.#n}destroy(R=!1){R&&(this.#l||this.#n)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#u=0)}#f(R){const m=this.#s.createElementNS(F,"feColorMatrix");m.setAttribute("type","matrix"),m.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),R.append(m)}#c(R){const m=this.#s.createElementNS(F,"filter");return m.setAttribute("color-interpolation-filters","sRGB"),m.setAttribute("id",R),this.#d.append(m),m}#g(R,m,l){const c=this.#s.createElementNS(F,m);c.setAttribute("type","discrete"),c.setAttribute("tableValues",l),R.append(c)}#b(R,m,l,c){const b=this.#s.createElementNS(F,"feComponentTransfer");c.append(b),this.#g(b,"feFuncR",R),this.#g(b,"feFuncG",m),this.#g(b,"feFuncB",l)}#_(R){return this.#d.style.color=R,G(getComputedStyle(this.#d).getPropertyValue("color"))}}n.DOMFilterFactory=S;class t extends a.BaseCanvasFactory{constructor({ownerDocument:R=globalThis.document}={}){super(),this._document=R}_createCanvas(R,m){const l=this._document.createElement("canvas");return l.width=R,l.height=m,l}}n.DOMCanvasFactory=t;async function i(K,R=!1){if(g(K,document.baseURI)){const m=await fetch(K);if(!m.ok)throw new Error(m.statusText);return R?new Uint8Array(await m.arrayBuffer()):(0,_.stringToBytes)(await m.text())}return new Promise((m,l)=>{const c=new XMLHttpRequest;c.open("GET",K,!0),R&&(c.responseType="arraybuffer"),c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE){if(c.status===200||c.status===0){let b;if(R&&c.response?b=new Uint8Array(c.response):!R&&c.responseText&&(b=(0,_.stringToBytes)(c.responseText)),b){m(b);return}}l(new Error(c.statusText))}},c.send(null)})}class d extends a.BaseCMapReaderFactory{_fetchData(R,m){return i(R,this.isCompressed).then(l=>({cMapData:l,compressionType:m}))}}n.DOMCMapReaderFactory=d;class r extends a.BaseStandardFontDataFactory{_fetchData(R){return i(R,!0)}}n.DOMStandardFontDataFactory=r;class o extends a.BaseSVGFactory{_createSVG(R){return document.createElementNS(F,R)}}n.DOMSVGFactory=o;class e{constructor({viewBox:R,scale:m,rotation:l,offsetX:c=0,offsetY:b=0,dontFlip:P=!1}){this.viewBox=R,this.scale=m,this.rotation=l,this.offsetX=c,this.offsetY=b;const T=(R[2]+R[0])/2,D=(R[3]+R[1])/2;let k,s,p,y;switch(l%=360,l<0&&(l+=360),l){case 180:k=-1,s=0,p=0,y=1;break;case 90:k=0,s=1,p=1,y=0;break;case 270:k=0,s=-1,p=-1,y=0;break;case 0:k=1,s=0,p=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}P&&(p=-p,y=-y);let E,C,j,B;k===0?(E=Math.abs(D-R[1])*m+c,C=Math.abs(T-R[0])*m+b,j=(R[3]-R[1])*m,B=(R[2]-R[0])*m):(E=Math.abs(T-R[0])*m+c,C=Math.abs(D-R[1])*m+b,j=(R[2]-R[0])*m,B=(R[3]-R[1])*m),this.transform=[k*m,s*m,p*m,y*m,E-k*m*T-p*m*D,C-s*m*T-y*m*D],this.width=j,this.height=B}get rawDims(){const{viewBox:R}=this;return(0,_.shadow)(this,"rawDims",{pageWidth:R[2]-R[0],pageHeight:R[3]-R[1],pageX:R[0],pageY:R[1]})}clone({scale:R=this.scale,rotation:m=this.rotation,offsetX:l=this.offsetX,offsetY:c=this.offsetY,dontFlip:b=!1}={}){return new e({viewBox:this.viewBox.slice(),scale:R,rotation:m,offsetX:l,offsetY:c,dontFlip:b})}convertToViewportPoint(R,m){return _.Util.applyTransform([R,m],this.transform)}convertToViewportRectangle(R){const m=_.Util.applyTransform([R[0],R[1]],this.transform),l=_.Util.applyTransform([R[2],R[3]],this.transform);return[m[0],m[1],l[0],l[1]]}convertToPdfPoint(R,m){return _.Util.applyInverseTransform([R,m],this.transform)}}n.PageViewport=e;class f extends _.BaseException{constructor(R,m=0){super(R,"RenderingCancelledException"),this.extraDelay=m}}n.RenderingCancelledException=f;function u(K){const R=K.length;let m=0;for(;m<R&&K[m].trim()==="";)m++;return K.substring(m,m+5).toLowerCase()==="data:"}function h(K){return typeof K=="string"&&/\.pdf$/i.test(K)}function v(K,R=!1){return R||([K]=K.split(/[#?]/,1)),K.substring(K.lastIndexOf("/")+1)}function I(K,R="document.pdf"){if(typeof K!="string")return R;if(u(K))return(0,_.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),R;const m=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,c=m.exec(K);let b=l.exec(c[1])||l.exec(c[2])||l.exec(c[3]);if(b&&(b=b[0],b.includes("%")))try{b=l.exec(decodeURIComponent(b))[0]}catch{}return b||R}class x{started=Object.create(null);times=[];time(R){R in this.started&&(0,_.warn)(`Timer is already running for ${R}`),this.started[R]=Date.now()}timeEnd(R){R in this.started||(0,_.warn)(`Timer has not been started for ${R}`),this.times.push({name:R,start:this.started[R],end:Date.now()}),delete this.started[R]}toString(){const R=[];let m=0;for(const{name:l}of this.times)m=Math.max(l.length,m);for(const{name:l,start:c,end:b}of this.times)R.push(`${l.padEnd(m)} ${b-c}ms
`);return R.join("")}}n.StatTimer=x;function g(K,R){try{const{protocol:m}=R?new URL(K,R):new URL(K);return m==="http:"||m==="https:"}catch{return!1}}function A(K,R=!1){return new Promise((m,l)=>{const c=document.createElement("script");c.src=K,c.onload=function(b){R&&c.remove(),m(b)},c.onerror=function(){l(new Error(`Cannot load script at: ${c.src}`))},(document.head||document.documentElement).append(c)})}function M(K){console.log("Deprecated API usage: "+K)}let H;class N{static toDateObject(R){if(!R||typeof R!="string")return null;H||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const m=H.exec(R);if(!m)return null;const l=parseInt(m[1],10);let c=parseInt(m[2],10);c=c>=1&&c<=12?c-1:0;let b=parseInt(m[3],10);b=b>=1&&b<=31?b:1;let P=parseInt(m[4],10);P=P>=0&&P<=23?P:0;let T=parseInt(m[5],10);T=T>=0&&T<=59?T:0;let D=parseInt(m[6],10);D=D>=0&&D<=59?D:0;const k=m[7]||"Z";let s=parseInt(m[8],10);s=s>=0&&s<=23?s:0;let p=parseInt(m[9],10)||0;return p=p>=0&&p<=59?p:0,k==="-"?(P+=s,T+=p):k==="+"&&(P-=s,T-=p),new Date(Date.UTC(l,c,b,P,T,D))}}n.PDFDateString=N;function W(K,{scale:R=1,rotation:m=0}){const{width:l,height:c}=K.attributes.style,b=[0,0,parseInt(l),parseInt(c)];return new e({viewBox:b,scale:R,rotation:m})}function G(K){if(K.startsWith("#")){const R=parseInt(K.slice(1),16);return[(R&16711680)>>16,(R&65280)>>8,R&255]}return K.startsWith("rgb(")?K.slice(4,-1).split(",").map(R=>parseInt(R)):K.startsWith("rgba(")?K.slice(5,-1).split(",").map(R=>parseInt(R)).slice(0,3):((0,_.warn)(`Not a valid color format: "${K}"`),[0,0,0])}function Z(K){const R=document.createElement("span");R.style.visibility="hidden",document.body.append(R);for(const m of K.keys()){R.style.color=m;const l=window.getComputedStyle(R).color;K.set(m,G(l))}R.remove()}function Q(K){const{a:R,b:m,c:l,d:c,e:b,f:P}=K.getTransform();return[R,m,l,c,b,P]}function tt(K){const{a:R,b:m,c:l,d:c,e:b,f:P}=K.getTransform().invertSelf();return[R,m,l,c,b,P]}function st(K,R,m=!1,l=!0){if(R instanceof e){const{pageWidth:c,pageHeight:b}=R.rawDims,{style:P}=K,T=`calc(var(--scale-factor) * ${c}px)`,D=`calc(var(--scale-factor) * ${b}px)`;!m||R.rotation%180===0?(P.width=T,P.height=D):(P.width=D,P.height=T)}l&&K.setAttribute("data-main-rotation",R.rotation)}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var a=w(1);class _{constructor(){this.constructor===_&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(i){return"none"}addHCMFilter(i,d){return"none"}addHighlightHCMFilter(i,d,r,o){return"none"}destroy(i=!1){}}n.BaseFilterFactory=_;class F{constructor(){this.constructor===F&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(i,d){if(i<=0||d<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(i,d);return{canvas:r,context:r.getContext("2d")}}reset(i,d,r){if(!i.canvas)throw new Error("Canvas is not specified");if(d<=0||r<=0)throw new Error("Invalid canvas size");i.canvas.width=d,i.canvas.height=r}destroy(i){if(!i.canvas)throw new Error("Canvas is not specified");i.canvas.width=0,i.canvas.height=0,i.canvas=null,i.context=null}_createCanvas(i,d){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=F;class O{constructor({baseUrl:i=null,isCompressed:d=!0}){this.constructor===O&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=i,this.isCompressed=d}async fetch({name:i}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!i)throw new Error("CMap name must be specified.");const d=this.baseUrl+i+(this.isCompressed?".bcmap":""),r=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(d,r).catch(o=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${d}`)})}_fetchData(i,d){(0,a.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=O;class L{constructor({baseUrl:i=null}){this.constructor===L&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=i}async fetch({filename:i}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!i)throw new Error("Font filename must be specified.");const d=`${this.baseUrl}${i}`;return this._fetchData(d).catch(r=>{throw new Error(`Unable to load font data at: ${d}`)})}_fetchData(i){(0,a.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=L;class S{constructor(){this.constructor===S&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(i,d,r=!1){if(i<=0||d<=0)throw new Error("Invalid SVG dimensions");const o=this._createSVG("svg:svg");return o.setAttribute("version","1.1"),r||(o.setAttribute("width",`${i}px`),o.setAttribute("height",`${d}px`)),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox",`0 0 ${i} ${d}`),o}createElement(i){if(typeof i!="string")throw new Error("Invalid SVG element type");return this._createSVG(i)}_createSVG(i){(0,a.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=S}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var a=w(1);const _=3285377520,F=4294901760,O=65535;class L{constructor(t){this.h1=t?t&4294967295:_,this.h2=t?t&4294967295:_}update(t){let i,d;if(typeof t=="string"){i=new Uint8Array(t.length*2),d=0;for(let M=0,H=t.length;M<H;M++){const N=t.charCodeAt(M);N<=255?i[d++]=N:(i[d++]=N>>>8,i[d++]=N&255)}}else if((0,a.isArrayBuffer)(t))i=t.slice(),d=i.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const r=d>>2,o=d-r*4,e=new Uint32Array(i.buffer,0,r);let f=0,u=0,h=this.h1,v=this.h2;const I=3432918353,x=461845907,g=I&O,A=x&O;for(let M=0;M<r;M++)M&1?(f=e[M],f=f*I&F|f*g&O,f=f<<15|f>>>17,f=f*x&F|f*A&O,h^=f,h=h<<13|h>>>19,h=h*5+3864292196):(u=e[M],u=u*I&F|u*g&O,u=u<<15|u>>>17,u=u*x&F|u*A&O,v^=u,v=v<<13|v>>>19,v=v*5+3864292196);switch(f=0,o){case 3:f^=i[r*4+2]<<16;case 2:f^=i[r*4+1]<<8;case 1:f^=i[r*4],f=f*I&F|f*g&O,f=f<<15|f>>>17,f=f*x&F|f*A&O,r&1?h^=f:v^=f}this.h1=h,this.h2=v}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&F|t*36045&O,i=i*4283543511&F|((i<<16|t>>>16)*2950163797&F)>>>16,t^=i>>>1,t=t*444984403&F|t*60499&O,i=i*3301882366&F|((i<<16|t>>>16)*3120437893&F)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=L}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var a=w(1);class _{#t=new Set;constructor({ownerDocument:L=globalThis.document,styleElement:S=null}){this._document=L,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(L){this.nativeFontFaces.add(L),this._document.fonts.add(L)}removeNativeFontFace(L){this.nativeFontFaces.delete(L),this._document.fonts.delete(L)}insertRule(L){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const S=this.styleElement.sheet;S.insertRule(L,S.cssRules.length)}clear(){for(const L of this.nativeFontFaces)this._document.fonts.delete(L);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(L){if(!(!L||this.#t.has(L.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:S,src:t,style:i}=L,d=new FontFace(S,t,i);this.addNativeFontFace(d);try{await d.load(),this.#t.add(S)}catch{(0,a.warn)(`Cannot load system font: ${L.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(d)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(L){if(L.attached||L.missingFile&&!L.systemFontInfo)return;if(L.attached=!0,L.systemFontInfo){await this.loadSystemFont(L.systemFontInfo);return}if(this.isFontLoadingAPISupported){const t=L.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(i){throw(0,a.warn)(`Failed to load font '${t.family}': '${i}'.`),L.disableFontFace=!0,i}}return}const S=L.createFontFaceRule();if(S){if(this.insertRule(S),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const i=this._queueLoadingCallback(t);this._prepareFontLoadEvent(L,i)})}}get isFontLoadingAPISupported(){const L=!!this._document?.fonts;return(0,a.shadow)(this,"isFontLoadingAPISupported",L)}get isSyncFontLoadingSupported(){let L=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(L=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",L)}_queueLoadingCallback(L){function S(){for((0,a.assert)(!i.done,"completeRequest() cannot be called twice."),i.done=!0;t.length>0&&t[0].done;){const d=t.shift();setTimeout(d.callback,0)}}const{loadingRequests:t}=this,i={done:!1,complete:S,callback:L};return t.push(i),i}get _loadTestFont(){const L=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",L)}_prepareFontLoadEvent(L,S){function t(W,G){return W.charCodeAt(G)<<24|W.charCodeAt(G+1)<<16|W.charCodeAt(G+2)<<8|W.charCodeAt(G+3)&255}function i(W,G,Z,Q){const tt=W.substring(0,G),st=W.substring(G+Z);return tt+Q+st}let d,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const e=o.getContext("2d");let f=0;function u(W,G){if(++f>30){(0,a.warn)("Load test font never loaded."),G();return}if(e.font="30px "+W,e.fillText(".",0,20),e.getImageData(0,0,1,1).data[3]>0){G();return}setTimeout(u.bind(null,W,G))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=i(v,976,h.length,h);const x=16,g=1482184792;let A=t(v,x);for(d=0,r=h.length-3;d<r;d+=4)A=A-g+t(h,d)|0;d<h.length&&(A=A-g+t(h+"XXX",d)|0),v=i(v,x,4,(0,a.string32)(A));const M=`url(data:font/opentype;base64,${btoa(v)});`,H=`@font-face {font-family:"${h}";src:${M}}`;this.insertRule(H);const N=this._document.createElement("div");N.style.visibility="hidden",N.style.width=N.style.height="10px",N.style.position="absolute",N.style.top=N.style.left="0px";for(const W of[L.loadedName,h]){const G=this._document.createElement("span");G.textContent="Hi",G.style.fontFamily=W,N.append(G)}this._document.body.append(N),u(h,()=>{N.remove(),S.complete()})}}n.FontLoader=_;class F{constructor(L,{isEvalSupported:S=!0,disableFontFace:t=!1,ignoreErrors:i=!1,inspectFont:d=null}){this.compiledGlyphs=Object.create(null);for(const r in L)this[r]=L[r];this.isEvalSupported=S!==!1,this.disableFontFace=t===!0,this.ignoreErrors=i===!0,this._inspectFont=d}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let L;if(!this.cssFontInfo)L=new FontFace(this.loadedName,this.data,{});else{const S={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(S.style=`oblique ${this.cssFontInfo.italicAngle}deg`),L=new FontFace(this.cssFontInfo.fontFamily,this.data,S)}return this._inspectFont?.(this),L}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const L=(0,a.bytesToString)(this.data),S=`url(data:${this.mimetype};base64,${btoa(L)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${S}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${S}}`}return this._inspectFont?.(this,S),t}getPathGenerator(L,S){if(this.compiledGlyphs[S]!==void 0)return this.compiledGlyphs[S];let t;try{t=L.get(this.loadedName+"_path_"+S)}catch(i){if(!this.ignoreErrors)throw i;return(0,a.warn)(`getPathGenerator - ignoring character: "${i}".`),this.compiledGlyphs[S]=function(d,r){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const i=[];for(const d of t){const r=d.args!==void 0?d.args.join(","):"";i.push("c.",d.cmd,"(",r,`);
`)}return this.compiledGlyphs[S]=new Function("c","size",i.join(""))}return this.compiledGlyphs[S]=function(i,d){for(const r of t)r.cmd==="scale"&&(r.args=[d,-d]),i[r.cmd].apply(i,r.args)}}}n.FontFaceObject=F}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var a=w(7);w(1);const _=function(t){return new Promise((i,d)=>{require$$5.readFile(t,(o,e)=>{if(o||!e){d(new Error(o));return}i(new Uint8Array(e))})})};class F extends a.BaseFilterFactory{}n.NodeFilterFactory=F;class O extends a.BaseCanvasFactory{_createCanvas(i,d){return require$$5.createCanvas(i,d)}}n.NodeCanvasFactory=O;class L extends a.BaseCMapReaderFactory{_fetchData(i,d){return _(i).then(r=>({cMapData:r,compressionType:d}))}}n.NodeCMapReaderFactory=L;class S extends a.BaseStandardFontDataFactory{_fetchData(i){return _(i)}}n.NodeStandardFontDataFactory=S}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var a=w(1),_=w(6),F=w(12),O=w(13);const L=16,S=100,t=4096,i=15,d=10,r=1e3,o=16;function e(m,l){if(m._removeMirroring)throw new Error("Context is already forwarding operations.");m.__originalSave=m.save,m.__originalRestore=m.restore,m.__originalRotate=m.rotate,m.__originalScale=m.scale,m.__originalTranslate=m.translate,m.__originalTransform=m.transform,m.__originalSetTransform=m.setTransform,m.__originalResetTransform=m.resetTransform,m.__originalClip=m.clip,m.__originalMoveTo=m.moveTo,m.__originalLineTo=m.lineTo,m.__originalBezierCurveTo=m.bezierCurveTo,m.__originalRect=m.rect,m.__originalClosePath=m.closePath,m.__originalBeginPath=m.beginPath,m._removeMirroring=()=>{m.save=m.__originalSave,m.restore=m.__originalRestore,m.rotate=m.__originalRotate,m.scale=m.__originalScale,m.translate=m.__originalTranslate,m.transform=m.__originalTransform,m.setTransform=m.__originalSetTransform,m.resetTransform=m.__originalResetTransform,m.clip=m.__originalClip,m.moveTo=m.__originalMoveTo,m.lineTo=m.__originalLineTo,m.bezierCurveTo=m.__originalBezierCurveTo,m.rect=m.__originalRect,m.closePath=m.__originalClosePath,m.beginPath=m.__originalBeginPath,delete m._removeMirroring},m.save=function(){l.save(),this.__originalSave()},m.restore=function(){l.restore(),this.__originalRestore()},m.translate=function(b,P){l.translate(b,P),this.__originalTranslate(b,P)},m.scale=function(b,P){l.scale(b,P),this.__originalScale(b,P)},m.transform=function(b,P,T,D,k,s){l.transform(b,P,T,D,k,s),this.__originalTransform(b,P,T,D,k,s)},m.setTransform=function(b,P,T,D,k,s){l.setTransform(b,P,T,D,k,s),this.__originalSetTransform(b,P,T,D,k,s)},m.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},m.rotate=function(b){l.rotate(b),this.__originalRotate(b)},m.clip=function(b){l.clip(b),this.__originalClip(b)},m.moveTo=function(c,b){l.moveTo(c,b),this.__originalMoveTo(c,b)},m.lineTo=function(c,b){l.lineTo(c,b),this.__originalLineTo(c,b)},m.bezierCurveTo=function(c,b,P,T,D,k){l.bezierCurveTo(c,b,P,T,D,k),this.__originalBezierCurveTo(c,b,P,T,D,k)},m.rect=function(c,b,P,T){l.rect(c,b,P,T),this.__originalRect(c,b,P,T)},m.closePath=function(){l.closePath(),this.__originalClosePath()},m.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class f{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,c,b){let P;return this.cache[l]!==void 0?(P=this.cache[l],this.canvasFactory.reset(P,c,b)):(P=this.canvasFactory.create(c,b),this.cache[l]=P),P}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const c=this.cache[l];this.canvasFactory.destroy(c),delete this.cache[l]}}}function u(m,l,c,b,P,T,D,k,s,p){const[y,E,C,j,B,V]=(0,_.getCurrentTransform)(m);if(E===0&&C===0){const Y=D*y+B,J=Math.round(Y),$=k*j+V,et=Math.round($),rt=(D+s)*y+B,ot=Math.abs(Math.round(rt)-J)||1,lt=(k+p)*j+V,ct=Math.abs(Math.round(lt)-et)||1;return m.setTransform(Math.sign(y),0,0,Math.sign(j),J,et),m.drawImage(l,c,b,P,T,0,0,ot,ct),m.setTransform(y,E,C,j,B,V),[ot,ct]}if(y===0&&j===0){const Y=k*C+B,J=Math.round(Y),$=D*E+V,et=Math.round($),rt=(k+p)*C+B,ot=Math.abs(Math.round(rt)-J)||1,lt=(D+s)*E+V,ct=Math.abs(Math.round(lt)-et)||1;return m.setTransform(0,Math.sign(E),Math.sign(C),0,J,et),m.drawImage(l,c,b,P,T,0,0,ct,ot),m.setTransform(y,E,C,j,B,V),[ct,ot]}m.drawImage(l,c,b,P,T,D,k,s,p);const nt=Math.hypot(y,E),q=Math.hypot(C,j);return[nt*s,q*p]}function h(m){const{width:l,height:c}=m;if(l>r||c>r)return null;const b=1e3,P=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),T=l+1;let D=new Uint8Array(T*(c+1)),k,s,p;const y=l+7&-8;let E=new Uint8Array(y*c),C=0;for(const q of m.data){let Y=128;for(;Y>0;)E[C++]=q&Y?0:255,Y>>=1}let j=0;for(C=0,E[C]!==0&&(D[0]=1,++j),s=1;s<l;s++)E[C]!==E[C+1]&&(D[s]=E[C]?2:1,++j),C++;for(E[C]!==0&&(D[s]=2,++j),k=1;k<c;k++){C=k*y,p=k*T,E[C-y]!==E[C]&&(D[p]=E[C]?1:8,++j);let q=(E[C]?4:0)+(E[C-y]?8:0);for(s=1;s<l;s++)q=(q>>2)+(E[C+1]?4:0)+(E[C-y+1]?8:0),P[q]&&(D[p+s]=P[q],++j),C++;if(E[C-y]!==E[C]&&(D[p+s]=E[C]?2:4,++j),j>b)return null}for(C=y*(c-1),p=k*T,E[C]!==0&&(D[p]=8,++j),s=1;s<l;s++)E[C]!==E[C+1]&&(D[p+s]=E[C]?4:8,++j),C++;if(E[C]!==0&&(D[p+s]=4,++j),j>b)return null;const B=new Int32Array([0,T,-1,0,-T,0,0,0,1]),V=new Path2D;for(k=0;j&&k<=c;k++){let q=k*T;const Y=q+l;for(;q<Y&&!D[q];)q++;if(q===Y)continue;V.moveTo(q%T,k);const J=q;let $=D[q];do{const et=B[$];do q+=et;while(!D[q]);const rt=D[q];rt!==5&&rt!==10?($=rt,D[q]=0):($=rt&51*$>>4,D[q]&=$>>2|$<<2),V.lineTo(q%T,q/T|0),D[q]||--j}while(J!==q);--k}return E=null,D=null,function(q){q.save(),q.scale(1/l,-1/c),q.translate(0,-c),q.fill(V),q.beginPath(),q.restore()}}class v{constructor(l,c){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,c])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,c){this.x=l,this.y=c}updatePathMinMax(l,c,b){[c,b]=a.Util.applyTransform([c,b],l),this.minX=Math.min(this.minX,c),this.minY=Math.min(this.minY,b),this.maxX=Math.max(this.maxX,c),this.maxY=Math.max(this.maxY,b)}updateRectMinMax(l,c){const b=a.Util.applyTransform(c,l),P=a.Util.applyTransform(c.slice(2),l);this.minX=Math.min(this.minX,b[0],P[0]),this.minY=Math.min(this.minY,b[1],P[1]),this.maxX=Math.max(this.maxX,b[0],P[0]),this.maxY=Math.max(this.maxY,b[1],P[1])}updateScalingPathMinMax(l,c){a.Util.scaleMinMax(l,c),this.minX=Math.min(this.minX,c[0]),this.maxX=Math.max(this.maxX,c[1]),this.minY=Math.min(this.minY,c[2]),this.maxY=Math.max(this.maxY,c[3])}updateCurvePathMinMax(l,c,b,P,T,D,k,s,p,y){const E=a.Util.bezierBoundingBox(c,b,P,T,D,k,s,p);if(y){y[0]=Math.min(y[0],E[0],E[2]),y[1]=Math.max(y[1],E[0],E[2]),y[2]=Math.min(y[2],E[1],E[3]),y[3]=Math.max(y[3],E[1],E[3]);return}this.updateRectMinMax(l,E)}getPathBoundingBox(l=F.PathType.FILL,c=null){const b=[this.minX,this.minY,this.maxX,this.maxY];if(l===F.PathType.STROKE){c||(0,a.unreachable)("Stroke bounding box must include transform.");const P=a.Util.singularValueDecompose2dScale(c),T=P[0]*this.lineWidth/2,D=P[1]*this.lineWidth/2;b[0]-=T,b[1]-=D,b[2]+=T,b[3]+=D}return b}updateClipFromPath(){const l=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=F.PathType.FILL,c=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(l,c))}}function I(m,l){if(typeof ImageData<"u"&&l instanceof ImageData){m.putImageData(l,0,0);return}const c=l.height,b=l.width,P=c%o,T=(c-P)/o,D=P===0?T:T+1,k=m.createImageData(b,o);let s=0,p;const y=l.data,E=k.data;let C,j,B,V;if(l.kind===a.ImageKind.GRAYSCALE_1BPP){const nt=y.byteLength,q=new Uint32Array(E.buffer,0,E.byteLength>>2),Y=q.length,J=b+7>>3,$=4294967295,et=a.FeatureTest.isLittleEndian?4278190080:255;for(C=0;C<D;C++){for(B=C<T?o:P,p=0,j=0;j<B;j++){const rt=nt-s;let ot=0;const lt=rt>J?b:rt*8-7,ct=lt&-8;let ht=0,ut=0;for(;ot<ct;ot+=8)ut=y[s++],q[p++]=ut&128?$:et,q[p++]=ut&64?$:et,q[p++]=ut&32?$:et,q[p++]=ut&16?$:et,q[p++]=ut&8?$:et,q[p++]=ut&4?$:et,q[p++]=ut&2?$:et,q[p++]=ut&1?$:et;for(;ot<lt;ot++)ht===0&&(ut=y[s++],ht=128),q[p++]=ut&ht?$:et,ht>>=1}for(;p<Y;)q[p++]=0;m.putImageData(k,0,C*o)}}else if(l.kind===a.ImageKind.RGBA_32BPP){for(j=0,V=b*o*4,C=0;C<T;C++)E.set(y.subarray(s,s+V)),s+=V,m.putImageData(k,0,j),j+=o;C<D&&(V=b*P*4,E.set(y.subarray(s,s+V)),m.putImageData(k,0,j))}else if(l.kind===a.ImageKind.RGB_24BPP)for(B=o,V=b*B,C=0;C<D;C++){for(C>=T&&(B=P,V=b*B),p=0,j=V;j--;)E[p++]=y[s++],E[p++]=y[s++],E[p++]=y[s++],E[p++]=255;m.putImageData(k,0,C*o)}else throw new Error(`bad image kind: ${l.kind}`)}function x(m,l){if(l.bitmap){m.drawImage(l.bitmap,0,0);return}const c=l.height,b=l.width,P=c%o,T=(c-P)/o,D=P===0?T:T+1,k=m.createImageData(b,o);let s=0;const p=l.data,y=k.data;for(let E=0;E<D;E++){const C=E<T?o:P;({srcPos:s}=(0,O.convertBlackAndWhiteToRGBA)({src:p,srcPos:s,dest:y,width:b,height:C,nonBlackColor:0})),m.putImageData(k,0,E*o)}}function g(m,l){const c=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const b of c)m[b]!==void 0&&(l[b]=m[b]);m.setLineDash!==void 0&&(l.setLineDash(m.getLineDash()),l.lineDashOffset=m.lineDashOffset)}function A(m){if(m.strokeStyle=m.fillStyle="#000000",m.fillRule="nonzero",m.globalAlpha=1,m.lineWidth=1,m.lineCap="butt",m.lineJoin="miter",m.miterLimit=10,m.globalCompositeOperation="source-over",m.font="10px sans-serif",m.setLineDash!==void 0&&(m.setLineDash([]),m.lineDashOffset=0),!a.isNodeJS){const{filter:l}=m;l!=="none"&&l!==""&&(m.filter="none")}}function M(m,l,c,b){const P=m.length;for(let T=3;T<P;T+=4){const D=m[T];if(D===0)m[T-3]=l,m[T-2]=c,m[T-1]=b;else if(D<255){const k=255-D;m[T-3]=m[T-3]*D+l*k>>8,m[T-2]=m[T-2]*D+c*k>>8,m[T-1]=m[T-1]*D+b*k>>8}}}function H(m,l,c){const b=m.length,P=1/255;for(let T=3;T<b;T+=4){const D=c?c[m[T]]:m[T];l[T]=l[T]*D*P|0}}function N(m,l,c){const b=m.length;for(let P=3;P<b;P+=4){const T=m[P-3]*77+m[P-2]*152+m[P-1]*28;l[P]=c?l[P]*c[T>>8]>>8:l[P]*T>>16}}function W(m,l,c,b,P,T,D,k,s,p,y){const E=!!T,C=E?T[0]:0,j=E?T[1]:0,B=E?T[2]:0,V=P==="Luminosity"?N:H,q=Math.min(b,Math.ceil(1048576/c));for(let Y=0;Y<b;Y+=q){const J=Math.min(q,b-Y),$=m.getImageData(k-p,Y+(s-y),c,J),et=l.getImageData(k,Y+s,c,J);E&&M($.data,C,j,B),V($.data,et.data,D),l.putImageData(et,k,Y+s)}}function G(m,l,c,b){const P=b[0],T=b[1],D=b[2]-P,k=b[3]-T;D===0||k===0||(W(l.context,c,D,k,l.subtype,l.backdrop,l.transferMap,P,T,l.offsetX,l.offsetY),m.save(),m.globalAlpha=1,m.globalCompositeOperation="source-over",m.setTransform(1,0,0,1,0,0),m.drawImage(c.canvas,0,0),m.restore())}function Z(m,l){const c=a.Util.singularValueDecompose2dScale(m);c[0]=Math.fround(c[0]),c[1]=Math.fround(c[1]);const b=Math.fround((globalThis.devicePixelRatio||1)*_.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:c[0]<=b||c[1]<=b}const Q=["butt","round","square"],tt=["miter","round","bevel"],st={},K={};class R{constructor(l,c,b,P,T,{optionalContentConfig:D,markedContentStack:k=null},s,p){this.ctx=l,this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=c,this.objs=b,this.canvasFactory=P,this.filterFactory=T,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=k||[],this.optionalContentConfig=D,this.cachedCanvases=new f(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=s,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=p,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,c=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):c}beginDrawing({transform:l,viewport:c,transparency:b=!1,background:P=null}){const T=this.ctx.canvas.width,D=this.ctx.canvas.height,k=this.ctx.fillStyle;if(this.ctx.fillStyle=P||"#ffffff",this.ctx.fillRect(0,0,T,D),this.ctx.fillStyle=k,b){const s=this.cachedCanvases.getCanvas("transparent",T,D);this.compositeCtx=this.ctx,this.transparentCanvas=s.canvas,this.ctx=s.context,this.ctx.save(),this.ctx.transform(...(0,_.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),A(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...c.transform),this.viewportScale=c.scale,this.baseTransform=(0,_.getCurrentTransform)(this.ctx)}executeOperatorList(l,c,b,P){const T=l.argsArray,D=l.fnArray;let k=c||0;const s=T.length;if(s===k)return k;const p=s-k>d&&typeof b=="function",y=p?Date.now()+i:0;let E=0;const C=this.commonObjs,j=this.objs;let B;for(;;){if(P!==void 0&&k===P.nextBreakPoint)return P.breakIt(k,b),k;if(B=D[k],B!==a.OPS.dependency)this[B].apply(this,T[k]);else for(const V of T[k]){const nt=V.startsWith("g_")?C:j;if(!nt.has(V))return nt.get(V,b),k}if(k++,k===s)return k;if(p&&++E>d){if(Date.now()>y)return b(),k;E=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const c of l.values())typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement&&(c.width=c.height=0);l.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const l=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(l!=="none"){const c=this.ctx.filter;this.ctx.filter=l,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=c}}}_scaleImage(l,c){const b=l.width,P=l.height;let T=Math.max(Math.hypot(c[0],c[1]),1),D=Math.max(Math.hypot(c[2],c[3]),1),k=b,s=P,p="prescale1",y,E;for(;T>2&&k>1||D>2&&s>1;){let C=k,j=s;T>2&&k>1&&(C=k>=16384?Math.floor(k/2)-1||1:Math.ceil(k/2),T/=k/C),D>2&&s>1&&(j=s>=16384?Math.floor(s/2)-1||1:Math.ceil(s)/2,D/=s/j),y=this.cachedCanvases.getCanvas(p,C,j),E=y.context,E.clearRect(0,0,C,j),E.drawImage(l,0,0,k,s,0,0,C,j),l=y.canvas,k=C,s=j,p=p==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:k,paintHeight:s}}_createMaskCanvas(l){const c=this.ctx,{width:b,height:P}=l,T=this.current.fillColor,D=this.current.patternFill,k=(0,_.getCurrentTransform)(c);let s,p,y,E;if((l.bitmap||l.data)&&l.count>1){const ot=l.bitmap||l.data.buffer;p=JSON.stringify(D?k:[k.slice(0,4),T]),s=this._cachedBitmapsMap.get(ot),s||(s=new Map,this._cachedBitmapsMap.set(ot,s));const lt=s.get(p);if(lt&&!D){const ct=Math.round(Math.min(k[0],k[2])+k[4]),ht=Math.round(Math.min(k[1],k[3])+k[5]);return{canvas:lt,offsetX:ct,offsetY:ht}}y=lt}y||(E=this.cachedCanvases.getCanvas("maskCanvas",b,P),x(E.context,l));let C=a.Util.transform(k,[1/b,0,0,-1/P,0,0]);C=a.Util.transform(C,[1,0,0,1,0,-P]);const j=a.Util.applyTransform([0,0],C),B=a.Util.applyTransform([b,P],C),V=a.Util.normalizeRect([j[0],j[1],B[0],B[1]]),nt=Math.round(V[2]-V[0])||1,q=Math.round(V[3]-V[1])||1,Y=this.cachedCanvases.getCanvas("fillCanvas",nt,q),J=Y.context,$=Math.min(j[0],B[0]),et=Math.min(j[1],B[1]);J.translate(-$,-et),J.transform(...C),y||(y=this._scaleImage(E.canvas,(0,_.getCurrentTransformInverse)(J)),y=y.img,s&&D&&s.set(p,y)),J.imageSmoothingEnabled=Z((0,_.getCurrentTransform)(J),l.interpolate),u(J,y,0,0,y.width,y.height,0,0,b,P),J.globalCompositeOperation="source-in";const rt=a.Util.transform((0,_.getCurrentTransformInverse)(J),[1,0,0,1,-$,-et]);return J.fillStyle=D?T.getPattern(c,this,rt,F.PathType.FILL):T,J.fillRect(0,0,b,P),s&&!D&&(this.cachedCanvases.delete("fillCanvas"),s.set(p,Y.canvas)),{canvas:Y.canvas,offsetX:Math.round($),offsetY:Math.round(et)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=Q[l]}setLineJoin(l){this.ctx.lineJoin=tt[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,c){const b=this.ctx;b.setLineDash!==void 0&&(b.setLineDash(l),b.lineDashOffset=c)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[c,b]of l)switch(c){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b[0],b[1]);break;case"CA":this.current.strokeAlpha=b;break;case"ca":this.current.fillAlpha=b,this.ctx.globalAlpha=b;break;case"BM":this.ctx.globalCompositeOperation=b;break;case"SMask":this.current.activeSMask=b?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(b);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,c=this.ctx.canvas.height,b="smaskGroupAt"+this.groupLevel,P=this.cachedCanvases.getCanvas(b,l,c);this.suspendedCtx=this.ctx,this.ctx=P.context;const T=this.ctx;T.setTransform(...(0,_.getCurrentTransform)(this.suspendedCtx)),g(this.suspendedCtx,T),e(T,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),g(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const c=this.current.activeSMask,b=this.suspendedCtx;G(b,c,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(g(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),g(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(l,c,b,P,T,D){this.ctx.transform(l,c,b,P,T,D),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(l,c,b){const P=this.ctx,T=this.current;let D=T.x,k=T.y,s,p;const y=(0,_.getCurrentTransform)(P),E=y[0]===0&&y[3]===0||y[1]===0&&y[2]===0,C=E?b.slice(0):null;for(let j=0,B=0,V=l.length;j<V;j++)switch(l[j]|0){case a.OPS.rectangle:D=c[B++],k=c[B++];const nt=c[B++],q=c[B++],Y=D+nt,J=k+q;P.moveTo(D,k),nt===0||q===0?P.lineTo(Y,J):(P.lineTo(Y,k),P.lineTo(Y,J),P.lineTo(D,J)),E||T.updateRectMinMax(y,[D,k,Y,J]),P.closePath();break;case a.OPS.moveTo:D=c[B++],k=c[B++],P.moveTo(D,k),E||T.updatePathMinMax(y,D,k);break;case a.OPS.lineTo:D=c[B++],k=c[B++],P.lineTo(D,k),E||T.updatePathMinMax(y,D,k);break;case a.OPS.curveTo:s=D,p=k,D=c[B+4],k=c[B+5],P.bezierCurveTo(c[B],c[B+1],c[B+2],c[B+3],D,k),T.updateCurvePathMinMax(y,s,p,c[B],c[B+1],c[B+2],c[B+3],D,k,C),B+=6;break;case a.OPS.curveTo2:s=D,p=k,P.bezierCurveTo(D,k,c[B],c[B+1],c[B+2],c[B+3]),T.updateCurvePathMinMax(y,s,p,D,k,c[B],c[B+1],c[B+2],c[B+3],C),D=c[B+2],k=c[B+3],B+=4;break;case a.OPS.curveTo3:s=D,p=k,D=c[B+2],k=c[B+3],P.bezierCurveTo(c[B],c[B+1],D,k,D,k),T.updateCurvePathMinMax(y,s,p,c[B],c[B+1],D,k,D,k,C),B+=4;break;case a.OPS.closePath:P.closePath();break}E&&T.updateScalingPathMinMax(y,C),T.setCurrentPoint(D,k)}closePath(){this.ctx.closePath()}stroke(l=!0){const c=this.ctx,b=this.current.strokeColor;c.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof b=="object"&&b?.getPattern?(c.save(),c.strokeStyle=b.getPattern(c,this,(0,_.getCurrentTransformInverse)(c),F.PathType.STROKE),this.rescaleAndStroke(!1),c.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),c.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const c=this.ctx,b=this.current.fillColor,P=this.current.patternFill;let T=!1;P&&(c.save(),c.fillStyle=b.getPattern(c,this,(0,_.getCurrentTransformInverse)(c),F.PathType.FILL),T=!0);const D=this.current.getClippedPathBoundingBox();this.contentVisible&&D!==null&&(this.pendingEOFill?(c.fill("evenodd"),this.pendingEOFill=!1):c.fill()),T&&c.restore(),l&&this.consumePath(D)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=st}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,c=this.ctx;if(l===void 0){c.beginPath();return}c.save(),c.beginPath();for(const b of l)c.setTransform(...b.transform),c.translate(b.x,b.y),b.addToPath(c,b.fontSize);c.restore(),c.clip(),c.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,c){const b=this.commonObjs.get(l),P=this.current;if(!b)throw new Error(`Can't find font for ${l}`);if(P.fontMatrix=b.fontMatrix||a.FONT_IDENTITY_MATRIX,(P.fontMatrix[0]===0||P.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+l),c<0?(c=-c,P.fontDirection=-1):P.fontDirection=1,this.current.font=b,this.current.fontSize=c,b.isType3Font)return;const T=b.loadedName||"sans-serif",D=b.systemFontInfo?.css||`"${T}", ${b.fallbackName}`;let k="normal";b.black?k="900":b.bold&&(k="bold");const s=b.italic?"italic":"normal";let p=c;c<L?p=L:c>S&&(p=S),this.current.fontSizeScale=c/p,this.ctx.font=`${s} ${k} ${p}px ${D}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,c){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=c}setLeadingMoveText(l,c){this.setLeading(-c),this.moveText(l,c)}setTextMatrix(l,c,b,P,T,D){this.current.textMatrix=[l,c,b,P,T,D],this.current.textMatrixScale=Math.hypot(l,c),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,c,b,P){const T=this.ctx,D=this.current,k=D.font,s=D.textRenderingMode,p=D.fontSize/D.fontSizeScale,y=s&a.TextRenderingMode.FILL_STROKE_MASK,E=!!(s&a.TextRenderingMode.ADD_TO_PATH_FLAG),C=D.patternFill&&!k.missingFile;let j;(k.disableFontFace||E||C)&&(j=k.getPathGenerator(this.commonObjs,l)),k.disableFontFace||C?(T.save(),T.translate(c,b),T.beginPath(),j(T,p),P&&T.setTransform(...P),(y===a.TextRenderingMode.FILL||y===a.TextRenderingMode.FILL_STROKE)&&T.fill(),(y===a.TextRenderingMode.STROKE||y===a.TextRenderingMode.FILL_STROKE)&&T.stroke(),T.restore()):((y===a.TextRenderingMode.FILL||y===a.TextRenderingMode.FILL_STROKE)&&T.fillText(l,c,b),(y===a.TextRenderingMode.STROKE||y===a.TextRenderingMode.FILL_STROKE)&&T.strokeText(l,c,b)),E&&(this.pendingTextPaths||=[]).push({transform:(0,_.getCurrentTransform)(T),x:c,y:b,fontSize:p,addToPath:j})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const c=l.getImageData(0,0,10,10).data;let b=!1;for(let P=3;P<c.length;P+=4)if(c[P]>0&&c[P]<255){b=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",b)}showText(l){const c=this.current,b=c.font;if(b.isType3Font)return this.showType3Text(l);const P=c.fontSize;if(P===0)return;const T=this.ctx,D=c.fontSizeScale,k=c.charSpacing,s=c.wordSpacing,p=c.fontDirection,y=c.textHScale*p,E=l.length,C=b.vertical,j=C?1:-1,B=b.defaultVMetrics,V=P*c.fontMatrix[0],nt=c.textRenderingMode===a.TextRenderingMode.FILL&&!b.disableFontFace&&!c.patternFill;T.save(),T.transform(...c.textMatrix),T.translate(c.x,c.y+c.textRise),p>0?T.scale(y,-1):T.scale(y,1);let q;if(c.patternFill){T.save();const rt=c.fillColor.getPattern(T,this,(0,_.getCurrentTransformInverse)(T),F.PathType.FILL);q=(0,_.getCurrentTransform)(T),T.restore(),T.fillStyle=rt}let Y=c.lineWidth;const J=c.textMatrixScale;if(J===0||Y===0){const rt=c.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(rt===a.TextRenderingMode.STROKE||rt===a.TextRenderingMode.FILL_STROKE)&&(Y=this.getSinglePixelWidth())}else Y/=J;if(D!==1&&(T.scale(D,D),Y/=D),T.lineWidth=Y,b.isInvalidPDFjsFont){const rt=[];let ot=0;for(const lt of l)rt.push(lt.unicode),ot+=lt.width;T.fillText(rt.join(""),0,0),c.x+=ot*V*y,T.restore(),this.compose();return}let $=0,et;for(et=0;et<E;++et){const rt=l[et];if(typeof rt=="number"){$+=j*rt*P/1e3;continue}let ot=!1;const lt=(rt.isSpace?s:0)+k,ct=rt.fontChar,ht=rt.accent;let ut,At,mt=rt.width;if(C){const bt=rt.vmetric||B,vt=-(rt.vmetric?bt[1]:mt*.5)*V,It=bt[2]*V;mt=bt?-bt[0]:mt,ut=vt/D,At=($+It)/D}else ut=$/D,At=0;if(b.remeasure&&mt>0){const bt=T.measureText(ct).width*1e3/P*D;if(mt<bt&&this.isFontSubpixelAAEnabled){const vt=mt/bt;ot=!0,T.save(),T.scale(vt,1),ut/=vt}else mt!==bt&&(ut+=(mt-bt)/2e3*P/D)}if(this.contentVisible&&(rt.isInFont||b.missingFile)){if(nt&&!ht)T.fillText(ct,ut,At);else if(this.paintChar(ct,ut,At,q),ht){const bt=ut+P*ht.offset.x/D,vt=At-P*ht.offset.y/D;this.paintChar(ht.fontChar,bt,vt,q)}}const Ct=C?mt*V-lt*p:mt*V+lt*p;$+=Ct,ot&&T.restore()}C?c.y-=$:c.x+=$*y,T.restore(),this.compose()}showType3Text(l){const c=this.ctx,b=this.current,P=b.font,T=b.fontSize,D=b.fontDirection,k=P.vertical?1:-1,s=b.charSpacing,p=b.wordSpacing,y=b.textHScale*D,E=b.fontMatrix||a.FONT_IDENTITY_MATRIX,C=l.length,j=b.textRenderingMode===a.TextRenderingMode.INVISIBLE;let B,V,nt,q;if(!(j||T===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,c.save(),c.transform(...b.textMatrix),c.translate(b.x,b.y),c.scale(y,D),B=0;B<C;++B){if(V=l[B],typeof V=="number"){q=k*V*T/1e3,this.ctx.translate(q,0),b.x+=q*y;continue}const Y=(V.isSpace?p:0)+s,J=P.charProcOperatorList[V.operatorListId];if(!J){(0,a.warn)(`Type3 character "${V.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=V,this.save(),c.scale(T,T),c.transform(...E),this.executeOperatorList(J),this.restore()),nt=a.Util.applyTransform([V.width,0],E)[0]*T+Y,c.translate(nt,0),b.x+=nt*y}c.restore(),this.processingType3=null}}setCharWidth(l,c){}setCharWidthAndBounds(l,c,b,P,T,D){this.ctx.rect(b,P,T-b,D-P),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let c;if(l[0]==="TilingPattern"){const b=l[1],P=this.baseTransform||(0,_.getCurrentTransform)(this.ctx),T={createCanvasGraphics:D=>new R(D,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};c=new F.TilingPattern(l,b,this.ctx,T,P)}else c=this._getPattern(l[1],l[2]);return c}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,c,b){const P=a.Util.makeHexColor(l,c,b);this.ctx.strokeStyle=P,this.current.strokeColor=P}setFillRGBColor(l,c,b){const P=a.Util.makeHexColor(l,c,b);this.ctx.fillStyle=P,this.current.fillColor=P,this.current.patternFill=!1}_getPattern(l,c=null){let b;return this.cachedPatterns.has(l)?b=this.cachedPatterns.get(l):(b=(0,F.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,b)),c&&(b.matrix=c),b}shadingFill(l){if(!this.contentVisible)return;const c=this.ctx;this.save();const b=this._getPattern(l);c.fillStyle=b.getPattern(c,this,(0,_.getCurrentTransformInverse)(c),F.PathType.SHADING);const P=(0,_.getCurrentTransformInverse)(c);if(P){const{width:T,height:D}=c.canvas,[k,s,p,y]=a.Util.getAxialAlignedBoundingBox([0,0,T,D],P);this.ctx.fillRect(k,s,p-k,y-s)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,c){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,_.getCurrentTransform)(this.ctx),c)){const b=c[2]-c[0],P=c[3]-c[1];this.ctx.rect(c[0],c[1],b,P),this.current.updateRectMinMax((0,_.getCurrentTransform)(this.ctx),c),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const c=this.ctx;l.isolated||(0,a.info)("TODO: Support non-isolated groups."),l.knockout&&(0,a.warn)("Knockout groups not supported.");const b=(0,_.getCurrentTransform)(c);if(l.matrix&&c.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let P=a.Util.getAxialAlignedBoundingBox(l.bbox,(0,_.getCurrentTransform)(c));const T=[0,0,c.canvas.width,c.canvas.height];P=a.Util.intersect(P,T)||[0,0,0,0];const D=Math.floor(P[0]),k=Math.floor(P[1]);let s=Math.max(Math.ceil(P[2])-D,1),p=Math.max(Math.ceil(P[3])-k,1),y=1,E=1;s>t&&(y=s/t,s=t),p>t&&(E=p/t,p=t),this.current.startNewPathAndClipBox([0,0,s,p]);let C="groupAt"+this.groupLevel;l.smask&&(C+="_smask_"+this.smaskCounter++%2);const j=this.cachedCanvases.getCanvas(C,s,p),B=j.context;B.scale(1/y,1/E),B.translate(-D,-k),B.transform(...b),l.smask?this.smaskStack.push({canvas:j.canvas,context:B,offsetX:D,offsetY:k,scaleX:y,scaleY:E,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(c.setTransform(1,0,0,1,0,0),c.translate(D,k),c.scale(y,E),c.save()),g(c,B),this.ctx=B,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const c=this.ctx,b=this.groupStack.pop();if(this.ctx=b,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const P=(0,_.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...P);const T=a.Util.getAxialAlignedBoundingBox([0,0,c.canvas.width,c.canvas.height],P);this.ctx.drawImage(c.canvas,0,0),this.ctx.restore(),this.compose(T)}}beginAnnotation(l,c,b,P,T){if(this.#t(),A(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(c)&&c.length===4){const D=c[2]-c[0],k=c[3]-c[1];if(T&&this.annotationCanvasMap){b=b.slice(),b[4]-=c[0],b[5]-=c[1],c=c.slice(),c[0]=c[1]=0,c[2]=D,c[3]=k;const[s,p]=a.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(this.ctx)),{viewportScale:y}=this,E=Math.ceil(D*this.outputScaleX*y),C=Math.ceil(k*this.outputScaleY*y);this.annotationCanvas=this.canvasFactory.create(E,C);const{canvas:j,context:B}=this.annotationCanvas;this.annotationCanvasMap.set(l,j),this.annotationCanvas.savedCtx=this.ctx,this.ctx=B,this.ctx.save(),this.ctx.setTransform(s,0,0,-p,0,k*p),A(this.ctx)}else A(this.ctx),this.ctx.rect(c[0],c[1],D,k),this.ctx.clip(),this.endPath()}this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...b),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const c=l.count;l=this.getObject(l.data,l),l.count=c;const b=this.ctx,P=this.processingType3;if(P&&(P.compiled===void 0&&(P.compiled=h(l)),P.compiled)){P.compiled(b);return}const T=this._createMaskCanvas(l),D=T.canvas;b.save(),b.setTransform(1,0,0,1,0,0),b.drawImage(D,T.offsetX,T.offsetY),b.restore(),this.compose()}paintImageMaskXObjectRepeat(l,c,b=0,P=0,T,D){if(!this.contentVisible)return;l=this.getObject(l.data,l);const k=this.ctx;k.save();const s=(0,_.getCurrentTransform)(k);k.transform(c,b,P,T,0,0);const p=this._createMaskCanvas(l);k.setTransform(1,0,0,1,p.offsetX-s[4],p.offsetY-s[5]);for(let y=0,E=D.length;y<E;y+=2){const C=a.Util.transform(s,[c,b,P,T,D[y],D[y+1]]),[j,B]=a.Util.applyTransform([0,0],C);k.drawImage(p.canvas,j,B)}k.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const c=this.ctx,b=this.current.fillColor,P=this.current.patternFill;for(const T of l){const{data:D,width:k,height:s,transform:p}=T,y=this.cachedCanvases.getCanvas("maskCanvas",k,s),E=y.context;E.save();const C=this.getObject(D,T);x(E,C),E.globalCompositeOperation="source-in",E.fillStyle=P?b.getPattern(E,this,(0,_.getCurrentTransformInverse)(c),F.PathType.FILL):b,E.fillRect(0,0,k,s),E.restore(),c.save(),c.transform(...p),c.scale(1,-1),u(c,y.canvas,0,0,k,s,0,-1,1,1),c.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const c=this.getObject(l);if(!c){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(c)}paintImageXObjectRepeat(l,c,b,P){if(!this.contentVisible)return;const T=this.getObject(l);if(!T){(0,a.warn)("Dependent image isn't ready yet");return}const D=T.width,k=T.height,s=[];for(let p=0,y=P.length;p<y;p+=2)s.push({transform:[c,0,0,b,P[p],P[p+1]],x:0,y:0,w:D,h:k});this.paintInlineImageXObjectGroup(T,s)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:c,width:b,height:P}=l,T=this.cachedCanvases.getCanvas("inlineImage",b,P),D=T.context;return D.filter=this.current.transferMaps,D.drawImage(c,0,0),D.filter="none",T.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const c=l.width,b=l.height,P=this.ctx;if(this.save(),!a.isNodeJS){const{filter:k}=P;k!=="none"&&k!==""&&(P.filter="none")}P.scale(1/c,-1/b);let T;if(l.bitmap)T=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)T=l;else{const s=this.cachedCanvases.getCanvas("inlineImage",c,b).context;I(s,l),T=this.applyTransferMapsToCanvas(s)}const D=this._scaleImage(T,(0,_.getCurrentTransformInverse)(P));P.imageSmoothingEnabled=Z((0,_.getCurrentTransform)(P),l.interpolate),u(P,D.img,0,0,D.paintWidth,D.paintHeight,0,-b,c,b),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,c){if(!this.contentVisible)return;const b=this.ctx;let P;if(l.bitmap)P=l.bitmap;else{const T=l.width,D=l.height,s=this.cachedCanvases.getCanvas("inlineImage",T,D).context;I(s,l),P=this.applyTransferMapsToCanvas(s)}for(const T of c)b.save(),b.transform(...T.transform),b.scale(1,-1),u(b,P,T.x,T.y,T.w,T.h,0,-1,1,1),b.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,c){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,c){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(c)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const c=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const b=this.ctx;this.pendingClip&&(c||(this.pendingClip===K?b.clip("evenodd"):b.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),b.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,_.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const c=Math.abs(l[0]*l[3]-l[2]*l[1]),b=Math.hypot(l[0],l[2]),P=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(b,P)/c}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:l}=this.current,{a:c,b,c:P,d:T}=this.ctx.getTransform();let D,k;if(b===0&&P===0){const s=Math.abs(c),p=Math.abs(T);if(s===p)if(l===0)D=k=1/s;else{const y=s*l;D=k=y<1?1/y:1}else if(l===0)D=1/s,k=1/p;else{const y=s*l,E=p*l;D=y<1?1/y:1,k=E<1?1/E:1}}else{const s=Math.abs(c*T-b*P),p=Math.hypot(c,b),y=Math.hypot(P,T);if(l===0)D=y/s,k=p/s;else{const E=l*s;D=y>E?y/E:1,k=p>E?p/E:1}}this._cachedScaleForStroking[0]=D,this._cachedScaleForStroking[1]=k}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:c}=this,{lineWidth:b}=this.current,[P,T]=this.getScaleForStroking();if(c.lineWidth=b||1,P===1&&T===1){c.stroke();return}const D=c.getLineDash();if(l&&c.save(),c.scale(P,T),D.length>0){const k=Math.max(P,T);c.setLineDash(D.map(s=>s/k)),c.lineDashOffset/=k}c.stroke(),l&&c.restore()}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}}n.CanvasGraphics=R;for(const m in a.OPS)R.prototype[m]!==void 0&&(R.prototype[a.OPS[m]]=R.prototype[m])}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=o;var a=w(1),_=w(6);const F={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=F;function O(u,h){if(!h)return;const v=h[2]-h[0],I=h[3]-h[1],x=new Path2D;x.rect(h[0],h[1],v,I),u.clip(x)}class L{constructor(){this.constructor===L&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class S extends L{constructor(h){super(),this._type=h[1],this._bbox=h[2],this._colorStops=h[3],this._p0=h[4],this._p1=h[5],this._r0=h[6],this._r1=h[7],this.matrix=null}_createGradient(h){let v;this._type==="axial"?v=h.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(v=h.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const I of this._colorStops)v.addColorStop(I[0],I[1]);return v}getPattern(h,v,I,x){let g;if(x===F.STROKE||x===F.FILL){const A=v.current.getClippedPathBoundingBox(x,(0,_.getCurrentTransform)(h))||[0,0,0,0],M=Math.ceil(A[2]-A[0])||1,H=Math.ceil(A[3]-A[1])||1,N=v.cachedCanvases.getCanvas("pattern",M,H,!0),W=N.context;W.clearRect(0,0,W.canvas.width,W.canvas.height),W.beginPath(),W.rect(0,0,W.canvas.width,W.canvas.height),W.translate(-A[0],-A[1]),I=a.Util.transform(I,[1,0,0,1,A[0],A[1]]),W.transform(...v.baseTransform),this.matrix&&W.transform(...this.matrix),O(W,this._bbox),W.fillStyle=this._createGradient(W),W.fill(),g=h.createPattern(N.canvas,"no-repeat");const G=new DOMMatrix(I);g.setTransform(G)}else O(h,this._bbox),g=this._createGradient(h);return g}}function t(u,h,v,I,x,g,A,M){const H=h.coords,N=h.colors,W=u.data,G=u.width*4;let Z;H[v+1]>H[I+1]&&(Z=v,v=I,I=Z,Z=g,g=A,A=Z),H[I+1]>H[x+1]&&(Z=I,I=x,x=Z,Z=A,A=M,M=Z),H[v+1]>H[I+1]&&(Z=v,v=I,I=Z,Z=g,g=A,A=Z);const Q=(H[v]+h.offsetX)*h.scaleX,tt=(H[v+1]+h.offsetY)*h.scaleY,st=(H[I]+h.offsetX)*h.scaleX,K=(H[I+1]+h.offsetY)*h.scaleY,R=(H[x]+h.offsetX)*h.scaleX,m=(H[x+1]+h.offsetY)*h.scaleY;if(tt>=m)return;const l=N[g],c=N[g+1],b=N[g+2],P=N[A],T=N[A+1],D=N[A+2],k=N[M],s=N[M+1],p=N[M+2],y=Math.round(tt),E=Math.round(m);let C,j,B,V,nt,q,Y,J;for(let $=y;$<=E;$++){if($<K){const ct=$<tt?0:(tt-$)/(tt-K);C=Q-(Q-st)*ct,j=l-(l-P)*ct,B=c-(c-T)*ct,V=b-(b-D)*ct}else{let ct;$>m?ct=1:K===m?ct=0:ct=(K-$)/(K-m),C=st-(st-R)*ct,j=P-(P-k)*ct,B=T-(T-s)*ct,V=D-(D-p)*ct}let et;$<tt?et=0:$>m?et=1:et=(tt-$)/(tt-m),nt=Q-(Q-R)*et,q=l-(l-k)*et,Y=c-(c-s)*et,J=b-(b-p)*et;const rt=Math.round(Math.min(C,nt)),ot=Math.round(Math.max(C,nt));let lt=G*$+rt*4;for(let ct=rt;ct<=ot;ct++)et=(C-ct)/(C-nt),et<0?et=0:et>1&&(et=1),W[lt++]=j-(j-q)*et|0,W[lt++]=B-(B-Y)*et|0,W[lt++]=V-(V-J)*et|0,W[lt++]=255}}function i(u,h,v){const I=h.coords,x=h.colors;let g,A;switch(h.type){case"lattice":const M=h.verticesPerRow,H=Math.floor(I.length/M)-1,N=M-1;for(g=0;g<H;g++){let W=g*M;for(let G=0;G<N;G++,W++)t(u,v,I[W],I[W+1],I[W+M],x[W],x[W+1],x[W+M]),t(u,v,I[W+M+1],I[W+1],I[W+M],x[W+M+1],x[W+1],x[W+M])}break;case"triangles":for(g=0,A=I.length;g<A;g+=3)t(u,v,I[g],I[g+1],I[g+2],x[g],x[g+1],x[g+2]);break;default:throw new Error("illegal figure")}}class d extends L{constructor(h){super(),this._coords=h[2],this._colors=h[3],this._figures=h[4],this._bounds=h[5],this._bbox=h[7],this._background=h[8],this.matrix=null}_createMeshCanvas(h,v,I){const M=Math.floor(this._bounds[0]),H=Math.floor(this._bounds[1]),N=Math.ceil(this._bounds[2])-M,W=Math.ceil(this._bounds[3])-H,G=Math.min(Math.ceil(Math.abs(N*h[0]*1.1)),3e3),Z=Math.min(Math.ceil(Math.abs(W*h[1]*1.1)),3e3),Q=N/G,tt=W/Z,st={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-H,scaleX:1/Q,scaleY:1/tt},K=G+4,R=Z+4,m=I.getCanvas("mesh",K,R,!1),l=m.context,c=l.createImageData(G,Z);if(v){const P=c.data;for(let T=0,D=P.length;T<D;T+=4)P[T]=v[0],P[T+1]=v[1],P[T+2]=v[2],P[T+3]=255}for(const P of this._figures)i(c,P,st);return l.putImageData(c,2,2),{canvas:m.canvas,offsetX:M-2*Q,offsetY:H-2*tt,scaleX:Q,scaleY:tt}}getPattern(h,v,I,x){O(h,this._bbox);let g;if(x===F.SHADING)g=a.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(h));else if(g=a.Util.singularValueDecompose2dScale(v.baseTransform),this.matrix){const M=a.Util.singularValueDecompose2dScale(this.matrix);g=[g[0]*M[0],g[1]*M[1]]}const A=this._createMeshCanvas(g,x===F.SHADING?null:this._background,v.cachedCanvases);return x!==F.SHADING&&(h.setTransform(...v.baseTransform),this.matrix&&h.transform(...this.matrix)),h.translate(A.offsetX,A.offsetY),h.scale(A.scaleX,A.scaleY),h.createPattern(A.canvas,"no-repeat")}}class r extends L{getPattern(){return"hotpink"}}function o(u){switch(u[0]){case"RadialAxial":return new S(u);case"Mesh":return new d(u);case"Dummy":return new r}throw new Error(`Unknown IR type: ${u[0]}`)}const e={COLORED:1,UNCOLORED:2};class f{static MAX_PATTERN_SIZE=3e3;constructor(h,v,I,x,g){this.operatorList=h[2],this.matrix=h[3]||[1,0,0,1,0,0],this.bbox=h[4],this.xstep=h[5],this.ystep=h[6],this.paintType=h[7],this.tilingType=h[8],this.color=v,this.ctx=I,this.canvasGraphicsFactory=x,this.baseTransform=g}createPatternCanvas(h){const v=this.operatorList,I=this.bbox,x=this.xstep,g=this.ystep,A=this.paintType,M=this.tilingType,H=this.color,N=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+M);const W=I[0],G=I[1],Z=I[2],Q=I[3],tt=a.Util.singularValueDecompose2dScale(this.matrix),st=a.Util.singularValueDecompose2dScale(this.baseTransform),K=[tt[0]*st[0],tt[1]*st[1]],R=this.getSizeAndScale(x,this.ctx.canvas.width,K[0]),m=this.getSizeAndScale(g,this.ctx.canvas.height,K[1]),l=h.cachedCanvases.getCanvas("pattern",R.size,m.size,!0),c=l.context,b=N.createCanvasGraphics(c);b.groupLevel=h.groupLevel,this.setFillAndStrokeStyleToContext(b,A,H);let P=W,T=G,D=Z,k=Q;return W<0&&(P=0,D+=Math.abs(W)),G<0&&(T=0,k+=Math.abs(G)),c.translate(-(R.scale*P),-(m.scale*T)),b.transform(R.scale,0,0,m.scale,0,0),c.save(),this.clipBbox(b,P,T,D,k),b.baseTransform=(0,_.getCurrentTransform)(b.ctx),b.executeOperatorList(v),b.endDrawing(),{canvas:l.canvas,scaleX:R.scale,scaleY:m.scale,offsetX:P,offsetY:T}}getSizeAndScale(h,v,I){h=Math.abs(h);const x=Math.max(f.MAX_PATTERN_SIZE,v);let g=Math.ceil(h*I);return g>=x?g=x:I=g/h,{scale:I,size:g}}clipBbox(h,v,I,x,g){const A=x-v,M=g-I;h.ctx.rect(v,I,A,M),h.current.updateRectMinMax((0,_.getCurrentTransform)(h.ctx),[v,I,x,g]),h.clip(),h.endPath()}setFillAndStrokeStyleToContext(h,v,I){const x=h.ctx,g=h.current;switch(v){case e.COLORED:const A=this.ctx;x.fillStyle=A.fillStyle,x.strokeStyle=A.strokeStyle,g.fillColor=A.fillStyle,g.strokeColor=A.strokeStyle;break;case e.UNCOLORED:const M=a.Util.makeHexColor(I[0],I[1],I[2]);x.fillStyle=M,x.strokeStyle=M,g.fillColor=M,g.strokeColor=M;break;default:throw new a.FormatError(`Unsupported paint type: ${v}`)}}getPattern(h,v,I,x){let g=I;x!==F.SHADING&&(g=a.Util.transform(g,v.baseTransform),this.matrix&&(g=a.Util.transform(g,this.matrix)));const A=this.createPatternCanvas(v);let M=new DOMMatrix(g);M=M.translate(A.offsetX,A.offsetY),M=M.scale(1/A.scaleX,1/A.scaleY);const H=h.createPattern(A.canvas,"repeat");return H.setTransform(M),H}}n.TilingPattern=f}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=F,n.convertToRGBA=_,n.grayToRGBA=L;var a=w(1);function _(S){switch(S.kind){case a.ImageKind.GRAYSCALE_1BPP:return F(S);case a.ImageKind.RGB_24BPP:return O(S)}return null}function F({src:S,srcPos:t=0,dest:i,width:d,height:r,nonBlackColor:o=4294967295,inverseDecode:e=!1}){const f=a.FeatureTest.isLittleEndian?4278190080:255,[u,h]=e?[o,f]:[f,o],v=d>>3,I=d&7,x=S.length;i=new Uint32Array(i.buffer);let g=0;for(let A=0;A<r;A++){for(const H=t+v;t<H;t++){const N=t<x?S[t]:255;i[g++]=N&128?h:u,i[g++]=N&64?h:u,i[g++]=N&32?h:u,i[g++]=N&16?h:u,i[g++]=N&8?h:u,i[g++]=N&4?h:u,i[g++]=N&2?h:u,i[g++]=N&1?h:u}if(I===0)continue;const M=t<x?S[t++]:255;for(let H=0;H<I;H++)i[g++]=M&1<<7-H?h:u}return{srcPos:t,destPos:g}}function O({src:S,srcPos:t=0,dest:i,destPos:d=0,width:r,height:o}){let e=0;const f=S.length>>2,u=new Uint32Array(S.buffer,t,f);if(a.FeatureTest.isLittleEndian){for(;e<f-2;e+=3,d+=4){const h=u[e],v=u[e+1],I=u[e+2];i[d]=h|4278190080,i[d+1]=h>>>24|v<<8|4278190080,i[d+2]=v>>>16|I<<16|4278190080,i[d+3]=I>>>8|4278190080}for(let h=e*4,v=S.length;h<v;h+=3)i[d++]=S[h]|S[h+1]<<8|S[h+2]<<16|4278190080}else{for(;e<f-2;e+=3,d+=4){const h=u[e],v=u[e+1],I=u[e+2];i[d]=h|255,i[d+1]=h<<24|v>>>8|255,i[d+2]=v<<16|I>>>16|255,i[d+3]=I<<8|255}for(let h=e*4,v=S.length;h<v;h+=3)i[d++]=S[h]<<24|S[h+1]<<16|S[h+2]<<8|255}return{srcPos:t,destPos:d}}function L(S,t){if(a.FeatureTest.isLittleEndian)for(let i=0,d=S.length;i<d;i++)t[i]=S[i]*65793|4278190080;else for(let i=0,d=S.length;i<d;i++)t[i]=S[i]*16843008|255}}),((U,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const w=Object.create(null);n.GlobalWorkerOptions=w,w.workerPort=null,w.workerSrc=""}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var a=w(1);const _={DATA:1,ERROR:2},F={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function O(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new a.AbortException(S.message);case"MissingPDFException":return new a.MissingPDFException(S.message);case"PasswordException":return new a.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new a.UnknownErrorException(S.message,S.details);default:return new a.UnknownErrorException(S.message,S.toString())}}class L{constructor(t,i,d){this.sourceName=t,this.targetName=i,this.comObj=d,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=r=>{const o=r.data;if(o.targetName!==this.sourceName)return;if(o.stream){this.#e(o);return}if(o.callback){const f=o.callbackId,u=this.callbackCapabilities[f];if(!u)throw new Error(`Cannot resolve callback ${f}`);if(delete this.callbackCapabilities[f],o.callback===_.DATA)u.resolve(o.data);else if(o.callback===_.ERROR)u.reject(O(o.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[o.action];if(!e)throw new Error(`Unknown action from worker: ${o.action}`);if(o.callbackId){const f=this.sourceName,u=o.sourceName;new Promise(function(h){h(e(o.data))}).then(function(h){d.postMessage({sourceName:f,targetName:u,callback:_.DATA,callbackId:o.callbackId,data:h})},function(h){d.postMessage({sourceName:f,targetName:u,callback:_.ERROR,callbackId:o.callbackId,reason:O(h)})});return}if(o.streamId){this.#t(o);return}e(o.data)},d.addEventListener("message",this._onComObjOnMessage)}on(t,i){const d=this.actionHandler;if(d[t])throw new Error(`There is already an actionName called "${t}"`);d[t]=i}send(t,i,d){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},d)}sendWithPromise(t,i,d){const r=this.callbackId++,o=new a.PromiseCapability;this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},d)}catch(e){o.reject(e)}return o.promise}sendWithStream(t,i,d,r){const o=this.streamId++,e=this.sourceName,f=this.targetName,u=this.comObj;return new ReadableStream({start:h=>{const v=new a.PromiseCapability;return this.streamControllers[o]={controller:h,startCall:v,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:e,targetName:f,action:t,streamId:o,data:i,desiredSize:h.desiredSize},r),v.promise},pull:h=>{const v=new a.PromiseCapability;return this.streamControllers[o].pullCall=v,u.postMessage({sourceName:e,targetName:f,stream:F.PULL,streamId:o,desiredSize:h.desiredSize}),v.promise},cancel:h=>{(0,a.assert)(h instanceof Error,"cancel must have a valid reason");const v=new a.PromiseCapability;return this.streamControllers[o].cancelCall=v,this.streamControllers[o].isClosed=!0,u.postMessage({sourceName:e,targetName:f,stream:F.CANCEL,streamId:o,reason:O(h)}),v.promise}},d)}#t(t){const i=t.streamId,d=this.sourceName,r=t.sourceName,o=this.comObj,e=this,f=this.actionHandler[t.action],u={enqueue(h,v=1,I){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=v,x>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),o.postMessage({sourceName:d,targetName:r,stream:F.ENQUEUE,streamId:i,chunk:h},I)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:d,targetName:r,stream:F.CLOSE,streamId:i}),delete e.streamSinks[i])},error(h){(0,a.assert)(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:d,targetName:r,stream:F.ERROR,streamId:i,reason:O(h)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[i]=u,new Promise(function(h){h(f(t.data,u))}).then(function(){o.postMessage({sourceName:d,targetName:r,stream:F.START_COMPLETE,streamId:i,success:!0})},function(h){o.postMessage({sourceName:d,targetName:r,stream:F.START_COMPLETE,streamId:i,reason:O(h)})})}#e(t){const i=t.streamId,d=this.sourceName,r=t.sourceName,o=this.comObj,e=this.streamControllers[i],f=this.streamSinks[i];switch(t.stream){case F.START_COMPLETE:t.success?e.startCall.resolve():e.startCall.reject(O(t.reason));break;case F.PULL_COMPLETE:t.success?e.pullCall.resolve():e.pullCall.reject(O(t.reason));break;case F.PULL:if(!f){o.postMessage({sourceName:d,targetName:r,stream:F.PULL_COMPLETE,streamId:i,success:!0});break}f.desiredSize<=0&&t.desiredSize>0&&f.sinkCapability.resolve(),f.desiredSize=t.desiredSize,new Promise(function(u){u(f.onPull?.())}).then(function(){o.postMessage({sourceName:d,targetName:r,stream:F.PULL_COMPLETE,streamId:i,success:!0})},function(u){o.postMessage({sourceName:d,targetName:r,stream:F.PULL_COMPLETE,streamId:i,reason:O(u)})});break;case F.ENQUEUE:if((0,a.assert)(e,"enqueue should have stream controller"),e.isClosed)break;e.controller.enqueue(t.chunk);break;case F.CLOSE:if((0,a.assert)(e,"close should have stream controller"),e.isClosed)break;e.isClosed=!0,e.controller.close(),this.#i(e,i);break;case F.ERROR:(0,a.assert)(e,"error should have stream controller"),e.controller.error(O(t.reason)),this.#i(e,i);break;case F.CANCEL_COMPLETE:t.success?e.cancelCall.resolve():e.cancelCall.reject(O(t.reason)),this.#i(e,i);break;case F.CANCEL:if(!f)break;new Promise(function(u){u(f.onCancel?.(O(t.reason)))}).then(function(){o.postMessage({sourceName:d,targetName:r,stream:F.CANCEL_COMPLETE,streamId:i,success:!0})},function(u){o.postMessage({sourceName:d,targetName:r,stream:F.CANCEL_COMPLETE,streamId:i,reason:O(u)})}),f.sinkCapability.reject(O(t.reason)),f.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#i(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=L}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var a=w(1);class _{#t;#e;constructor({parsedData:O,rawData:L}){this.#t=O,this.#e=L}getRaw(){return this.#e}get(O){return this.#t.get(O)??null}getAll(){return(0,a.objectFromMap)(this.#t)}has(O){return this.#t.has(O)}}n.Metadata=_}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var a=w(1),_=w(8);const F=Symbol("INTERNAL");class O{#t=!0;constructor(t,i){this.name=t,this.intent=i}get visible(){return this.#t}_setVisible(t,i){t!==F&&(0,a.unreachable)("Internal method `_setVisible` called."),this.#t=i}}class L{#t=null;#e=new Map;#i=null;#s=null;constructor(t){if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#s=t.order;for(const i of t.groups)this.#e.set(i.id,new O(i.name,i.intent));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(F,!1);for(const i of t.on)this.#e.get(i)._setVisible(F,!0);for(const i of t.off)this.#e.get(i)._setVisible(F,!1);this.#i=this.getHash()}}#a(t){const i=t.length;if(i<2)return!0;const d=t[0];for(let r=1;r<i;r++){const o=t[r];let e;if(Array.isArray(o))e=this.#a(o);else if(this.#e.has(o))e=this.#e.get(o).visible;else return(0,a.warn)(`Optional content group not found: ${o}`),!0;switch(d){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return d==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return(0,a.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:((0,a.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return(0,a.warn)(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return(0,a.warn)(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return(0,a.warn)(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return(0,a.warn)(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,a.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0){if(!this.#e.has(t)){(0,a.warn)(`Optional content group not found: ${t}`);return}this.#e.get(t)._setVisible(F,!!i),this.#t=null}get hasInitialVisibility(){return this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new _.MurmurHash3_64;for(const[i,d]of this.#e)t.update(`${i}:${d.visible}`);return this.#t=t.hexdigest()}}n.OptionalContentConfig=L}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var a=w(1),_=w(6);class F{constructor({length:t,initialData:i,progressiveDone:d=!1,contentDispositionFilename:r=null,disableRange:o=!1,disableStream:e=!1},f){if((0,a.assert)(f,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=d,this._contentDispositionFilename=r,i?.length>0){const u=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=f,this._isStreamingSupported=!e,this._isRangeSupported=!o,this._contentLength=t,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,h)=>{this._onReceiveData({begin:u,chunk:h})}),this._pdfDataRangeTransport.addProgressListener((u,h)=>{this._onProgress({loaded:u,total:h})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:t,chunk:i}){const d=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const r=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(d),!0)});(0,a.assert)(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new O(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const d=new L(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(d),d}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=F;class O{constructor(t,i,d=!1,r=null){this._stream=t,this._done=d||!1,this._filename=(0,_.isPdfFile)(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=new a.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class L{constructor(t,i,d){this._stream=t,this._begin=i,this._end=d,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=new a.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var a=w(1),_=w(20);function F(d,r,o){return{method:"GET",headers:d,signal:o.signal,mode:"cors",credentials:r?"include":"same-origin",redirect:"follow"}}function O(d){const r=new Headers;for(const o in d){const e=d[o];e!==void 0&&r.append(o,e)}return r}function L(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:((0,a.warn)(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class S{constructor(r){this.source=r,this.isHttp=/^https?:/i.test(r.url),this.httpHeaders=this.isHttp&&r.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new t(this),this._fullRequestReader}getRangeReader(r,o){if(o<=this._progressiveDataLength)return null;const e=new i(this,r,o);return this._rangeRequestReaders.push(e),e}cancelAllRequests(r){this._fullRequestReader?.cancel(r);for(const o of this._rangeRequestReaders.slice(0))o.cancel(r)}}n.PDFFetchStream=S;class t{constructor(r){this._stream=r,this._reader=null,this._loaded=0,this._filename=null;const o=r.source;this._withCredentials=o.withCredentials||!1,this._contentLength=o.length,this._headersCapability=new a.PromiseCapability,this._disableRange=o.disableRange||!1,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!o.disableStream,this._isRangeSupported=!o.disableRange,this._headers=O(this._stream.httpHeaders);const e=o.url;fetch(e,F(this._headers,this._withCredentials,this._abortController)).then(f=>{if(!(0,_.validateResponseStatus)(f.status))throw(0,_.createResponseStatusError)(f.status,e);this._reader=f.body.getReader(),this._headersCapability.resolve();const u=I=>f.headers.get(I),{allowRangeRequests:h,suggestedLength:v}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=h,this._contentLength=v||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:r,done:o}=await this._reader.read();return o?{value:r,done:o}:(this._loaded+=r.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:L(r),done:!1})}cancel(r){this._reader?.cancel(r),this._abortController.abort()}}class i{constructor(r,o,e){this._stream=r,this._reader=null,this._loaded=0;const f=r.source;this._withCredentials=f.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!f.disableStream,this._abortController=new AbortController,this._headers=O(this._stream.httpHeaders),this._headers.append("Range",`bytes=${o}-${e-1}`);const u=f.url;fetch(u,F(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,_.validateResponseStatus)(h.status))throw(0,_.createResponseStatusError)(h.status,u);this._readCapability.resolve(),this._reader=h.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:r,done:o}=await this._reader.read();return o?{value:r,done:o}:(this._loaded+=r.byteLength,this.onProgress?.({loaded:this._loaded}),{value:L(r),done:!1})}cancel(r){this._reader?.cancel(r),this._abortController.abort()}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=S,n.extractFilenameFromHeader=L,n.validateRangeRequestCapabilities=O,n.validateResponseStatus=t;var a=w(1),_=w(21),F=w(6);function O({getResponseHeader:i,isHttp:d,rangeChunkSize:r,disableRange:o}){const e={allowRangeRequests:!1,suggestedLength:void 0},f=parseInt(i("Content-Length"),10);return!Number.isInteger(f)||(e.suggestedLength=f,f<=2*r)||o||!d||i("Accept-Ranges")!=="bytes"||(i("Content-Encoding")||"identity")!=="identity"||(e.allowRangeRequests=!0),e}function L(i){const d=i("Content-Disposition");if(d){let r=(0,_.getFilenameFromContentDispositionHeader)(d);if(r.includes("%"))try{r=decodeURIComponent(r)}catch{}if((0,F.isPdfFile)(r))return r}return null}function S(i,d){return i===404||i===0&&d.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+d+'".'):new a.UnexpectedResponseException(`Unexpected server response (${i}) while retrieving PDF "${d}".`,i)}function t(i){return i===200||i===206}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=_;var a=w(1);function _(F){let O=!0,L=S("filename\\*","i").exec(F);if(L){L=L[1];let f=r(L);return f=unescape(f),f=o(f),f=e(f),i(f)}if(L=d(F),L){const f=e(L);return i(f)}if(L=S("filename","i").exec(F),L){L=L[1];let f=r(L);return f=e(f),i(f)}function S(f,u){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function t(f,u){if(f){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const h=new TextDecoder(f,{fatal:!0}),v=(0,a.stringToBytes)(u);u=h.decode(v),O=!1}catch{}}return u}function i(f){return O&&/[\x80-\xff]/.test(f)&&(f=t("utf-8",f),O&&(f=t("iso-8859-1",f))),f}function d(f){const u=[];let h;const v=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=v.exec(f))!==null;){let[,x,g,A]=h;if(x=parseInt(x,10),x in u){if(x===0)break;continue}u[x]=[g,A]}const I=[];for(let x=0;x<u.length&&x in u;++x){let[g,A]=u[x];A=r(A),g&&(A=unescape(A),x===0&&(A=o(A))),I.push(A)}return I.join("")}function r(f){if(f.startsWith('"')){const u=f.slice(1).split('\\"');for(let h=0;h<u.length;++h){const v=u[h].indexOf('"');v!==-1&&(u[h]=u[h].slice(0,v),u.length=h+1),u[h]=u[h].replaceAll(/\\(.)/g,"$1")}f=u.join('"')}return f}function o(f){const u=f.indexOf("'");if(u===-1)return f;const h=f.slice(0,u),I=f.slice(u+1).replace(/^[^']*'/,"");return t(h,I)}function e(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,h,v,I){if(v==="q"||v==="Q")return I=I.replaceAll("_"," "),I=I.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,g){return String.fromCharCode(parseInt(g,16))}),t(h,I);try{I=atob(I)}catch{}return t(h,I)})}return""}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var a=w(1),_=w(20);const F=200,O=206;function L(r){const o=r.response;return typeof o!="string"?o:(0,a.stringToBytes)(o).buffer}class S{constructor(o,e={}){this.url=o,this.isHttp=/^https?:/i.test(o),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(o,e,f){const u={begin:o,end:e};for(const h in f)u[h]=f[h];return this.request(u)}requestFull(o){return this.request(o)}request(o){const e=new XMLHttpRequest,f=this.currXhrId++,u=this.pendingRequests[f]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const h in this.httpHeaders){const v=this.httpHeaders[h];v!==void 0&&e.setRequestHeader(h,v)}return this.isHttp&&"begin"in o&&"end"in o?(e.setRequestHeader("Range",`bytes=${o.begin}-${o.end-1}`),u.expectedStatus=O):u.expectedStatus=F,e.responseType="arraybuffer",o.onError&&(e.onerror=function(h){o.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,f),e.onprogress=this.onProgress.bind(this,f),u.onHeadersReceived=o.onHeadersReceived,u.onDone=o.onDone,u.onError=o.onError,u.onProgress=o.onProgress,e.send(null),f}onProgress(o,e){const f=this.pendingRequests[o];f&&f.onProgress?.(e)}onStateChange(o,e){const f=this.pendingRequests[o];if(!f)return;const u=f.xhr;if(u.readyState>=2&&f.onHeadersReceived&&(f.onHeadersReceived(),delete f.onHeadersReceived),u.readyState!==4||!(o in this.pendingRequests))return;if(delete this.pendingRequests[o],u.status===0&&this.isHttp){f.onError?.(u.status);return}const h=u.status||F;if(!(h===F&&f.expectedStatus===O)&&h!==f.expectedStatus){f.onError?.(u.status);return}const I=L(u);if(h===O){const x=u.getResponseHeader("Content-Range"),g=/bytes (\d+)-(\d+)\/(\d+)/.exec(x);f.onDone({begin:parseInt(g[1],10),chunk:I})}else I?f.onDone({begin:0,chunk:I}):f.onError?.(u.status)}getRequestXhr(o){return this.pendingRequests[o].xhr}isPendingRequest(o){return o in this.pendingRequests}abortRequest(o){const e=this.pendingRequests[o].xhr;delete this.pendingRequests[o],e.abort()}}class t{constructor(o){this._source=o,this._manager=new S(o.url,{httpHeaders:o.httpHeaders,withCredentials:o.withCredentials}),this._rangeChunkSize=o.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(o){const e=this._rangeRequestReaders.indexOf(o);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new i(this._manager,this._source),this._fullRequestReader}getRangeReader(o,e){const f=new d(this._manager,o,e);return f.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(f),f}cancelAllRequests(o){this._fullRequestReader?.cancel(o);for(const e of this._rangeRequestReaders.slice(0))e.cancel(o)}}n.PDFNetworkStream=t;class i{constructor(o,e){this._manager=o;const f={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=o.requestFull(f),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const o=this._fullRequestId,e=this._manager.getRequestXhr(o),f=v=>e.getResponseHeader(v),{allowRangeRequests:u,suggestedLength:h}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(f),this._isRangeSupported&&this._manager.abortRequest(o),this._headersReceivedCapability.resolve()}_onDone(o){if(o&&(this._requests.length>0?this._requests.shift().resolve({value:o.chunk,done:!1}):this._cachedChunks.push(o.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(o){this._storedError=(0,_.createResponseStatusError)(o,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(o){this.onProgress?.({loaded:o.loaded,total:o.lengthComputable?o.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const o=new a.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){this._done=!0,this._headersReceivedCapability.reject(o);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(o,e,f){this._manager=o;const u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=o.url,this._requestId=o.requestRange(e,f,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(o){const e=o.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(o){this._storedError=(0,_.createResponseStatusError)(o,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(o){this.isStreamingSupported||this.onProgress?.({loaded:o.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const o=new a.PromiseCapability;return this._requests.push(o),o.promise}cancel(o){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var a=w(1),_=w(20);const F=/^file:\/\/\/[a-zA-Z]:\//;function O(f){const u=require$$5,h=u.parse(f);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(f)?u.parse(`file:///${f}`):(h.host||(h.protocol="file:"),h)}class L{constructor(u){this.source=u,this.url=O(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new o(this):new d(this),this._fullRequestReader}getRangeReader(u,h){if(h<=this._progressiveDataLength)return null;const v=this.isFsUrl?new e(this,u,h):new r(this,u,h);return this._rangeRequestReaders.push(v),v}cancelAllRequests(u){this._fullRequestReader?.cancel(u);for(const h of this._rangeRequestReaders.slice(0))h.cancel(u)}}n.PDFNodeStream=L;class S{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;const h=u.source;this._contentLength=h.length,this._loaded=0,this._filename=null,this._disableRange=h.disableRange||!1,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=u.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",h=>{this._error(h)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class t{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const h=u.source;this._isStreamingSupported=!h.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=u.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",h=>{this._error(h)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function i(f,u){return{protocol:f.protocol,auth:f.auth,host:f.hostname,port:f.port,path:f.path,method:"GET",headers:u}}class d extends S{constructor(u){super(u);const h=v=>{if(v.statusCode===404){const A=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A,this._headersCapability.reject(A);return}this._headersCapability.resolve(),this._setReadableStream(v);const I=A=>this._readableStream.headers[A.toLowerCase()],{allowRangeRequests:x,suggestedLength:g}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:I,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=x,this._contentLength=g||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(I)};if(this._request=null,this._url.protocol==="http:"){const v=require$$5;this._request=v.request(i(this._url,u.httpHeaders),h)}else{const v=require$$5;this._request=v.request(i(this._url,u.httpHeaders),h)}this._request.on("error",v=>{this._storedError=v,this._headersCapability.reject(v)}),this._request.end()}}class r extends t{constructor(u,h,v){super(u),this._httpHeaders={};for(const x in u.httpHeaders){const g=u.httpHeaders[x];g!==void 0&&(this._httpHeaders[x]=g)}this._httpHeaders.Range=`bytes=${h}-${v-1}`;const I=x=>{if(x.statusCode===404){const g=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=g;return}this._setReadableStream(x)};if(this._request=null,this._url.protocol==="http:"){const x=require$$5;this._request=x.request(i(this._url,this._httpHeaders),I)}else{const x=require$$5;this._request=x.request(i(this._url,this._httpHeaders),I)}this._request.on("error",x=>{this._storedError=x}),this._request.end()}}class o extends S{constructor(u){super(u);let h=decodeURIComponent(this._url.path);F.test(this._url.href)&&(h=h.replace(/^\//,""));const v=require$$5;v.lstat(h,(I,x)=>{if(I){I.code==="ENOENT"&&(I=new a.MissingPDFException(`Missing PDF "${h}".`)),this._storedError=I,this._headersCapability.reject(I);return}this._contentLength=x.size,this._setReadableStream(v.createReadStream(h)),this._headersCapability.resolve()})}}class e extends t{constructor(u,h,v){super(u);let I=decodeURIComponent(this._url.path);F.test(this._url.href)&&(I=I.replace(/^\//,""));const x=require$$5;this._setReadableStream(x.createReadStream(I,{start:h,end:v-1}))}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var a=w(6),_=w(1);const F={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},O="http://www.w3.org/XML/1998/namespace",L="http://www.w3.org/1999/xlink",S=["butt","round","square"],t=["miter","round","bevel"],i=function(x,g="",A=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!A)return URL.createObjectURL(new Blob([x],{type:g}));const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let H=`data:${g};base64,`;for(let N=0,W=x.length;N<W;N+=3){const G=x[N]&255,Z=x[N+1]&255,Q=x[N+2]&255,tt=G>>2,st=(G&3)<<4|Z>>4,K=N+1<W?(Z&15)<<2|Q>>6:64,R=N+2<W?Q&63:64;H+=M[tt]+M[st]+M[K]+M[R]}return H},d=(function(){const x=new Uint8Array([137,80,78,71,13,10,26,10]),g=12,A=new Int32Array(256);for(let Q=0;Q<256;Q++){let tt=Q;for(let st=0;st<8;st++)tt=tt&1?3988292384^tt>>1&2147483647:tt>>1&2147483647;A[Q]=tt}function M(Q,tt,st){let K=-1;for(let R=tt;R<st;R++){const m=(K^Q[R])&255,l=A[m];K=K>>>8^l}return K^-1}function H(Q,tt,st,K){let R=K;const m=tt.length;st[R]=m>>24&255,st[R+1]=m>>16&255,st[R+2]=m>>8&255,st[R+3]=m&255,R+=4,st[R]=Q.charCodeAt(0)&255,st[R+1]=Q.charCodeAt(1)&255,st[R+2]=Q.charCodeAt(2)&255,st[R+3]=Q.charCodeAt(3)&255,R+=4,st.set(tt,R),R+=tt.length;const l=M(st,K+4,R);st[R]=l>>24&255,st[R+1]=l>>16&255,st[R+2]=l>>8&255,st[R+3]=l&255}function N(Q,tt,st){let K=1,R=0;for(let m=tt;m<st;++m)K=(K+(Q[m]&255))%65521,R=(R+K)%65521;return R<<16|K}function W(Q){if(!_.isNodeJS)return G(Q);try{const tt=parseInt(process.versions.node)>=8?Q:Buffer.from(Q),st=require$$5.deflateSync(tt,{level:9});return st instanceof Uint8Array?st:new Uint8Array(st)}catch(tt){(0,_.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return G(Q)}function G(Q){let tt=Q.length;const st=65535,K=Math.ceil(tt/st),R=new Uint8Array(2+tt+K*5+4);let m=0;R[m++]=120,R[m++]=156;let l=0;for(;tt>st;)R[m++]=0,R[m++]=255,R[m++]=255,R[m++]=0,R[m++]=0,R.set(Q.subarray(l,l+st),m),m+=st,l+=st,tt-=st;R[m++]=1,R[m++]=tt&255,R[m++]=tt>>8&255,R[m++]=~tt&65535&255,R[m++]=(~tt&65535)>>8&255,R.set(Q.subarray(l),m),m+=Q.length-l;const c=N(Q,0,Q.length);return R[m++]=c>>24&255,R[m++]=c>>16&255,R[m++]=c>>8&255,R[m++]=c&255,R}function Z(Q,tt,st,K){const R=Q.width,m=Q.height;let l,c,b;const P=Q.data;switch(tt){case _.ImageKind.GRAYSCALE_1BPP:c=0,l=1,b=R+7>>3;break;case _.ImageKind.RGB_24BPP:c=2,l=8,b=R*3;break;case _.ImageKind.RGBA_32BPP:c=6,l=8,b=R*4;break;default:throw new Error("invalid format")}const T=new Uint8Array((1+b)*m);let D=0,k=0;for(let j=0;j<m;++j)T[D++]=0,T.set(P.subarray(k,k+b),D),k+=b,D+=b;if(tt===_.ImageKind.GRAYSCALE_1BPP&&K){D=0;for(let j=0;j<m;j++){D++;for(let B=0;B<b;B++)T[D++]^=255}}const s=new Uint8Array([R>>24&255,R>>16&255,R>>8&255,R&255,m>>24&255,m>>16&255,m>>8&255,m&255,l,c,0,0,0]),p=W(T),y=x.length+g*3+s.length+p.length,E=new Uint8Array(y);let C=0;return E.set(x,C),C+=x.length,H("IHDR",s,E,C),C+=g+s.length,H("IDATA",p,E,C),C+=g+p.length,H("IEND",new Uint8Array(0),E,C),i(E,"image/png",st)}return function(tt,st,K){const R=tt.kind===void 0?_.ImageKind.GRAYSCALE_1BPP:tt.kind;return Z(tt,R,st,K)}})();class r{constructor(){this.fontSizeScale=1,this.fontWeight=F.fontWeight,this.fontSize=0,this.textMatrix=_.IDENTITY_MATRIX,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=F.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(g,A){this.x=g,this.y=A}}function o(x){let g=[];const A=[];for(const M of x){if(M.fn==="save"){g.push({fnId:92,fn:"group",items:[]}),A.push(g),g=g.at(-1).items;continue}M.fn==="restore"?g=A.pop():g.push(M)}return g}function e(x){if(Number.isInteger(x))return x.toString();const g=x.toFixed(10);let A=g.length-1;if(g[A]!=="0")return g;do A--;while(g[A]==="0");return g.substring(0,g[A]==="."?A:A+1)}function f(x){if(x[4]===0&&x[5]===0){if(x[1]===0&&x[2]===0)return x[0]===1&&x[3]===1?"":`scale(${e(x[0])} ${e(x[3])})`;if(x[0]===x[3]&&x[1]===-x[2]){const g=Math.acos(x[0])*180/Math.PI;return`rotate(${e(g)})`}}else if(x[0]===1&&x[1]===0&&x[2]===0&&x[3]===1)return`translate(${e(x[4])} ${e(x[5])})`;return`matrix(${e(x[0])} ${e(x[1])} ${e(x[2])} ${e(x[3])} ${e(x[4])} ${e(x[5])})`}let u=0,h=0,v=0;class I{constructor(g,A,M=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new r,this.transformMatrix=_.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=g,this.objs=A,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!M,this._operatorIdMapping=[];for(const H in _.OPS)this._operatorIdMapping[_.OPS[H]]=H}getObject(g,A=null){return typeof g=="string"?g.startsWith("g_")?this.commonObjs.get(g):this.objs.get(g):A}save(){this.transformStack.push(this.transformMatrix);const g=this.current;this.extraStack.push(g),this.current=g.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(g){this.save(),this.executeOpTree(g),this.restore()}loadDependencies(g){const A=g.fnArray,M=g.argsArray;for(let H=0,N=A.length;H<N;H++)if(A[H]===_.OPS.dependency)for(const W of M[H]){const G=W.startsWith("g_")?this.commonObjs:this.objs,Z=new Promise(Q=>{G.get(W,Q)});this.current.dependencies.push(Z)}return Promise.all(this.current.dependencies)}transform(g,A,M,H,N,W){const G=[g,A,M,H,N,W];this.transformMatrix=_.Util.transform(this.transformMatrix,G),this.tgrp=null}getSVG(g,A){this.viewport=A;const M=this._initialize(A);return this.loadDependencies(g).then(()=>(this.transformMatrix=_.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(g)),M))}convertOpList(g){const A=this._operatorIdMapping,M=g.argsArray,H=g.fnArray,N=[];for(let W=0,G=H.length;W<G;W++){const Z=H[W];N.push({fnId:Z,fn:A[Z],args:M[W]})}return o(N)}executeOpTree(g){for(const A of g){const M=A.fn,H=A.fnId,N=A.args;switch(H|0){case _.OPS.beginText:this.beginText();break;case _.OPS.dependency:break;case _.OPS.setLeading:this.setLeading(N);break;case _.OPS.setLeadingMoveText:this.setLeadingMoveText(N[0],N[1]);break;case _.OPS.setFont:this.setFont(N);break;case _.OPS.showText:this.showText(N[0]);break;case _.OPS.showSpacedText:this.showText(N[0]);break;case _.OPS.endText:this.endText();break;case _.OPS.moveText:this.moveText(N[0],N[1]);break;case _.OPS.setCharSpacing:this.setCharSpacing(N[0]);break;case _.OPS.setWordSpacing:this.setWordSpacing(N[0]);break;case _.OPS.setHScale:this.setHScale(N[0]);break;case _.OPS.setTextMatrix:this.setTextMatrix(N[0],N[1],N[2],N[3],N[4],N[5]);break;case _.OPS.setTextRise:this.setTextRise(N[0]);break;case _.OPS.setTextRenderingMode:this.setTextRenderingMode(N[0]);break;case _.OPS.setLineWidth:this.setLineWidth(N[0]);break;case _.OPS.setLineJoin:this.setLineJoin(N[0]);break;case _.OPS.setLineCap:this.setLineCap(N[0]);break;case _.OPS.setMiterLimit:this.setMiterLimit(N[0]);break;case _.OPS.setFillRGBColor:this.setFillRGBColor(N[0],N[1],N[2]);break;case _.OPS.setStrokeRGBColor:this.setStrokeRGBColor(N[0],N[1],N[2]);break;case _.OPS.setStrokeColorN:this.setStrokeColorN(N);break;case _.OPS.setFillColorN:this.setFillColorN(N);break;case _.OPS.shadingFill:this.shadingFill(N[0]);break;case _.OPS.setDash:this.setDash(N[0],N[1]);break;case _.OPS.setRenderingIntent:this.setRenderingIntent(N[0]);break;case _.OPS.setFlatness:this.setFlatness(N[0]);break;case _.OPS.setGState:this.setGState(N[0]);break;case _.OPS.fill:this.fill();break;case _.OPS.eoFill:this.eoFill();break;case _.OPS.stroke:this.stroke();break;case _.OPS.fillStroke:this.fillStroke();break;case _.OPS.eoFillStroke:this.eoFillStroke();break;case _.OPS.clip:this.clip("nonzero");break;case _.OPS.eoClip:this.clip("evenodd");break;case _.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _.OPS.paintImageXObject:this.paintImageXObject(N[0]);break;case _.OPS.paintInlineImageXObject:this.paintInlineImageXObject(N[0]);break;case _.OPS.paintImageMaskXObject:this.paintImageMaskXObject(N[0]);break;case _.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(N[0],N[1]);break;case _.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _.OPS.closePath:this.closePath();break;case _.OPS.closeStroke:this.closeStroke();break;case _.OPS.closeFillStroke:this.closeFillStroke();break;case _.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _.OPS.nextLine:this.nextLine();break;case _.OPS.transform:this.transform(N[0],N[1],N[2],N[3],N[4],N[5]);break;case _.OPS.constructPath:this.constructPath(N[0],N[1]);break;case _.OPS.endPath:this.endPath();break;case 92:this.group(A.items);break;default:(0,_.warn)(`Unimplemented operator ${M}`);break}}}setWordSpacing(g){this.current.wordSpacing=g}setCharSpacing(g){this.current.charSpacing=g}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(g,A,M,H,N,W){const G=this.current;G.textMatrix=G.lineMatrix=[g,A,M,H,N,W],G.textMatrixScale=Math.hypot(g,A),G.x=G.lineX=0,G.y=G.lineY=0,G.xcoords=[],G.ycoords=[],G.tspan=this.svgFactory.createElement("svg:tspan"),G.tspan.setAttributeNS(null,"font-family",G.fontFamily),G.tspan.setAttributeNS(null,"font-size",`${e(G.fontSize)}px`),G.tspan.setAttributeNS(null,"y",e(-G.y)),G.txtElement=this.svgFactory.createElement("svg:text"),G.txtElement.append(G.tspan)}beginText(){const g=this.current;g.x=g.lineX=0,g.y=g.lineY=0,g.textMatrix=_.IDENTITY_MATRIX,g.lineMatrix=_.IDENTITY_MATRIX,g.textMatrixScale=1,g.tspan=this.svgFactory.createElement("svg:tspan"),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtgrp=this.svgFactory.createElement("svg:g"),g.xcoords=[],g.ycoords=[]}moveText(g,A){const M=this.current;M.x=M.lineX+=g,M.y=M.lineY+=A,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${e(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",e(-M.y))}showText(g){const A=this.current,M=A.font,H=A.fontSize;if(H===0)return;const N=A.fontSizeScale,W=A.charSpacing,G=A.wordSpacing,Z=A.fontDirection,Q=A.textHScale*Z,tt=M.vertical,st=tt?1:-1,K=M.defaultVMetrics,R=H*A.fontMatrix[0];let m=0;for(const b of g){if(b===null){m+=Z*G;continue}else if(typeof b=="number"){m+=st*b*H/1e3;continue}const P=(b.isSpace?G:0)+W,T=b.fontChar;let D,k,s=b.width;if(tt){let y;const E=b.vmetric||K;y=b.vmetric?E[1]:s*.5,y=-y*R;const C=E[2]*R;s=E?-E[0]:s,D=y/N,k=(m+C)/N}else D=m/N,k=0;(b.isInFont||M.missingFile)&&(A.xcoords.push(A.x+D),tt&&A.ycoords.push(-A.y+k),A.tspan.textContent+=T);const p=tt?s*R-P*Z:s*R+P*Z;m+=p}A.tspan.setAttributeNS(null,"x",A.xcoords.map(e).join(" ")),tt?A.tspan.setAttributeNS(null,"y",A.ycoords.map(e).join(" ")):A.tspan.setAttributeNS(null,"y",e(-A.y)),tt?A.y-=m:A.x+=m*Q,A.tspan.setAttributeNS(null,"font-family",A.fontFamily),A.tspan.setAttributeNS(null,"font-size",`${e(A.fontSize)}px`),A.fontStyle!==F.fontStyle&&A.tspan.setAttributeNS(null,"font-style",A.fontStyle),A.fontWeight!==F.fontWeight&&A.tspan.setAttributeNS(null,"font-weight",A.fontWeight);const l=A.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;if(l===_.TextRenderingMode.FILL||l===_.TextRenderingMode.FILL_STROKE?(A.fillColor!==F.fillColor&&A.tspan.setAttributeNS(null,"fill",A.fillColor),A.fillAlpha<1&&A.tspan.setAttributeNS(null,"fill-opacity",A.fillAlpha)):A.textRenderingMode===_.TextRenderingMode.ADD_TO_PATH?A.tspan.setAttributeNS(null,"fill","transparent"):A.tspan.setAttributeNS(null,"fill","none"),l===_.TextRenderingMode.STROKE||l===_.TextRenderingMode.FILL_STROKE){const b=1/(A.textMatrixScale||1);this._setStrokeAttributes(A.tspan,b)}let c=A.textMatrix;A.textRise!==0&&(c=c.slice(),c[5]+=A.textRise),A.txtElement.setAttributeNS(null,"transform",`${f(c)} scale(${e(Q)}, -1)`),A.txtElement.setAttributeNS(O,"xml:space","preserve"),A.txtElement.append(A.tspan),A.txtgrp.append(A.txtElement),this._ensureTransformGroup().append(A.txtElement)}setLeadingMoveText(g,A){this.setLeading(-A),this.moveText(g,A)}addFontStyle(g){if(!g.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const A=i(g.data,g.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${g.loadedName}"; src: url(${A}); }
`}setFont(g){const A=this.current,M=this.commonObjs.get(g[0]);let H=g[1];A.font=M,this.embedFonts&&!M.missingFile&&!this.embeddedFonts[M.loadedName]&&(this.addFontStyle(M),this.embeddedFonts[M.loadedName]=M),A.fontMatrix=M.fontMatrix||_.FONT_IDENTITY_MATRIX;let N="normal";M.black?N="900":M.bold&&(N="bold");const W=M.italic?"italic":"normal";H<0?(H=-H,A.fontDirection=-1):A.fontDirection=1,A.fontSize=H,A.fontFamily=M.loadedName,A.fontWeight=N,A.fontStyle=W,A.tspan=this.svgFactory.createElement("svg:tspan"),A.tspan.setAttributeNS(null,"y",e(-A.y)),A.xcoords=[],A.ycoords=[]}endText(){const g=this.current;g.textRenderingMode&_.TextRenderingMode.ADD_TO_PATH_FLAG&&g.txtElement?.hasChildNodes()&&(g.element=g.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(g){g>0&&(this.current.lineWidth=g)}setLineCap(g){this.current.lineCap=S[g]}setLineJoin(g){this.current.lineJoin=t[g]}setMiterLimit(g){this.current.miterLimit=g}setStrokeAlpha(g){this.current.strokeAlpha=g}setStrokeRGBColor(g,A,M){this.current.strokeColor=_.Util.makeHexColor(g,A,M)}setFillAlpha(g){this.current.fillAlpha=g}setFillRGBColor(g,A,M){this.current.fillColor=_.Util.makeHexColor(g,A,M),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(g){this.current.strokeColor=this._makeColorN_Pattern(g)}setFillColorN(g){this.current.fillColor=this._makeColorN_Pattern(g)}shadingFill(g){const{width:A,height:M}=this.viewport,H=_.Util.inverseTransform(this.transformMatrix),[N,W,G,Z]=_.Util.getAxialAlignedBoundingBox([0,0,A,M],H),Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x",N),Q.setAttributeNS(null,"y",W),Q.setAttributeNS(null,"width",G-N),Q.setAttributeNS(null,"height",Z-W),Q.setAttributeNS(null,"fill",this._makeShadingPattern(g)),this.current.fillAlpha<1&&Q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Q)}_makeColorN_Pattern(g){return g[0]==="TilingPattern"?this._makeTilingPattern(g):this._makeShadingPattern(g)}_makeTilingPattern(g){const A=g[1],M=g[2],H=g[3]||_.IDENTITY_MATRIX,[N,W,G,Z]=g[4],Q=g[5],tt=g[6],st=g[7],K=`shading${v++}`,[R,m,l,c]=_.Util.normalizeRect([..._.Util.applyTransform([N,W],H),..._.Util.applyTransform([G,Z],H)]),[b,P]=_.Util.singularValueDecompose2dScale(H),T=Q*b,D=tt*P,k=this.svgFactory.createElement("svg:pattern");k.setAttributeNS(null,"id",K),k.setAttributeNS(null,"patternUnits","userSpaceOnUse"),k.setAttributeNS(null,"width",T),k.setAttributeNS(null,"height",D),k.setAttributeNS(null,"x",`${R}`),k.setAttributeNS(null,"y",`${m}`);const s=this.svg,p=this.transformMatrix,y=this.current.fillColor,E=this.current.strokeColor,C=this.svgFactory.create(l-R,c-m);if(this.svg=C,this.transformMatrix=H,st===2){const j=_.Util.makeHexColor(...A);this.current.fillColor=j,this.current.strokeColor=j}return this.executeOpTree(this.convertOpList(M)),this.svg=s,this.transformMatrix=p,this.current.fillColor=y,this.current.strokeColor=E,k.append(C.childNodes[0]),this.defs.append(k),`url(#${K})`}_makeShadingPattern(g){switch(typeof g=="string"&&(g=this.objs.get(g)),g[0]){case"RadialAxial":const A=`shading${v++}`,M=g[3];let H;switch(g[1]){case"axial":const N=g[4],W=g[5];H=this.svgFactory.createElement("svg:linearGradient"),H.setAttributeNS(null,"id",A),H.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),H.setAttributeNS(null,"x1",N[0]),H.setAttributeNS(null,"y1",N[1]),H.setAttributeNS(null,"x2",W[0]),H.setAttributeNS(null,"y2",W[1]);break;case"radial":const G=g[4],Z=g[5],Q=g[6],tt=g[7];H=this.svgFactory.createElement("svg:radialGradient"),H.setAttributeNS(null,"id",A),H.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),H.setAttributeNS(null,"cx",Z[0]),H.setAttributeNS(null,"cy",Z[1]),H.setAttributeNS(null,"r",tt),H.setAttributeNS(null,"fx",G[0]),H.setAttributeNS(null,"fy",G[1]),H.setAttributeNS(null,"fr",Q);break;default:throw new Error(`Unknown RadialAxial type: ${g[1]}`)}for(const N of M){const W=this.svgFactory.createElement("svg:stop");W.setAttributeNS(null,"offset",N[0]),W.setAttributeNS(null,"stop-color",N[1]),H.append(W)}return this.defs.append(H),`url(#${A})`;case"Mesh":return(0,_.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${g[0]}`)}}setDash(g,A){this.current.dashArray=g,this.current.dashPhase=A}constructPath(g,A){const M=this.current;let H=M.x,N=M.y,W=[],G=0;for(const Z of g)switch(Z|0){case _.OPS.rectangle:H=A[G++],N=A[G++];const Q=A[G++],tt=A[G++],st=H+Q,K=N+tt;W.push("M",e(H),e(N),"L",e(st),e(N),"L",e(st),e(K),"L",e(H),e(K),"Z");break;case _.OPS.moveTo:H=A[G++],N=A[G++],W.push("M",e(H),e(N));break;case _.OPS.lineTo:H=A[G++],N=A[G++],W.push("L",e(H),e(N));break;case _.OPS.curveTo:H=A[G+4],N=A[G+5],W.push("C",e(A[G]),e(A[G+1]),e(A[G+2]),e(A[G+3]),e(H),e(N)),G+=6;break;case _.OPS.curveTo2:W.push("C",e(H),e(N),e(A[G]),e(A[G+1]),e(A[G+2]),e(A[G+3])),H=A[G+2],N=A[G+3],G+=4;break;case _.OPS.curveTo3:H=A[G+2],N=A[G+3],W.push("C",e(A[G]),e(A[G+1]),e(H),e(N),e(H),e(N)),G+=4;break;case _.OPS.closePath:W.push("Z");break}W=W.join(" "),M.path&&g.length>0&&g[0]!==_.OPS.rectangle&&g[0]!==_.OPS.moveTo?W=M.path.getAttributeNS(null,"d")+W:(M.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(M.path)),M.path.setAttributeNS(null,"d",W),M.path.setAttributeNS(null,"fill","none"),M.element=M.path,M.setCurrentPoint(H,N)}endPath(){const g=this.current;if(g.path=null,!this.pendingClip)return;if(!g.element){this.pendingClip=null;return}const A=`clippath${u++}`,M=this.svgFactory.createElement("svg:clipPath");M.setAttributeNS(null,"id",A),M.setAttributeNS(null,"transform",f(this.transformMatrix));const H=g.element.cloneNode(!0);if(this.pendingClip==="evenodd"?H.setAttributeNS(null,"clip-rule","evenodd"):H.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,M.append(H),this.defs.append(M),g.activeClipUrl){g.clipGroup=null;for(const N of this.extraStack)N.clipGroup=null;M.setAttributeNS(null,"clip-path",g.activeClipUrl)}g.activeClipUrl=`url(#${A})`,this.tgrp=null}clip(g){this.pendingClip=g}closePath(){const g=this.current;if(g.path){const A=`${g.path.getAttributeNS(null,"d")}Z`;g.path.setAttributeNS(null,"d",A)}}setLeading(g){this.current.leading=-g}setTextRise(g){this.current.textRise=g}setTextRenderingMode(g){this.current.textRenderingMode=g}setHScale(g){this.current.textHScale=g/100}setRenderingIntent(g){}setFlatness(g){}setGState(g){for(const[A,M]of g)switch(A){case"LW":this.setLineWidth(M);break;case"LC":this.setLineCap(M);break;case"LJ":this.setLineJoin(M);break;case"ML":this.setMiterLimit(M);break;case"D":this.setDash(M[0],M[1]);break;case"RI":this.setRenderingIntent(M);break;case"FL":this.setFlatness(M);break;case"Font":this.setFont(M);break;case"CA":this.setStrokeAlpha(M);break;case"ca":this.setFillAlpha(M);break;default:(0,_.warn)(`Unimplemented graphic state operator ${A}`);break}}fill(){const g=this.current;g.element&&(g.element.setAttributeNS(null,"fill",g.fillColor),g.element.setAttributeNS(null,"fill-opacity",g.fillAlpha),this.endPath())}stroke(){const g=this.current;g.element&&(this._setStrokeAttributes(g.element),g.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(g,A=1){const M=this.current;let H=M.dashArray;A!==1&&H.length>0&&(H=H.map(function(N){return A*N})),g.setAttributeNS(null,"stroke",M.strokeColor),g.setAttributeNS(null,"stroke-opacity",M.strokeAlpha),g.setAttributeNS(null,"stroke-miterlimit",e(M.miterLimit)),g.setAttributeNS(null,"stroke-linecap",M.lineCap),g.setAttributeNS(null,"stroke-linejoin",M.lineJoin),g.setAttributeNS(null,"stroke-width",e(A*M.lineWidth)+"px"),g.setAttributeNS(null,"stroke-dasharray",H.map(e).join(" ")),g.setAttributeNS(null,"stroke-dashoffset",e(A*M.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y","0"),g.setAttributeNS(null,"width","1px"),g.setAttributeNS(null,"height","1px"),g.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(g)}paintImageXObject(g){const A=this.getObject(g);if(!A){(0,_.warn)(`Dependent image with object ID ${g} is not ready yet`);return}this.paintInlineImageXObject(A)}paintInlineImageXObject(g,A){const M=g.width,H=g.height,N=d(g,this.forceDataSchema,!!A),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",e(M)),W.setAttributeNS(null,"height",e(H)),this.current.element=W,this.clip("nonzero");const G=this.svgFactory.createElement("svg:image");G.setAttributeNS(L,"xlink:href",N),G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y",e(-H)),G.setAttributeNS(null,"width",e(M)+"px"),G.setAttributeNS(null,"height",e(H)+"px"),G.setAttributeNS(null,"transform",`scale(${e(1/M)} ${e(-1/H)})`),A?A.append(G):this._ensureTransformGroup().append(G)}paintImageMaskXObject(g){const A=this.getObject(g.data,g);if(A.bitmap){(0,_.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const M=this.current,H=A.width,N=A.height,W=M.fillColor;M.maskId=`mask${h++}`;const G=this.svgFactory.createElement("svg:mask");G.setAttributeNS(null,"id",M.maskId);const Z=this.svgFactory.createElement("svg:rect");Z.setAttributeNS(null,"x","0"),Z.setAttributeNS(null,"y","0"),Z.setAttributeNS(null,"width",e(H)),Z.setAttributeNS(null,"height",e(N)),Z.setAttributeNS(null,"fill",W),Z.setAttributeNS(null,"mask",`url(#${M.maskId})`),this.defs.append(G),this._ensureTransformGroup().append(Z),this.paintInlineImageXObject(A,G)}paintFormXObjectBegin(g,A){if(Array.isArray(g)&&g.length===6&&this.transform(g[0],g[1],g[2],g[3],g[4],g[5]),A){const M=A[2]-A[0],H=A[3]-A[1],N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x",A[0]),N.setAttributeNS(null,"y",A[1]),N.setAttributeNS(null,"width",e(M)),N.setAttributeNS(null,"height",e(H)),this.current.element=N,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(g){const A=this.svgFactory.create(g.width,g.height),M=this.svgFactory.createElement("svg:defs");A.append(M),this.defs=M;const H=this.svgFactory.createElement("svg:g");return H.setAttributeNS(null,"transform",f(g.transform)),A.append(H),this.svg=H,A}_ensureClipGroup(){if(!this.current.clipGroup){const g=this.svgFactory.createElement("svg:g");g.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(g),this.current.clipGroup=g}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}n.SVGGraphics=I}),((U,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class w{static textContent(_){const F=[],O={items:F,styles:Object.create(null)};function L(S){if(!S)return;let t=null;const i=S.name;if(i==="#text")t=S.value;else if(w.shouldBuildText(i))S?.attributes?.textContent?t=S.attributes.textContent:S.value&&(t=S.value);else return;if(t!==null&&F.push({str:t}),!!S.children)for(const d of S.children)L(d)}return L(_),O}static shouldBuildText(_){return!(_==="textarea"||_==="input"||_==="option"||_==="select")}}n.XfaText=w}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=f,n.updateTextLayer=u;var a=w(1),_=w(6);const F=1e5,O=30,L=.8,S=new Map;function t(h,v){let I;if(v&&a.FeatureTest.isOffscreenCanvasSupported)I=new OffscreenCanvas(h,h).getContext("2d",{alpha:!1});else{const x=document.createElement("canvas");x.width=x.height=h,I=x.getContext("2d",{alpha:!1})}return I}function i(h,v){const I=S.get(h);if(I)return I;const x=t(O,v);x.font=`${O}px ${h}`;const g=x.measureText("");let A=g.fontBoundingBoxAscent,M=Math.abs(g.fontBoundingBoxDescent);if(A){const N=A/(A+M);return S.set(h,N),x.canvas.width=x.canvas.height=0,N}x.strokeStyle="red",x.clearRect(0,0,O,O),x.strokeText("g",0,0);let H=x.getImageData(0,0,O,O).data;M=0;for(let N=H.length-1-3;N>=0;N-=4)if(H[N]>0){M=Math.ceil(N/4/O);break}x.clearRect(0,0,O,O),x.strokeText("A",0,O),H=x.getImageData(0,0,O,O).data,A=0;for(let N=0,W=H.length;N<W;N+=4)if(H[N]>0){A=O-Math.floor(N/4/O);break}if(x.canvas.width=x.canvas.height=0,A){const N=A/(A+M);return S.set(h,N),N}return S.set(h,L),L}function d(h,v,I){const x=document.createElement("span"),g={angle:0,canvasWidth:0,hasText:v.str!=="",hasEOL:v.hasEOL,fontSize:0};h._textDivs.push(x);const A=a.Util.transform(h._transform,v.transform);let M=Math.atan2(A[1],A[0]);const H=I[v.fontName];H.vertical&&(M+=Math.PI/2);const N=Math.hypot(A[2],A[3]),W=N*i(H.fontFamily,h._isOffscreenCanvasSupported);let G,Z;M===0?(G=A[4],Z=A[5]-W):(G=A[4]+W*Math.sin(M),Z=A[5]-W*Math.cos(M));const Q="calc(var(--scale-factor)*",tt=x.style;h._container===h._rootContainer?(tt.left=`${(100*G/h._pageWidth).toFixed(2)}%`,tt.top=`${(100*Z/h._pageHeight).toFixed(2)}%`):(tt.left=`${Q}${G.toFixed(2)}px)`,tt.top=`${Q}${Z.toFixed(2)}px)`),tt.fontSize=`${Q}${N.toFixed(2)}px)`,tt.fontFamily=H.fontFamily,g.fontSize=N,x.setAttribute("role","presentation"),x.textContent=v.str,x.dir=v.dir,h._fontInspectorEnabled&&(x.dataset.fontName=v.fontName),M!==0&&(g.angle=M*(180/Math.PI));let st=!1;if(v.str.length>1)st=!0;else if(v.str!==" "&&v.transform[0]!==v.transform[3]){const K=Math.abs(v.transform[0]),R=Math.abs(v.transform[3]);K!==R&&Math.max(K,R)/Math.min(K,R)>1.5&&(st=!0)}st&&(g.canvasWidth=H.vertical?v.height:v.width),h._textDivProperties.set(x,g),h._isReadableStream&&h._layoutText(x)}function r(h){const{div:v,scale:I,properties:x,ctx:g,prevFontSize:A,prevFontFamily:M}=h,{style:H}=v;let N="";if(x.canvasWidth!==0&&x.hasText){const{fontFamily:W}=H,{canvasWidth:G,fontSize:Z}=x;(A!==Z||M!==W)&&(g.font=`${Z*I}px ${W}`,h.prevFontSize=Z,h.prevFontFamily=W);const{width:Q}=g.measureText(v.textContent);Q>0&&(N=`scaleX(${G*I/Q})`)}x.angle!==0&&(N=`rotate(${x.angle}deg) ${N}`),N.length>0&&(H.transform=N)}function o(h){if(h._canceled)return;const v=h._textDivs,I=h._capability;if(v.length>F){I.resolve();return}if(!h._isReadableStream)for(const g of v)h._layoutText(g);I.resolve()}class e{constructor({textContentSource:v,container:I,viewport:x,textDivs:g,textDivProperties:A,textContentItemsStr:M,isOffscreenCanvasSupported:H}){this._textContentSource=v,this._isReadableStream=v instanceof ReadableStream,this._container=this._rootContainer=I,this._textDivs=g||[],this._textContentItemsStr=M||[],this._isOffscreenCanvasSupported=H,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=A||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:x.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:t(0,H)};const{pageWidth:N,pageHeight:W,pageX:G,pageY:Z}=x.rawDims;this._transform=[1,0,0,-1,-G,Z+W],this._pageWidth=N,this._pageHeight=W,(0,_.setLayerDimensions)(I,x),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(v,I){for(const x of v){if(x.str===void 0){if(x.type==="beginMarkedContentProps"||x.type==="beginMarkedContent"){const g=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),x.id!==null&&this._container.setAttribute("id",`${x.id}`),g.append(this._container)}else x.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(x.str),d(this,x,I)}}_layoutText(v){const I=this._layoutTextParams.properties=this._textDivProperties.get(v);if(this._layoutTextParams.div=v,r(this._layoutTextParams),I.hasText&&this._container.append(v),I.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this._container.append(x)}}_render(){const v=new a.PromiseCapability;let I=Object.create(null);if(this._isReadableStream){const x=()=>{this._reader.read().then(({value:g,done:A})=>{if(A){v.resolve();return}Object.assign(I,g.styles),this._processItems(g.items,I),x()},v.reject)};this._reader=this._textContentSource.getReader(),x()}else if(this._textContentSource){const{items:x,styles:g}=this._textContentSource;this._processItems(x,g),v.resolve()}else throw new Error('No "textContentSource" parameter specified.');v.promise.then(()=>{I=null,o(this)},this._capability.reject)}}n.TextLayerRenderTask=e;function f(h){!h.textContentSource&&(h.textContent||h.textContentStream)&&((0,_.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),h.textContentSource=h.textContent||h.textContentStream);const{container:v,viewport:I}=h,x=getComputedStyle(v),g=x.getPropertyValue("visibility"),A=parseFloat(x.getPropertyValue("--scale-factor"));g==="visible"&&(!A||Math.abs(A-I.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const M=new e(h);return M._render(),M}function u({container:h,viewport:v,textDivs:I,textDivProperties:x,isOffscreenCanvasSupported:g,mustRotate:A=!0,mustRescale:M=!0}){if(A&&(0,_.setLayerDimensions)(h,{rotation:v.rotation}),M){const H=t(0,g),W={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:H};for(const G of I)W.properties=x.get(G),W.div=G,r(W)}}}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var a=w(1),_=w(4),F=w(5),O=w(28),L=w(33),S=w(6),t=w(34);class i{#t;#e=!1;#i=null;#s=this.pointerup.bind(this);#a=this.pointerdown.bind(this);#r=new Map;#l=!1;#o=!1;#h=!1;#n;static _initialized=!1;constructor({uiManager:r,pageIndex:o,div:e,accessibilityManager:f,annotationLayer:u,viewport:h,l10n:v}){const I=[O.FreeTextEditor,L.InkEditor,t.StampEditor];if(!i._initialized){i._initialized=!0;for(const x of I)x.initialize(v)}r.registerEditorTypes(I),this.#n=r,this.pageIndex=o,this.div=e,this.#t=f,this.#i=u,this.viewport=h,this.#n.addLayer(this)}get isEmpty(){return this.#r.size===0}updateToolbar(r){this.#n.updateToolbar(r)}updateMode(r=this.#n.getMode()){this.#f(),r===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#n.unselectAll(),r!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",r===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",r===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(r){if(!r&&this.#n.getMode()!==a.AnnotationEditorType.INK)return;if(!r){for(const e of this.#r.values())if(e.isEmpty()){e.setInBackground();return}}this.#d({offsetX:0,offsetY:0}).setInBackground()}setEditingState(r){this.#n.setEditingState(r)}addCommands(r){this.#n.addCommands(r)}enable(){this.div.style.pointerEvents="auto";const r=new Set;for(const e of this.#r.values())e.enableEditing(),e.annotationElementId&&r.add(e.annotationElementId);if(!this.#i)return;const o=this.#i.getEditableAnnotations();for(const e of o){if(e.hide(),this.#n.isDeletedAnnotationElement(e.data.id)||r.has(e.data.id))continue;const f=this.deserialize(e);f&&(this.addOrRebuild(f),f.enableEditing())}}disable(){this.#h=!0,this.div.style.pointerEvents="none";const r=new Set;for(const o of this.#r.values()){if(o.disableEditing(),!o.annotationElementId||o.serialize()!==null){r.add(o.annotationElementId);continue}this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}if(this.#i){const o=this.#i.getEditableAnnotations();for(const e of o){const{id:f}=e.data;r.has(f)||this.#n.isDeletedAnnotationElement(f)||e.show()}}this.#f(),this.isEmpty&&(this.div.hidden=!0),this.#h=!1}getEditableAnnotation(r){return this.#i?.getEditableAnnotation(r)||null}setActiveEditor(r){this.#n.getActive()!==r&&this.#n.setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",this.#a),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#a),this.div.removeEventListener("pointerup",this.#s)}attach(r){this.#r.set(r.id,r);const{annotationElementId:o}=r;o&&this.#n.isDeletedAnnotationElement(o)&&this.#n.removeDeletedAnnotationElement(r)}detach(r){this.#r.delete(r.id),this.#t?.removePointerInTextLayer(r.contentDiv),!this.#h&&r.annotationElementId&&this.#n.addDeletedAnnotationElement(r)}remove(r){this.detach(r),this.#n.removeEditor(r),r.div.style.display="none",setTimeout(()=>{r.div.style.display="",r.div.remove(),r.isAttachedToDOM=!1,document.activeElement===document.body&&this.#n.focusMainContainer()},0),this.#o||this.addInkEditorIfNeeded(!1)}#u(r){r.parent!==this&&(r.annotationElementId&&(this.#n.addDeletedAnnotationElement(r.annotationElementId),_.AnnotationEditor.deleteAnnotationElement(r),r.annotationElementId=null),this.attach(r),r.parent?.detach(r),r.setParent(this),r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))}add(r){if(this.#u(r),this.#n.addEditor(r),this.attach(r),!r.isAttachedToDOM){const o=r.render();this.div.append(o),r.isAttachedToDOM=!0}this.moveEditorInDOM(r),r.onceAdded(),this.#n.addToAnnotationStorage(r)}moveEditorInDOM(r){this.#t?.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addUndoableEditor(r){const o=()=>{this.addOrRebuild(r)},e=()=>{r.remove()};this.addCommands({cmd:o,undo:e,mustExec:!1})}getNextId(){return this.#n.getId()}#p(r){switch(this.#n.getMode()){case a.AnnotationEditorType.FREETEXT:return new O.FreeTextEditor(r);case a.AnnotationEditorType.INK:return new L.InkEditor(r);case a.AnnotationEditorType.STAMP:return new t.StampEditor(r)}return null}deserialize(r){switch(r.annotationType??r.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return O.FreeTextEditor.deserialize(r,this,this.#n);case a.AnnotationEditorType.INK:return L.InkEditor.deserialize(r,this,this.#n);case a.AnnotationEditorType.STAMP:return t.StampEditor.deserialize(r,this,this.#n)}return null}#d(r){const o=this.getNextId(),e=this.#p({parent:this,id:o,x:r.offsetX,y:r.offsetY,uiManager:this.#n});return e&&this.add(e),e}setSelected(r){this.#n.setSelected(r)}toggleSelected(r){this.#n.toggleSelected(r)}isSelected(r){return this.#n.isSelected(r)}unselect(r){this.#n.unselect(r)}pointerup(r){const{isMac:o}=a.FeatureTest.platform;if(!(r.button!==0||r.ctrlKey&&o)&&r.target===this.div&&this.#l){if(this.#l=!1,!this.#e){this.#e=!0;return}this.#d(r)}}pointerdown(r){if(this.#l){this.#l=!1;return}const{isMac:o}=a.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&o||r.target!==this.div)return;this.#l=!0;const e=this.#n.getActive();this.#e=!e||e.isEmpty()}drop(r){const o=r.dataTransfer.getData("text/plain"),e=this.#n.getEditor(o);if(!e)return;r.preventDefault(),r.dataTransfer.dropEffect="move",this.#u(e);const f=this.div.getBoundingClientRect(),u=r.clientX-f.x,h=r.clientY-f.y;e.translate(u-e.startX,h-e.startY),this.moveEditorInDOM(e),e.div.focus()}dragover(r){r.preventDefault()}destroy(){this.#n.getActive()?.parent===this&&this.#n.setActiveEditor(null);for(const r of this.#r.values())this.#t?.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,this.#r.clear(),this.#n.removeLayer(this)}#f(){this.#o=!0;for(const r of this.#r.values())r.isEmpty()&&r.remove();this.#o=!1}render({viewport:r}){this.viewport=r,(0,S.setLayerDimensions)(this.div,r),(0,F.bindEvents)(this,this.div,["dragover","drop"]);for(const o of this.#n.getEditors(this.pageIndex))this.add(o);this.updateMode()}update({viewport:r}){this.#n.commitOrRemove(),this.viewport=r,(0,S.setLayerDimensions)(this.div,{rotation:r.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:r,pageHeight:o}=this.viewport.rawDims;return[r,o]}}n.AnnotationEditorLayer=i}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var a=w(1),_=w(5),F=w(4),O=w(29);class L extends F.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#a;#r="";#l=`${this.id}-editor`;#o;#h=null;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=L.prototype,i=o=>o.isEmpty(),d=_.AnnotationEditorUIManager.TRANSLATE_SMALL,r=_.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new _.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-d,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[d,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-d],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,d],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";constructor(t){super({...t,name:"freeTextEditor"}),this.#a=t.color||L._defaultColor||F.AnnotationEditor._defaultLineColor,this.#o=t.fontSize||L._defaultFontSize}static initialize(t){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(d=>[d,t.get(d)]));const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case a.AnnotationEditorParamsType.FREETEXT_SIZE:L._defaultFontSize=i;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:L._defaultColor=i;break}}updateParams(t,i){switch(t){case a.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(i);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:this.#u(i);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,L._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,L._defaultColor||F.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,this.#o],[a.AnnotationEditorParamsType.FREETEXT_COLOR,this.#a]]}#n(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#o)*this.parentScale),this.#o=r,this.#d()},d=this.#o;this.addCommands({cmd:()=>{i(t)},undo:()=>{i(d)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#u(t){const i=this.#a;this.addCommands({cmd:()=>{this.#a=this.editorDiv.style.color=t},undo:()=>{this.#a=this.editorDiv.style.color=i},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-L._internalPadding*t,-(L._internalPadding+this.#o)*t]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#l),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(t){super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){if(this.width){this.#g();return}this.enableEditMode(),this.editorDiv.focus()}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#p(){const t=this.editorDiv.getElementsByTagName("div");if(t.length===0)return this.editorDiv.innerText;const i=[];for(const d of t)i.push(d.innerText.replace(/\r\n?|\n/,""));return i.join(`
`)}#d(){const[t,i]=this.parentDimensions;let d;if(this.isAttachedToDOM)d=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,e=o.style.display;o.style.display="hidden",r.div.append(this.div),d=o.getBoundingClientRect(),o.remove(),o.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=d.width/t,this.height=d.height/i):(this.width=d.height/t,this.height=d.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#r,i=this.#r=this.#p().trimEnd();if(t===i)return;const d=r=>{if(this.#r=r,!r){this.remove();return}this.#f(),this.rebuild(),this.#d()};this.addCommands({cmd:()=>{d(i)},undo:()=>{d(t)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&this.enterInEditMode()}editorDivKeydown(t){L._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#l),this.enableEditing(),L._l10nPromise.get("editor_free_text2_aria_label").then(r=>this.editorDiv?.setAttribute("aria-label",r)),L._l10nPromise.get("free_text2_default_content").then(r=>this.editorDiv?.setAttribute("default-content",r)),this.editorDiv.contentEditable=!0;const{style:d}=this.editorDiv;if(d.fontSize=`calc(${this.#o}px * var(--scale-factor))`,d.color=this.#a,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:e}=this.#h;let[f,u]=this.getInitialTranslation();[f,u]=this.pageTranslationToScreen(f,u);const[h,v]=this.pageDimensions,[I,x]=this.pageTranslation;let g,A;switch(this.rotation){case 0:g=t+(e[0]-I)/h,A=i+this.height-(e[1]-x)/v;break;case 90:g=t+(e[0]-I)/h,A=i-(e[1]-x)/v,[f,u]=[u,-f];break;case 180:g=t-this.width+(e[0]-I)/h,A=i-(e[1]-x)/v,[f,u]=[-f,-u];break;case 270:g=t+(e[0]-I-this.height*v)/h,A=i+(e[1]-x-this.width*h)/v,[f,u]=[-u,f];break}this.setAt(g*r,A*o,f,u)}else this.setAt(t*r,i*o,this.width*r,this.height*o);this.#f(),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}#f(){if(this.editorDiv.replaceChildren(),!!this.#r)for(const t of this.#r.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}get contentDiv(){return this.editorDiv}static deserialize(t,i,d){let r=null;if(t instanceof O.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:f},rect:u,rotation:h,id:v},textContent:I,textPosition:x,parent:{page:{pageNumber:g}}}=t;if(!I||I.length===0)return null;r=t={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(f),fontSize:e,value:I.join(`
`),position:x,pageIndex:g-1,rect:u,rotation:h,id:v,deleted:!1}}const o=super.deserialize(t,i,d);return o.#o=t.fontSize,o.#a=a.Util.makeHexColor(...t.color),o.#r=t.value,o.annotationElementId=t.id||null,o.#h=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const i=L._internalPadding*this.parentScale,d=this.getRect(i,i),r=F.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#a),o={annotationType:a.AnnotationEditorType.FREETEXT,color:r,fontSize:this.#o,value:this.#r,pageIndex:this.pageIndex,rect:d,rotation:this.rotation};return t?o:this.annotationElementId&&!this.#c(o)?null:(o.id=this.annotationElementId,o)}#c(t){const{value:i,fontSize:d,color:r,rect:o,pageIndex:e}=this.#h;return t.value!==i||t.fontSize!==d||t.rect.some((f,u)=>Math.abs(f-o[u])>=1)||t.color.some((f,u)=>f!==r[u])||t.pageIndex!==e}#g(t=!1){if(!this.annotationElementId)return;if(this.#d(),!t&&(this.width===0||this.height===0)){setTimeout(()=>this.#g(!0),0);return}const i=L._internalPadding*this.parentScale;this.#h.rect=this.getRect(i,i)}}n.FreeTextEditor=L}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampAnnotationElement=n.InkAnnotationElement=n.FreeTextAnnotationElement=n.AnnotationLayer=void 0;var a=w(1),_=w(6),F=w(3),O=w(30),L=w(31),S=w(32);const t=1e3,i=9,d=new WeakSet;function r(k){return{width:k[2]-k[0],height:k[3]-k[1]}}class o{static create(s){switch(s.data.annotationType){case a.AnnotationType.LINK:return new f(s);case a.AnnotationType.TEXT:return new u(s);case a.AnnotationType.WIDGET:switch(s.data.fieldType){case"Tx":return new v(s);case"Btn":return s.data.radioButton?new g(s):s.data.checkBox?new x(s):new A(s);case"Ch":return new M(s);case"Sig":return new I(s)}return new h(s);case a.AnnotationType.POPUP:return new H(s);case a.AnnotationType.FREETEXT:return new W(s);case a.AnnotationType.LINE:return new G(s);case a.AnnotationType.SQUARE:return new Z(s);case a.AnnotationType.CIRCLE:return new Q(s);case a.AnnotationType.POLYLINE:return new tt(s);case a.AnnotationType.CARET:return new K(s);case a.AnnotationType.INK:return new R(s);case a.AnnotationType.POLYGON:return new st(s);case a.AnnotationType.HIGHLIGHT:return new m(s);case a.AnnotationType.UNDERLINE:return new l(s);case a.AnnotationType.SQUIGGLY:return new c(s);case a.AnnotationType.STRIKEOUT:return new b(s);case a.AnnotationType.STAMP:return new P(s);case a.AnnotationType.FILEATTACHMENT:return new T(s);default:return new e(s)}}}class e{#t=!1;constructor(s,{isRenderable:p=!1,ignoreBorder:y=!1,createQuadrilaterals:E=!1}={}){this.isRenderable=p,this.data=s.data,this.layer=s.layer,this.linkService=s.linkService,this.downloadManager=s.downloadManager,this.imageResourcesPath=s.imageResourcesPath,this.renderForms=s.renderForms,this.svgFactory=s.svgFactory,this.annotationStorage=s.annotationStorage,this.enableScripting=s.enableScripting,this.hasJSActions=s.hasJSActions,this._fieldObjects=s.fieldObjects,this.parent=s.parent,p&&(this.container=this._createContainer(y)),E&&this._createQuadrilaterals()}_createContainer(s){const{data:p,parent:{page:y,viewport:E}}=this,C=document.createElement("section");C.setAttribute("data-annotation-id",p.id),C.style.zIndex=this.parent.zIndex++,this.data.popupRef&&C.setAttribute("aria-haspopup","dialog"),p.noRotate&&C.classList.add("norotate");const{pageWidth:j,pageHeight:B,pageX:V,pageY:nt}=E.rawDims;if(!p.rect||this instanceof H){const{rotation:et}=p;return!p.hasOwnCanvas&&et!==0&&this.setRotation(et,C),C}const{width:q,height:Y}=r(p.rect),J=a.Util.normalizeRect([p.rect[0],y.view[3]-p.rect[1]+y.view[1],p.rect[2],y.view[3]-p.rect[3]+y.view[1]]);if(!s&&p.borderStyle.width>0){C.style.borderWidth=`${p.borderStyle.width}px`;const et=p.borderStyle.horizontalCornerRadius,rt=p.borderStyle.verticalCornerRadius;if(et>0||rt>0){const lt=`calc(${et}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;C.style.borderRadius=lt}else if(this instanceof g){const lt=`calc(${q}px * var(--scale-factor)) / calc(${Y}px * var(--scale-factor))`;C.style.borderRadius=lt}switch(p.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:C.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:C.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:C.style.borderBottomStyle="solid";break}const ot=p.borderColor||null;ot?(this.#t=!0,C.style.borderColor=a.Util.makeHexColor(ot[0]|0,ot[1]|0,ot[2]|0)):C.style.borderWidth=0}C.style.left=`${100*(J[0]-V)/j}%`,C.style.top=`${100*(J[1]-nt)/B}%`;const{rotation:$}=p;return p.hasOwnCanvas||$===0?(C.style.width=`${100*q/j}%`,C.style.height=`${100*Y/B}%`):this.setRotation($,C),C}setRotation(s,p=this.container){if(!this.data.rect)return;const{pageWidth:y,pageHeight:E}=this.parent.viewport.rawDims,{width:C,height:j}=r(this.data.rect);let B,V;s%180===0?(B=100*C/y,V=100*j/E):(B=100*j/y,V=100*C/E),p.style.width=`${B}%`,p.style.height=`${V}%`,p.setAttribute("data-main-rotation",(360-s)%360)}get _commonActions(){const s=(p,y,E)=>{const C=E.detail[p];E.target.style[y]=O.ColorConverters[`${C[0]}_HTML`](C.slice(1))};return(0,a.shadow)(this,"_commonActions",{display:p=>{const y=p.detail.display%2===1;this.container.style.visibility=y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:y,print:p.detail.display===0||p.detail.display===3})},print:p=>{this.annotationStorage.setValue(this.data.id,{print:p.detail.print})},hidden:p=>{this.container.style.visibility=p.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:p.detail.hidden})},focus:p=>{setTimeout(()=>p.target.focus({preventScroll:!1}),0)},userName:p=>{p.target.title=p.detail.userName},readonly:p=>{p.detail.readonly?p.target.setAttribute("readonly",""):p.target.removeAttribute("readonly")},required:p=>{this._setRequired(p.target,p.detail.required)},bgColor:p=>{s("bgColor","backgroundColor",p)},fillColor:p=>{s("fillColor","backgroundColor",p)},fgColor:p=>{s("fgColor","color",p)},textColor:p=>{s("textColor","color",p)},borderColor:p=>{s("borderColor","borderColor",p)},strokeColor:p=>{s("strokeColor","borderColor",p)},rotation:p=>{const y=p.detail.rotation;this.setRotation(y),this.annotationStorage.setValue(this.data.id,{rotation:y})}})}_dispatchEventFromSandbox(s,p){const y=this._commonActions;for(const E of Object.keys(p.detail))(s[E]||y[E])?.(p)}_setDefaultPropertiesFromJS(s){if(!this.enableScripting)return;const p=this.annotationStorage.getRawValue(this.data.id);if(!p)return;const y=this._commonActions;for(const[E,C]of Object.entries(p)){const j=y[E];if(j){const B={detail:{[E]:C},target:s};j(B),delete p[E]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:s}=this.data;if(!s)return;const[p,y,E,C]=this.data.rect;if(s.length===1){const[,{x:rt,y:ot},{x:lt,y:ct}]=s[0];if(E===rt&&C===ot&&p===lt&&y===ct)return}const{style:j}=this.container;let B;if(this.#t){const{borderColor:rt,borderWidth:ot}=j;j.borderWidth=0,B=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${rt}" stroke-width="${ot}">`],this.container.classList.add("hasBorder")}const V=E-p,nt=C-y,{svgFactory:q}=this,Y=q.createElement("svg");Y.classList.add("quadrilateralsContainer"),Y.setAttribute("width",0),Y.setAttribute("height",0);const J=q.createElement("defs");Y.append(J);const $=q.createElement("clipPath"),et=`clippath_${this.data.id}`;$.setAttribute("id",et),$.setAttribute("clipPathUnits","objectBoundingBox"),J.append($);for(const[,{x:rt,y:ot},{x:lt,y:ct}]of s){const ht=q.createElement("rect"),ut=(lt-p)/V,At=(C-ot)/nt,mt=(rt-lt)/V,Ct=(ot-ct)/nt;ht.setAttribute("x",ut),ht.setAttribute("y",At),ht.setAttribute("width",mt),ht.setAttribute("height",Ct),$.append(ht),B?.push(`<rect vector-effect="non-scaling-stroke" x="${ut}" y="${At}" width="${mt}" height="${Ct}"/>`)}this.#t&&(B.push("</g></svg>')"),j.backgroundImage=B.join("")),this.container.append(Y),this.container.style.clipPath=`url(#${et})`}_createPopup(){const{container:s,data:p}=this;s.setAttribute("aria-haspopup","dialog");const y=new H({data:{color:p.color,titleObj:p.titleObj,modificationDate:p.modificationDate,contentsObj:p.contentsObj,richText:p.richText,parentRect:p.rect,borderStyle:0,id:`popup_${p.id}`,rotation:p.rotation},parent:this.parent,elements:[this]});this.parent.div.append(y.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(s,p=null){const y=[];if(this._fieldObjects){const E=this._fieldObjects[s];if(E)for(const{page:C,id:j,exportValues:B}of E){if(C===-1||j===p)continue;const V=typeof B=="string"?B:null,nt=document.querySelector(`[data-element-id="${j}"]`);if(nt&&!d.has(nt)){(0,a.warn)(`_getElementsByName - element not allowed: ${j}`);continue}y.push({id:j,exportValue:V,domElement:nt})}return y}for(const E of document.getElementsByName(s)){const{exportValue:C}=E,j=E.getAttribute("data-element-id");j!==p&&d.has(E)&&y.push({id:j,exportValue:C,domElement:E})}return y}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const s=this.getElementsToTriggerPopup();if(Array.isArray(s))for(const p of s)p.classList.add("highlightArea");else s.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:s,data:{id:p}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:s,editId:p})})}}class f extends e{constructor(s,p=null){super(s,{isRenderable:!0,ignoreBorder:!!p?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:p}=this,y=document.createElement("a");y.setAttribute("data-element-id",s.id);let E=!1;return s.url?(p.addLinkAttributes(y,s.url,s.newWindow),E=!0):s.action?(this._bindNamedAction(y,s.action),E=!0):s.attachment?(this._bindAttachment(y,s.attachment),E=!0):s.setOCGState?(this.#e(y,s.setOCGState),E=!0):s.dest?(this._bindLink(y,s.dest),E=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(y,s),E=!0),s.resetForm?(this._bindResetFormAction(y,s.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(y,""),E=!0)),this.container.classList.add("linkAnnotation"),E&&this.container.append(y),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(s,p){s.href=this.linkService.getDestinationHash(p),s.onclick=()=>(p&&this.linkService.goToDestination(p),!1),(p||p==="")&&this.#t()}_bindNamedAction(s,p){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(p),!1),this.#t()}_bindAttachment(s,p){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,p.content,p.filename),!1),this.#t()}#e(s,p){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(p),!1),this.#t()}_bindJSAction(s,p){s.href=this.linkService.getAnchorUrl("");const y=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const E of Object.keys(p.actions)){const C=y.get(E);C&&(s[C]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p.id,name:E}}),!1))}s.onclick||(s.onclick=()=>!1),this.#t()}_bindResetFormAction(s,p){const y=s.onclick;if(y||(s.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),y||(s.onclick=()=>!1);return}s.onclick=()=>{y?.();const{fields:E,refs:C,include:j}=p,B=[];if(E.length!==0||C.length!==0){const q=new Set(C);for(const Y of E){const J=this._fieldObjects[Y]||[];for(const{id:$}of J)q.add($)}for(const Y of Object.values(this._fieldObjects))for(const J of Y)q.has(J.id)===j&&B.push(J)}else for(const q of Object.values(this._fieldObjects))B.push(...q);const V=this.annotationStorage,nt=[];for(const q of B){const{id:Y}=q;switch(nt.push(Y),q.type){case"text":{const $=q.defaultValue||"";V.setValue(Y,{value:$});break}case"checkbox":case"radiobutton":{const $=q.defaultValue===q.exportValues;V.setValue(Y,{value:$});break}case"combobox":case"listbox":{const $=q.defaultValue||"";V.setValue(Y,{value:$});break}default:continue}const J=document.querySelector(`[data-element-id="${Y}"]`);if(J){if(!d.has(J)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${Y}`);continue}}else continue;J.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:nt,name:"ResetForm"}}),!1}}}class u extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p})}render(){this.container.classList.add("textAnnotation");const s=document.createElement("img");return s.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",s.alt="[{{type}} Annotation]",s.dataset.l10nId="text_annotation_type",s.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(s),this.container}}class h extends e{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(s){this.data.hasOwnCanvas&&(s.previousSibling?.nodeName==="CANVAS"&&(s.previousSibling.hidden=!0),s.hidden=!1)}_getKeyModifier(s){const{isWin:p,isMac:y}=a.FeatureTest.platform;return p&&s.ctrlKey||y&&s.metaKey}_setEventListener(s,p,y,E){p.includes("mouse")?s.addEventListener(p,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:y,value:E(C),shift:C.shiftKey,modifier:this._getKeyModifier(C)}})}):s.addEventListener(p,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:y,value:E(C)}})})}_setEventListeners(s,p,y){for(const[E,C]of p)(C==="Action"||this.data.actions?.[C])&&this._setEventListener(s,E,C,y)}_setBackgroundColor(s){const p=this.data.backgroundColor||null;s.style.backgroundColor=p===null?"transparent":a.Util.makeHexColor(p[0],p[1],p[2])}_setTextStyle(s){const p=["left","center","right"],{fontColor:y}=this.data.defaultAppearanceData,E=this.data.defaultAppearanceData.fontSize||i,C=s.style;let j;const B=2,V=nt=>Math.round(10*nt)/10;if(this.data.multiLine){const nt=Math.abs(this.data.rect[3]-this.data.rect[1]-B),q=Math.round(nt/(a.LINE_FACTOR*E))||1,Y=nt/q;j=Math.min(E,V(Y/a.LINE_FACTOR))}else{const nt=Math.abs(this.data.rect[3]-this.data.rect[1]-B);j=Math.min(E,V(nt/a.LINE_FACTOR))}C.fontSize=`calc(${j}px * var(--scale-factor))`,C.color=a.Util.makeHexColor(y[0],y[1],y[2]),this.data.textAlignment!==null&&(C.textAlign=p[this.data.textAlignment])}_setRequired(s,p){p?s.setAttribute("required",!0):s.removeAttribute("required"),s.setAttribute("aria-required",p)}}class v extends h{constructor(s){const p=s.renderForms||!s.data.hasAppearance&&!!s.data.fieldValue;super(s,{isRenderable:p})}setPropertyOnSiblings(s,p,y,E){const C=this.annotationStorage;for(const j of this._getElementsByName(s.name,s.id))j.domElement&&(j.domElement[p]=y),C.setValue(j.id,{[E]:y})}render(){const s=this.annotationStorage,p=this.data.id;this.container.classList.add("textWidgetAnnotation");let y=null;if(this.renderForms){const E=s.getValue(p,{value:this.data.fieldValue});let C=E.value||"";const j=s.getValue(p,{charLimit:this.data.maxLen}).charLimit;j&&C.length>j&&(C=C.slice(0,j));let B=E.formattedValue||this.data.textContent?.join(`
`)||null;B&&this.data.comb&&(B=B.replaceAll(/\s+/g,""));const V={userValue:C,formattedValue:B,lastCommittedValue:null,commitKey:1};this.data.multiLine?(y=document.createElement("textarea"),y.textContent=B??C,this.data.doNotScroll&&(y.style.overflowY="hidden")):(y=document.createElement("input"),y.type="text",y.setAttribute("value",B??C),this.data.doNotScroll&&(y.style.overflowX="hidden")),this.data.hasOwnCanvas&&(y.hidden=!0),d.add(y),y.setAttribute("data-element-id",p),y.disabled=this.data.readOnly,y.name=this.data.baseFieldName||this.data.fieldName,y.tabIndex=t,this._setRequired(y,this.data.required),j&&(y.maxLength=j),y.addEventListener("input",q=>{s.setValue(p,{value:q.target.value}),this.setPropertyOnSiblings(y,"value",q.target.value,"value"),V.formattedValue=null}),y.addEventListener("resetform",q=>{const Y=this.data.defaultFieldValue??"";y.value=V.userValue=Y,V.formattedValue=null});let nt=q=>{const{formattedValue:Y}=V;Y!=null&&(q.target.value=Y),q.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){y.addEventListener("focus",Y=>{const{target:J}=Y;V.userValue&&(J.value=V.userValue),V.lastCommittedValue=J.value,V.commitKey=1}),y.addEventListener("updatefromsandbox",Y=>{this.showElementAndHideCanvas(Y.target);const J={value($){V.userValue=$.detail.value??"",s.setValue(p,{value:V.userValue.toString()}),$.target.value=V.userValue},formattedValue($){const{formattedValue:et}=$.detail;V.formattedValue=et,et!=null&&$.target!==document.activeElement&&($.target.value=et),s.setValue(p,{formattedValue:et})},selRange($){$.target.setSelectionRange(...$.detail.selRange)},charLimit:$=>{const{charLimit:et}=$.detail,{target:rt}=$;if(et===0){rt.removeAttribute("maxLength");return}rt.setAttribute("maxLength",et);let ot=V.userValue;!ot||ot.length<=et||(ot=ot.slice(0,et),rt.value=V.userValue=ot,s.setValue(p,{value:ot}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:ot,willCommit:!0,commitKey:1,selStart:rt.selectionStart,selEnd:rt.selectionEnd}}))}};this._dispatchEventFromSandbox(J,Y)}),y.addEventListener("keydown",Y=>{V.commitKey=1;let J=-1;if(Y.key==="Escape"?J=0:Y.key==="Enter"&&!this.data.multiLine?J=2:Y.key==="Tab"&&(V.commitKey=3),J===-1)return;const{value:$}=Y.target;V.lastCommittedValue!==$&&(V.lastCommittedValue=$,V.userValue=$,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:$,willCommit:!0,commitKey:J,selStart:Y.target.selectionStart,selEnd:Y.target.selectionEnd}}))});const q=nt;nt=null,y.addEventListener("blur",Y=>{if(!Y.relatedTarget)return;const{value:J}=Y.target;V.userValue=J,V.lastCommittedValue!==J&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:J,willCommit:!0,commitKey:V.commitKey,selStart:Y.target.selectionStart,selEnd:Y.target.selectionEnd}}),q(Y)}),this.data.actions?.Keystroke&&y.addEventListener("beforeinput",Y=>{V.lastCommittedValue=null;const{data:J,target:$}=Y,{value:et,selectionStart:rt,selectionEnd:ot}=$;let lt=rt,ct=ot;switch(Y.inputType){case"deleteWordBackward":{const ht=et.substring(0,rt).match(/\w*[^\w]*$/);ht&&(lt-=ht[0].length);break}case"deleteWordForward":{const ht=et.substring(rt).match(/^[^\w]*\w*/);ht&&(ct+=ht[0].length);break}case"deleteContentBackward":rt===ot&&(lt-=1);break;case"deleteContentForward":rt===ot&&(ct+=1);break}Y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:et,change:J||"",willCommit:!1,selStart:lt,selEnd:ct}})}),this._setEventListeners(y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Y=>Y.target.value)}if(nt&&y.addEventListener("blur",nt),this.data.comb){const Y=(this.data.rect[2]-this.data.rect[0])/j;y.classList.add("comb"),y.style.letterSpacing=`calc(${Y}px * var(--scale-factor) - 1ch)`}}else y=document.createElement("div"),y.textContent=this.data.fieldValue,y.style.verticalAlign="middle",y.style.display="table-cell";return this._setTextStyle(y),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.append(y),this.container}}class I extends h{constructor(s){super(s,{isRenderable:!!s.data.hasOwnCanvas})}}class x extends h{constructor(s){super(s,{isRenderable:s.renderForms})}render(){const s=this.annotationStorage,p=this.data,y=p.id;let E=s.getValue(y,{value:p.exportValue===p.fieldValue}).value;typeof E=="string"&&(E=E!=="Off",s.setValue(y,{value:E})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const C=document.createElement("input");return d.add(C),C.setAttribute("data-element-id",y),C.disabled=p.readOnly,this._setRequired(C,this.data.required),C.type="checkbox",C.name=p.baseFieldName||p.fieldName,E&&C.setAttribute("checked",!0),C.setAttribute("exportValue",p.exportValue),C.tabIndex=t,C.addEventListener("change",j=>{const{name:B,checked:V}=j.target;for(const nt of this._getElementsByName(B,y)){const q=V&&nt.exportValue===p.exportValue;nt.domElement&&(nt.domElement.checked=q),s.setValue(nt.id,{value:q})}s.setValue(y,{value:V})}),C.addEventListener("resetform",j=>{const B=p.defaultFieldValue||"Off";j.target.checked=B===p.exportValue}),this.enableScripting&&this.hasJSActions&&(C.addEventListener("updatefromsandbox",j=>{const B={value(V){V.target.checked=V.detail.value!=="Off",s.setValue(y,{value:V.target.checked})}};this._dispatchEventFromSandbox(B,j)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class g extends h{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const s=this.annotationStorage,p=this.data,y=p.id;let E=s.getValue(y,{value:p.fieldValue===p.buttonValue}).value;typeof E=="string"&&(E=E!==p.buttonValue,s.setValue(y,{value:E}));const C=document.createElement("input");if(d.add(C),C.setAttribute("data-element-id",y),C.disabled=p.readOnly,this._setRequired(C,this.data.required),C.type="radio",C.name=p.baseFieldName||p.fieldName,E&&C.setAttribute("checked",!0),C.tabIndex=t,C.addEventListener("change",j=>{const{name:B,checked:V}=j.target;for(const nt of this._getElementsByName(B,y))s.setValue(nt.id,{value:!1});s.setValue(y,{value:V})}),C.addEventListener("resetform",j=>{const B=p.defaultFieldValue;j.target.checked=B!=null&&B===p.buttonValue}),this.enableScripting&&this.hasJSActions){const j=p.buttonValue;C.addEventListener("updatefromsandbox",B=>{const V={value:nt=>{const q=j===nt.detail.value;for(const Y of this._getElementsByName(nt.target.name)){const J=q&&Y.id===y;Y.domElement&&(Y.domElement.checked=J),s.setValue(Y.id,{value:J})}}};this._dispatchEventFromSandbox(V,B)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)}return this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class A extends f{constructor(s){super(s,{ignoreBorder:s.data.hasAppearance})}render(){const s=super.render();s.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(s.title=this.data.alternativeText);const p=s.lastChild;return this.enableScripting&&this.hasJSActions&&p&&(this._setDefaultPropertiesFromJS(p),p.addEventListener("updatefromsandbox",y=>{this._dispatchEventFromSandbox({},y)})),s}}class M extends h{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const s=this.annotationStorage,p=this.data.id,y=s.getValue(p,{value:this.data.fieldValue}),E=document.createElement("select");d.add(E),E.setAttribute("data-element-id",p),E.disabled=this.data.readOnly,this._setRequired(E,this.data.required),E.name=this.data.baseFieldName||this.data.fieldName,E.tabIndex=t;let C=this.data.combo&&this.data.options.length>0;this.data.combo||(E.size=this.data.options.length,this.data.multiSelect&&(E.multiple=!0)),E.addEventListener("resetform",q=>{const Y=this.data.defaultFieldValue;for(const J of E.options)J.selected=J.value===Y});for(const q of this.data.options){const Y=document.createElement("option");Y.textContent=q.displayValue,Y.value=q.exportValue,y.value.includes(q.exportValue)&&(Y.setAttribute("selected",!0),C=!1),E.append(Y)}let j=null;if(C){const q=document.createElement("option");q.value=" ",q.setAttribute("hidden",!0),q.setAttribute("selected",!0),E.prepend(q),j=()=>{q.remove(),E.removeEventListener("input",j),j=null},E.addEventListener("input",j)}const B=q=>{const Y=q?"value":"textContent",{options:J,multiple:$}=E;return $?Array.prototype.filter.call(J,et=>et.selected).map(et=>et[Y]):J.selectedIndex===-1?null:J[J.selectedIndex][Y]};let V=B(!1);const nt=q=>{const Y=q.target.options;return Array.prototype.map.call(Y,J=>({displayValue:J.textContent,exportValue:J.value}))};return this.enableScripting&&this.hasJSActions?(E.addEventListener("updatefromsandbox",q=>{const Y={value(J){j?.();const $=J.detail.value,et=new Set(Array.isArray($)?$:[$]);for(const rt of E.options)rt.selected=et.has(rt.value);s.setValue(p,{value:B(!0)}),V=B(!1)},multipleSelection(J){E.multiple=!0},remove(J){const $=E.options,et=J.detail.remove;$[et].selected=!1,E.remove(et),$.length>0&&Array.prototype.findIndex.call($,ot=>ot.selected)===-1&&($[0].selected=!0),s.setValue(p,{value:B(!0),items:nt(J)}),V=B(!1)},clear(J){for(;E.length!==0;)E.remove(0);s.setValue(p,{value:null,items:[]}),V=B(!1)},insert(J){const{index:$,displayValue:et,exportValue:rt}=J.detail.insert,ot=E.children[$],lt=document.createElement("option");lt.textContent=et,lt.value=rt,ot?ot.before(lt):E.append(lt),s.setValue(p,{value:B(!0),items:nt(J)}),V=B(!1)},items(J){const{items:$}=J.detail;for(;E.length!==0;)E.remove(0);for(const et of $){const{displayValue:rt,exportValue:ot}=et,lt=document.createElement("option");lt.textContent=rt,lt.value=ot,E.append(lt)}E.options.length>0&&(E.options[0].selected=!0),s.setValue(p,{value:B(!0),items:nt(J)}),V=B(!1)},indices(J){const $=new Set(J.detail.indices);for(const et of J.target.options)et.selected=$.has(et.index);s.setValue(p,{value:B(!0)}),V=B(!1)},editable(J){J.target.disabled=!J.detail.editable}};this._dispatchEventFromSandbox(Y,q)}),E.addEventListener("input",q=>{const Y=B(!0);s.setValue(p,{value:Y}),q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:V,changeEx:Y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(E,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],q=>q.target.value)):E.addEventListener("input",function(q){s.setValue(p,{value:B(!0)})}),this.data.combo&&this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class H extends e{constructor(s){const{data:p,elements:y}=s,E=!!(p.titleObj?.str||p.contentsObj?.str||p.richText?.str);super(s,{isRenderable:E}),this.elements=y}render(){this.container.classList.add("popupAnnotation");const s=new N({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),p=[];for(const y of this.elements)y.popup=s,p.push(y.data.id),y.addHighlightArea();return this.container.setAttribute("aria-controls",p.join(",")),this.container}}class N{#t=null;#e=this.#v.bind(this);#i=this.#_.bind(this);#s=this.#b.bind(this);#a=null;#r=null;#l=null;#o=null;#h=null;#n=null;#u=!1;#p=null;#d=null;#f=null;#c=null;#g=!1;constructor({container:s,color:p,elements:y,titleObj:E,modificationDate:C,contentsObj:j,richText:B,parent:V,rect:nt,parentRect:q,open:Y}){this.#r=s,this.#c=E,this.#l=j,this.#f=B,this.#h=V,this.#a=p,this.#d=nt,this.#n=q,this.#o=y;const J=_.PDFDateString.toDateObject(C);J&&(this.#t=V.l10n.get("annotation_date_string",{date:J.toLocaleDateString(),time:J.toLocaleTimeString()})),this.trigger=y.flatMap($=>$.getElementsToTriggerPopup());for(const $ of this.trigger)$.addEventListener("click",this.#s),$.addEventListener("mouseenter",this.#i),$.addEventListener("mouseleave",this.#e);this.#r.hidden=!0,Y&&this.#b()}render(){if(this.#p)return;const{page:{view:s},viewport:{rawDims:{pageWidth:p,pageHeight:y,pageX:E,pageY:C}}}=this.#h,j=this.#p=document.createElement("div");if(j.className="popup",this.#a){const ht=j.style.outlineColor=a.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?j.style.backgroundColor=`color-mix(in srgb, ${ht} 30%, white)`:j.style.backgroundColor=a.Util.makeHexColor(...this.#a.map(At=>Math.floor(.7*(255-At)+At)))}const B=document.createElement("span");B.className="header";const V=document.createElement("h1");if(B.append(V),{dir:V.dir,str:V.textContent}=this.#c,j.append(B),this.#t){const ht=document.createElement("span");ht.classList.add("popupDate"),this.#t.then(ut=>{ht.textContent=ut}),B.append(ht)}const nt=this.#l,q=this.#f;if(q?.str&&(!nt?.str||nt.str===q.str))S.XfaLayer.render({xfaHtml:q.html,intent:"richText",div:j}),j.lastChild.classList.add("richText","popupContent");else{const ht=this._formatContents(nt);j.append(ht)}let Y=!!this.#n,J=Y?this.#n:this.#d;for(const ht of this.#o)if(!J||a.Util.intersect(ht.data.rect,J)!==null){J=ht.data.rect,Y=!0;break}const $=a.Util.normalizeRect([J[0],s[3]-J[1]+s[1],J[2],s[3]-J[3]+s[1]]),rt=Y?J[2]-J[0]+5:0,ot=$[0]+rt,lt=$[1],{style:ct}=this.#r;ct.left=`${100*(ot-E)/p}%`,ct.top=`${100*(lt-C)/y}%`,this.#r.append(j)}_formatContents({str:s,dir:p}){const y=document.createElement("p");y.classList.add("popupContent"),y.dir=p;const E=s.split(/(?:\r\n?|\n)/);for(let C=0,j=E.length;C<j;++C){const B=E[C];y.append(document.createTextNode(B)),C<j-1&&y.append(document.createElement("br"))}return y}#b(){this.#u=!this.#u,this.#u?(this.#_(),this.#r.addEventListener("click",this.#s)):(this.#v(),this.#r.removeEventListener("click",this.#s))}#_(){this.#p||this.render(),this.isVisible?this.#u&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#v(){this.#r.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#r.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class W extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0}),this.textContent=s.data.textContent,this.textPosition=s.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const s=document.createElement("div");s.classList.add("annotationTextContent"),s.setAttribute("role","comment");for(const p of this.textContent){const y=document.createElement("span");y.textContent=p,s.append(y)}this.container.append(s)}return this.data.popupRef||this._createPopup(),this._editOnDoubleClick(),this.container}}n.FreeTextAnnotationElement=W;class G extends e{#t=null;constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:p,height:y}=r(s.rect),E=this.svgFactory.create(p,y,!0),C=this.#t=this.svgFactory.createElement("svg:line");return C.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),C.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),C.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),C.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),C.setAttribute("stroke-width",s.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","transparent"),E.append(C),this.container.append(E),s.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Z extends e{#t=null;constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:p,height:y}=r(s.rect),E=this.svgFactory.create(p,y,!0),C=s.borderStyle.width,j=this.#t=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",C/2),j.setAttribute("y",C/2),j.setAttribute("width",p-C),j.setAttribute("height",y-C),j.setAttribute("stroke-width",C||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),E.append(j),this.container.append(E),s.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q extends e{#t=null;constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:p,height:y}=r(s.rect),E=this.svgFactory.create(p,y,!0),C=s.borderStyle.width,j=this.#t=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",p/2),j.setAttribute("cy",y/2),j.setAttribute("rx",p/2-C/2),j.setAttribute("ry",y/2-C/2),j.setAttribute("stroke-width",C||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),E.append(j),this.container.append(E),s.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class tt extends e{#t=null;constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:p,height:y}=r(s.rect),E=this.svgFactory.create(p,y,!0);let C=[];for(const B of s.vertices){const V=B.x-s.rect[0],nt=s.rect[3]-B.y;C.push(V+","+nt)}C=C.join(" ");const j=this.#t=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",C),j.setAttribute("stroke-width",s.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),E.append(j),this.container.append(E),s.popupRef||this._createPopup(j,s),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class st extends tt{constructor(s){super(s),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class R extends e{#t=[];constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:p,height:y}=r(s.rect),E=this.svgFactory.create(p,y,!0);for(const C of s.inkLists){let j=[];for(const V of C){const nt=V.x-s.rect[0],q=s.rect[3]-V.y;j.push(`${nt},${q}`)}j=j.join(" ");const B=this.svgFactory.createElement(this.svgElementName);this.#t.push(B),B.setAttribute("points",j),B.setAttribute("stroke-width",s.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),s.popupRef||this._createPopup(B,s),E.append(B)}return this.container.append(E),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}n.InkAnnotationElement=R;class m extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class l extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class c extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class b extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class P extends e{constructor(s){const p=!!(s.data.popupRef||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:p,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}n.StampAnnotationElement=P;class T extends e{#t=null;constructor(s){super(s,{isRenderable:!0});const{filename:p,content:y}=this.data.file;this.filename=(0,_.getFilenameFromUrl)(p,!0),this.content=y,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:p,content:y})}render(){this.container.classList.add("fileAttachmentAnnotation");let s;return this.data.hasAppearance?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),s.classList.add("popupTriggerArea"),s.addEventListener("dblclick",this._download.bind(this)),this.#t=s,!this.data.popupRef&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(),this.container.append(s),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class D{#t=null;#e=null;#i=new Map;constructor({div:s,accessibilityManager:p,annotationCanvasMap:y,l10n:E,page:C,viewport:j}){this.div=s,this.#t=p,this.#e=y,this.l10n=E,this.page=C,this.viewport=j,this.zIndex=0,this.l10n||=L.NullL10n}#s(s,p){const y=s.firstChild||s;y.id=`${_.AnnotationPrefix}${p}`,this.div.append(s),this.#t?.moveElementInDOM(this.div,s,y,!1)}async render(s){const{annotations:p}=s,y=this.div;(0,_.setLayerDimensions)(y,this.viewport);const E=new Map,C={data:null,layer:y,linkService:s.linkService,downloadManager:s.downloadManager,imageResourcesPath:s.imageResourcesPath||"",renderForms:s.renderForms!==!1,svgFactory:new _.DOMSVGFactory,annotationStorage:s.annotationStorage||new F.AnnotationStorage,enableScripting:s.enableScripting===!0,hasJSActions:s.hasJSActions,fieldObjects:s.fieldObjects,parent:this,elements:null};for(const j of p){if(j.noHTML)continue;const B=j.annotationType===a.AnnotationType.POPUP;if(B){const q=E.get(j.id);if(!q)continue;C.elements=q}else{const{width:q,height:Y}=r(j.rect);if(q<=0||Y<=0)continue}C.data=j;const V=o.create(C);if(!V.isRenderable)continue;if(!B&&j.popupRef){const q=E.get(j.popupRef);q?q.push(V):E.set(j.popupRef,[V])}V.annotationEditorType>0&&this.#i.set(V.data.id,V);const nt=V.render();j.hidden&&(nt.style.visibility="hidden"),this.#s(nt,j.id)}this.#a(),await this.l10n.translate(y)}update({viewport:s}){const p=this.div;this.viewport=s,(0,_.setLayerDimensions)(p,{rotation:s.rotation}),this.#a(),p.hidden=!1}#a(){if(!this.#e)return;const s=this.div;for(const[p,y]of this.#e){const E=s.querySelector(`[data-annotation-id="${p}"]`);if(!E)continue;const{firstChild:C}=E;C?C.nodeName==="CANVAS"?C.replaceWith(y):C.before(y):E.append(y)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(s){return this.#i.get(s)}}n.AnnotationLayer=D}),((U,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function w(_){return Math.floor(Math.max(0,Math.min(1,_))*255).toString(16).padStart(2,"0")}class a{static CMYK_G([F,O,L,S]){return["G",1-Math.min(1,.3*F+.59*L+.11*O+S)]}static G_CMYK([F]){return["CMYK",0,0,0,1-F]}static G_RGB([F]){return["RGB",F,F,F]}static G_HTML([F]){const O=w(F);return`#${O}${O}${O}`}static RGB_G([F,O,L]){return["G",.3*F+.59*O+.11*L]}static RGB_HTML([F,O,L]){const S=w(F),t=w(O),i=w(L);return`#${S}${t}${i}`}static T_HTML(){return"#00000000"}static CMYK_RGB([F,O,L,S]){return["RGB",1-Math.min(1,F+S),1-Math.min(1,L+S),1-Math.min(1,O+S)]}static CMYK_HTML(F){const O=this.CMYK_RGB(F).slice(1);return this.RGB_HTML(O)}static RGB_CMYK([F,O,L]){const S=1-F,t=1-O,i=1-L,d=Math.min(S,t,i);return["CMYK",S,t,i,d]}}n.ColorConverters=a}),((U,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NullL10n=void 0,n.getL10nFallback=a;const w={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};w.print_progress_percent="{{progress}}%";function a(O,L){switch(O){case"find_match_count":O=`find_match_count[${L.total===1?"one":"other"}]`;break;case"find_match_count_limit":O=`find_match_count_limit[${L.limit===1?"one":"other"}]`;break}return w[O]||""}function _(O,L){return L?O.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(S,t)=>t in L?L[t]:"{{"+t+"}}"):O}const F={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(O,L=null,S=a(O,L)){return _(S,L)},async translate(O){}};n.NullL10n=F}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var a=w(25);class _{static setupStorage(O,L,S,t,i){const d=t.getValue(L,{value:null});switch(S.name){case"textarea":if(d.value!==null&&(O.textContent=d.value),i==="print")break;O.addEventListener("input",r=>{t.setValue(L,{value:r.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(d.value===S.attributes.xfaOn?O.setAttribute("checked",!0):d.value===S.attributes.xfaOff&&O.removeAttribute("checked"),i==="print")break;O.addEventListener("change",r=>{t.setValue(L,{value:r.target.checked?r.target.getAttribute("xfaOn"):r.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&O.setAttribute("value",d.value),i==="print")break;O.addEventListener("input",r=>{t.setValue(L,{value:r.target.value})})}break;case"select":if(d.value!==null){O.setAttribute("value",d.value);for(const r of S.children)r.attributes.value===d.value?r.attributes.selected=!0:r.attributes.hasOwnProperty("selected")&&delete r.attributes.selected}O.addEventListener("input",r=>{const o=r.target.options,e=o.selectedIndex===-1?"":o[o.selectedIndex].value;t.setValue(L,{value:e})});break}}static setAttributes({html:O,element:L,storage:S=null,intent:t,linkService:i}){const{attributes:d}=L,r=O instanceof HTMLAnchorElement;d.type==="radio"&&(d.name=`${d.name}-${t}`);for(const[o,e]of Object.entries(d))if(e!=null)switch(o){case"class":e.length&&O.setAttribute(o,e.join(" "));break;case"dataId":break;case"id":O.setAttribute("data-element-id",e);break;case"style":Object.assign(O.style,e);break;case"textContent":O.textContent=e;break;default:(!r||o!=="href"&&o!=="newWindow")&&O.setAttribute(o,e)}r&&i.addLinkAttributes(O,d.href,d.newWindow),S&&d.dataId&&this.setupStorage(O,d.dataId,L,S)}static render(O){const L=O.annotationStorage,S=O.linkService,t=O.xfaHtml,i=O.intent||"display",d=document.createElement(t.name);t.attributes&&this.setAttributes({html:d,element:t,intent:i,linkService:S});const r=[[t,-1,d]],o=O.div;if(o.append(d),O.viewport){const f=`matrix(${O.viewport.transform.join(",")})`;o.style.transform=f}i!=="richText"&&o.setAttribute("class","xfaLayer xfaFont");const e=[];for(;r.length>0;){const[f,u,h]=r.at(-1);if(u+1===f.children.length){r.pop();continue}const v=f.children[++r.at(-1)[1]];if(v===null)continue;const{name:I}=v;if(I==="#text"){const g=document.createTextNode(v.value);e.push(g),h.append(g);continue}const x=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,I):document.createElement(I);if(h.append(x),v.attributes&&this.setAttributes({html:x,element:v,storage:L,intent:i,linkService:S}),v.children&&v.children.length>0)r.push([v,-1,x]);else if(v.value){const g=document.createTextNode(v.value);a.XfaText.shouldBuildText(I)&&e.push(g),x.append(g)}}for(const f of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:e}}static update(O){const L=`matrix(${O.viewport.transform.join(",")})`;O.div.style.transform=L,O.div.hidden=!1}}n.XfaLayer=_}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0;var a=w(1),_=w(4),F=w(29),O=w(5);class L extends _.AnnotationEditor{#t=0;#e=0;#i=this.canvasContextMenu.bind(this);#s=this.canvasPointermove.bind(this);#a=this.canvasPointerleave.bind(this);#r=this.canvasPointerup.bind(this);#l=this.canvasPointerdown.bind(this);#o=new Path2D;#h=!1;#n=!1;#u=!1;#p=null;#d=0;#f=0;#c=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(i=>[i,t.get(i)]))}static updateDefaultParams(t,i){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:L._defaultThickness=i;break;case a.AnnotationEditorParamsType.INK_COLOR:L._defaultColor=i;break;case a.AnnotationEditorParamsType.INK_OPACITY:L._defaultOpacity=i/100;break}}updateParams(t,i){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:this.#g(i);break;case a.AnnotationEditorParamsType.INK_COLOR:this.#b(i);break;case a.AnnotationEditorParamsType.INK_OPACITY:this.#_(i);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,L._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,L._defaultColor||_.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(L._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||L._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||L._defaultColor||_.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??L._defaultOpacity))]]}#g(t){const i=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#F()},undo:()=>{this.thickness=i,this.#F()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#b(t){const i=this.color;this.addCommands({cmd:()=>{this.color=t,this.#A()},undo:()=>{this.color=i,this.#A()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#_(t){t/=100;const i=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#A()},undo:()=>{this.opacity=i,this.#A()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#w(),this.#k()),this.isAttachedToDOM||(this.parent.add(this),this.#E()),this.#F())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#p.disconnect(),this.#p=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,i]=this.parentDimensions,d=this.width*t,r=this.height*i;this.setDimensions(d,r)}enableEditMode(){this.#h||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#l))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#l))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#v(){const{parentRotation:t,parentDimensions:[i,d]}=this;switch(t){case 90:return[0,d,d,i];case 180:return[i,d,i,d];case 270:return[i,0,d,i];default:return[0,0,i,d]}}#P(){const{ctx:t,color:i,opacity:d,thickness:r,parentScale:o,scaleFactor:e}=this;t.lineWidth=r*o/e,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${i}${(0,O.opacityToHex)(d)}`}#M(t,i){this.canvas.addEventListener("contextmenu",this.#i),this.canvas.addEventListener("pointerleave",this.#a),this.canvas.addEventListener("pointermove",this.#s),this.canvas.addEventListener("pointerup",this.#r),this.canvas.removeEventListener("pointerdown",this.#l),this.isEditing=!0,this.#u||(this.#u=!0,this.#E(),this.thickness||=L._defaultThickness,this.color||=L._defaultColor||_.AnnotationEditor._defaultLineColor,this.opacity??=L._defaultOpacity),this.currentPath.push([t,i]),this.#n=!1,this.#P(),this.#c=()=>{this.#O(),this.#c&&window.requestAnimationFrame(this.#c)},window.requestAnimationFrame(this.#c)}#x(t,i){const[d,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===d&&i===r)return;const o=this.currentPath;let e=this.#o;if(o.push([t,i]),this.#n=!0,o.length<=2){e.moveTo(...o[0]),e.lineTo(t,i);return}o.length===3&&(this.#o=e=new Path2D,e.moveTo(...o[0])),this.#S(e,...o.at(-3),...o.at(-2),t,i)}#I(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#o.lineTo(...t)}#D(t,i){this.#c=null,t=Math.min(Math.max(t,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),this.#x(t,i),this.#I();let d;if(this.currentPath.length!==1)d=this.#C();else{const u=[t,i];d=[[u,u.slice(),u.slice(),u]]}const r=this.#o,o=this.currentPath;this.currentPath=[],this.#o=new Path2D;const e=()=>{this.allRawPaths.push(o),this.paths.push(d),this.bezierPath2D.push(r),this.rebuild()},f=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#w(),this.#k()),this.#F())};this.addCommands({cmd:e,undo:f,mustExec:!0})}#O(){if(!this.#n)return;this.#n=!1;const t=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),d=i.map(e=>e[0]),r=i.map(e=>e[1]);Math.min(...d)-t,Math.max(...d)+t,Math.min(...r)-t,Math.max(...r)+t;const{ctx:o}=this;o.save(),o.clearRect(0,0,this.canvas.width,this.canvas.height);for(const e of this.bezierPath2D)o.stroke(e);o.stroke(this.#o),o.restore()}#S(t,i,d,r,o,e,f){const u=(i+r)/2,h=(d+o)/2,v=(r+e)/2,I=(o+f)/2;t.bezierCurveTo(u+2*(r-u)/3,h+2*(o-h)/3,v+2*(r-v)/3,I+2*(o-I)/3,v,I)}#C(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const i=[];let d,[r,o]=t[0];for(d=1;d<t.length-2;d++){const[x,g]=t[d],[A,M]=t[d+1],H=(x+A)/2,N=(g+M)/2,W=[r+2*(x-r)/3,o+2*(g-o)/3],G=[H+2*(x-H)/3,N+2*(g-N)/3];i.push([[r,o],W,G,[H,N]]),[r,o]=[H,N]}const[e,f]=t[d],[u,h]=t[d+1],v=[r+2*(e-r)/3,o+2*(f-o)/3],I=[u+2*(e-u)/3,h+2*(f-h)/3];return i.push([[r,o],v,I,[u,h]]),i}#A(){if(this.isEmpty()){this.#y();return}this.#P();const{canvas:t,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),this.#y();for(const d of this.bezierPath2D)i.stroke(d)}commit(){this.#h||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#h=!0,this.div.classList.add("disabled"),this.#F(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(t){super.focusin(t),this.enableEditMode()}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#h||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#M(t.offsetX,t.offsetY))}canvasContextMenu(t){t.preventDefault()}canvasPointermove(t){t.preventDefault(),this.#x(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#L(t)}canvasPointerleave(t){this.#L(t)}#L(t){this.canvas.removeEventListener("pointerleave",this.#a),this.canvas.removeEventListener("pointermove",this.#s),this.canvas.removeEventListener("pointerup",this.#r),this.canvas.addEventListener("pointerdown",this.#l),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",this.#i)},10),this.#D(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#w(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",L._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#k(){this.#p=new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)}),this.#p.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#h}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),L._l10nPromise.get("editor_ink2_aria_label").then(f=>this.div?.setAttribute("aria-label",f));const[d,r,o,e]=this.#v();if(this.setAt(d,r,0,0),this.setDims(o,e),this.#w(),this.width){const[f,u]=this.parentDimensions;this.setAspectRatio(this.width*f,this.height*u),this.setAt(t*f,i*u,this.width*f,this.height*u),this.#u=!0,this.#E(),this.setDims(this.width*f,this.height*u),this.#A(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#k(),this.div}#E(){if(!this.#u)return;const[t,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*i),this.#y()}setDimensions(t,i){const d=Math.round(t),r=Math.round(i);if(this.#d===d&&this.#f===r)return;this.#d=d,this.#f=r,this.canvas.style.visibility="hidden";const[o,e]=this.parentDimensions;this.width=t/o,this.height=i/e,this.fixAndSetPosition(),this.#h&&this.#m(t,i),this.#E(),this.#A(),this.canvas.style.visibility="visible",this.fixDims()}#m(t,i){const d=this.#B(),r=(t-d)/this.#e,o=(i-d)/this.#t;this.scaleFactor=Math.min(r,o)}#y(){const t=this.#B()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#U(t){const i=new Path2D;for(let d=0,r=t.length;d<r;d++){const[o,e,f,u]=t[d];d===0&&i.moveTo(...o),i.bezierCurveTo(e[0],e[1],f[0],f[1],u[0],u[1])}return i}static#N(t,i,d){const[r,o,e,f]=i;switch(d){case 0:for(let u=0,h=t.length;u<h;u+=2)t[u]+=r,t[u+1]=f-t[u+1];break;case 90:for(let u=0,h=t.length;u<h;u+=2){const v=t[u];t[u]=t[u+1]+r,t[u+1]=v+o}break;case 180:for(let u=0,h=t.length;u<h;u+=2)t[u]=e-t[u],t[u+1]+=o;break;case 270:for(let u=0,h=t.length;u<h;u+=2){const v=t[u];t[u]=e-t[u+1],t[u+1]=f-v}break;default:throw new Error("Invalid rotation")}return t}static#j(t,i,d){const[r,o,e,f]=i;switch(d){case 0:for(let u=0,h=t.length;u<h;u+=2)t[u]-=r,t[u+1]=f-t[u+1];break;case 90:for(let u=0,h=t.length;u<h;u+=2){const v=t[u];t[u]=t[u+1]-o,t[u+1]=v-r}break;case 180:for(let u=0,h=t.length;u<h;u+=2)t[u]=e-t[u],t[u+1]-=o;break;case 270:for(let u=0,h=t.length;u<h;u+=2){const v=t[u];t[u]=f-t[u+1],t[u+1]=e-v}break;default:throw new Error("Invalid rotation")}return t}#T(t,i,d,r){const o=[],e=this.thickness/2,f=t*i+e,u=t*d+e;for(const h of this.paths){const v=[],I=[];for(let x=0,g=h.length;x<g;x++){const[A,M,H,N]=h[x],W=t*A[0]+f,G=t*A[1]+u,Z=t*M[0]+f,Q=t*M[1]+u,tt=t*H[0]+f,st=t*H[1]+u,K=t*N[0]+f,R=t*N[1]+u;x===0&&(v.push(W,G),I.push(W,G)),v.push(Z,Q,tt,st,K,R),I.push(Z,Q),x===g-1&&I.push(K,R)}o.push({bezier:L.#N(v,r,this.rotation),points:L.#N(I,r,this.rotation)})}return o}#R(){let t=1/0,i=-1/0,d=1/0,r=-1/0;for(const o of this.paths)for(const[e,f,u,h]of o){const v=a.Util.bezierBoundingBox(...e,...f,...u,...h);t=Math.min(t,v[0]),d=Math.min(d,v[1]),i=Math.max(i,v[2]),r=Math.max(r,v[3])}return[t,d,i,r]}#B(){return this.#h?Math.ceil(this.thickness*this.parentScale):0}#F(t=!1){if(this.isEmpty())return;if(!this.#h){this.#A();return}const i=this.#R(),d=this.#B();this.#e=Math.max(_.AnnotationEditor.MIN_SIZE,i[2]-i[0]),this.#t=Math.max(_.AnnotationEditor.MIN_SIZE,i[3]-i[1]);const r=Math.ceil(d+this.#e*this.scaleFactor),o=Math.ceil(d+this.#t*this.scaleFactor),[e,f]=this.parentDimensions;this.width=r/e,this.height=o/f,this.setAspectRatio(r,o);const u=this.translationX,h=this.translationY;this.translationX=-i[0],this.translationY=-i[1],this.#E(),this.#A(),this.#d=r,this.#f=o,this.setDims(r,o);const v=t?d/this.scaleFactor/2:0;this.translate(u-this.translationX-v,h-this.translationY-v)}static deserialize(t,i,d){if(t instanceof F.InkAnnotationElement)return null;const r=super.deserialize(t,i,d);r.thickness=t.thickness,r.color=a.Util.makeHexColor(...t.color),r.opacity=t.opacity;const[o,e]=r.pageDimensions,f=r.width*o,u=r.height*e,h=r.parentScale,v=t.thickness/2;r.#h=!0,r.#d=Math.round(f),r.#f=Math.round(u);const{paths:I,rect:x,rotation:g}=t;for(let{bezier:M}of I){M=L.#j(M,x,g);const H=[];r.paths.push(H);let N=h*(M[0]-v),W=h*(M[1]-v);for(let Z=2,Q=M.length;Z<Q;Z+=6){const tt=h*(M[Z]-v),st=h*(M[Z+1]-v),K=h*(M[Z+2]-v),R=h*(M[Z+3]-v),m=h*(M[Z+4]-v),l=h*(M[Z+5]-v);H.push([[N,W],[tt,st],[K,R],[m,l]]),N=m,W=l}const G=this.#U(H);r.bezierPath2D.push(G)}const A=r.#R();return r.#e=Math.max(_.AnnotationEditor.MIN_SIZE,A[2]-A[0]),r.#t=Math.max(_.AnnotationEditor.MIN_SIZE,A[3]-A[1]),r.#m(f,u),r}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),i=_.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:this.#T(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation}}}n.InkEditor=L}),((U,n,w)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampEditor=void 0;var a=w(4),_=w(1),F=w(6),O=w(29);class L extends a.AnnotationEditor{#t=null;#e=null;#i=null;#s=null;#a=null;#r=null;#l=null;#o=!1;static _type="stamp";constructor(t){super({...t,name:"stampEditor"}),this.#s=t.bitmapUrl}#h(){if(this.#e){this._uiManager.imageManager.getFromId(this.#e).then(i=>{if(!i){this.remove();return}this.#t=i.bitmap,this.#n()});return}if(this.#s){const i=this.#s;this.#s=null,this.#i=this._uiManager.imageManager.getFromUrl(i).then(d=>{if(this.#i=null,!d){this.remove();return}({bitmap:this.#t,id:this.#e,isSvg:this.#o}=d),this.#n()});return}const t=document.createElement("input");t.type="file",t.accept="image/*",this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(this.#i=null,!t.files||t.files.length===0)this.remove();else{const d=await this._uiManager.imageManager.getFromFile(t.files[0]);if(!d){this.remove();return}({bitmap:this.#t,id:this.#e,isSvg:this.#o}=d),this.#n()}i()}),t.addEventListener("cancel",()=>{this.#i=null,this.remove(),i()})}),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#r?.disconnect(),this.#r=null),super.remove()}rebuild(){super.rebuild(),this.div!==null&&(this.#e&&this.#h(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this.div.draggable=!0,this.parent.addUndoableEditor(this),this.div.focus()}isEmpty(){return this.#i===null&&this.#t===null&&this.#s===null}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.#t?this.#n():(this.div.classList.add("loading"),this.#h()),this.width){const[d,r]=this.parentDimensions;this.setAt(t*d,i*r,this.width*d,this.height*r)}return this.div}#n(){const{div:t}=this;let{width:i,height:d}=this.#t;const[r,o]=this.pageDimensions,e=.75;if(this.width)i=this.width*r,d=this.height*o;else if(i>e*r||d>e*o){const v=Math.min(e*r/i,e*o/d);i*=v,d*=v}const[f,u]=this.parentDimensions;this.setDims(i*f/r,d*u/o);const h=this.#a=document.createElement("canvas");t.append(h),this.#d(i,d),this.#c(),t.classList.remove("loading")}#u(t,i){const[d,r]=this.parentDimensions;this.width=t/d,this.height=i/r,this.setDims(t,i),this.fixAndSetPosition(),this.#l!==null&&clearTimeout(this.#l);const o=200;this.#l=setTimeout(()=>{this.#l=null,this.#d(t,i)},o)}#p(t,i){const{width:d,height:r}=this.#t;let o=d,e=r,f=this.#t;for(;o>2*t||e>2*i;){const u=o,h=e;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),e>2*i&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));const v=new OffscreenCanvas(o,e);v.getContext("2d").drawImage(f,0,0,u,h,0,0,o,e),f=v.transferToImageBitmap()}return f}#d(t,i){const d=this.#a;if(!d||d.width===t&&d.height===i)return;d.width=t,d.height=i;const r=this.#o?this.#t:this.#p(t,i),o=d.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(r,0,0,r.width,r.height,0,0,t,i)}#f(t){if(t){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#o){const[i,d]=this.pageDimensions,r=Math.round(this.width*i*F.PixelsPerInch.PDF_TO_CSS_UNITS),o=Math.round(this.height*d*F.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(r,o);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,o),e.transferToImageBitmap()}return structuredClone(this.#t)}#c(){this.#r=new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&this.#u(i.width,i.height)}),this.#r.observe(this.div)}static deserialize(t,i,d){if(t instanceof O.StampAnnotationElement)return null;const r=super.deserialize(t,i,d),{rect:o,bitmapUrl:e,bitmapId:f,isSvg:u}=t;f&&d.imageManager.isValidId(f)?r.#e=f:r.#s=e,r.#o=u;const[h,v]=r.pageDimensions;return r.width=(o[2]-o[0])/h,r.height=(o[3]-o[1])/v,r}serialize(t=!1,i=null){if(this.isEmpty())return null;const d={annotationType:_.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#o};if(t)return d.bitmapUrl=this.#f(!0),d;if(i===null)return d;i.stamps||=new Map;const r=this.#o?(d.rect[2]-d.rect[0])*(d.rect[3]-d.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:r,serialized:d}),d.bitmap=this.#f(!1);else if(this.#o){const o=i.stamps.get(this.#e);r>o.area&&(o.area=r,o.serialized.bitmap.close(),o.serialized.bitmap=this.#f(!1))}return d}}n.StampEditor=L})],__webpack_module_cache__={};function __w_pdfjs_require__(U){var n=__webpack_module_cache__[U];if(n!==void 0)return n.exports;var w=__webpack_module_cache__[U]={exports:{}};return __webpack_modules__[U](w,w.exports,__w_pdfjs_require__),w.exports}var __webpack_exports__={};return(()=>{var U=__webpack_exports__;Object.defineProperty(U,"__esModule",{value:!0}),Object.defineProperty(U,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(U,"AnnotationEditorLayer",{enumerable:!0,get:function(){return F.AnnotationEditorLayer}}),Object.defineProperty(U,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(U,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(U,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return O.AnnotationEditorUIManager}}),Object.defineProperty(U,"AnnotationLayer",{enumerable:!0,get:function(){return L.AnnotationLayer}}),Object.defineProperty(U,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(U,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(U,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(U,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(U,"ImageKind",{enumerable:!0,get:function(){return n.ImageKind}}),Object.defineProperty(U,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(U,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(U,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(U,"PDFDataRangeTransport",{enumerable:!0,get:function(){return w.PDFDataRangeTransport}}),Object.defineProperty(U,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(U,"PDFWorker",{enumerable:!0,get:function(){return w.PDFWorker}}),Object.defineProperty(U,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(U,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(U,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(U,"PromiseCapability",{enumerable:!0,get:function(){return n.PromiseCapability}}),Object.defineProperty(U,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(U,"SVGGraphics",{enumerable:!0,get:function(){return w.SVGGraphics}}),Object.defineProperty(U,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(U,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(U,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(U,"XfaLayer",{enumerable:!0,get:function(){return t.XfaLayer}}),Object.defineProperty(U,"build",{enumerable:!0,get:function(){return w.build}}),Object.defineProperty(U,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(U,"getDocument",{enumerable:!0,get:function(){return w.getDocument}}),Object.defineProperty(U,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(U,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(U,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(U,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(U,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(U,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(U,"normalizeUnicode",{enumerable:!0,get:function(){return n.normalizeUnicode}}),Object.defineProperty(U,"renderTextLayer",{enumerable:!0,get:function(){return _.renderTextLayer}}),Object.defineProperty(U,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(U,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(U,"updateTextLayer",{enumerable:!0,get:function(){return _.updateTextLayer}}),Object.defineProperty(U,"version",{enumerable:!0,get:function(){return w.version}});var n=__w_pdfjs_require__(1),w=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),_=__w_pdfjs_require__(26),F=__w_pdfjs_require__(27),O=__w_pdfjs_require__(5),L=__w_pdfjs_require__(29),S=__w_pdfjs_require__(14),t=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$2)),pdf$2.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
